(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{BJHQ:function(e,t,o){"use strict";o.r(t);var n=o("tyNb"),i=o("3Pt+");const a="DemoLandingPage";var r=o("fXoL"),s=o("fCJ/"),c=o("R7i2"),d=o("/oK/"),l=o("Eax+"),f=o("Lt5k"),u=o("0IaG");let m=(()=>{class e{constructor(e){this.dialog=e}showAlertNotificationDialog({title:e,info:t,icon:o}){return this.dialog.open(s.a,{data:{title:e,info:t,icon:o}})}showInfoCiudadanoDialog({title:e,info:t,icon:o}){return this.dialog.open(c.a,{data:{title:e,info:t,icon:o}})}showContractAuthorizationDialog(){return this.dialog.open(d.a)}showVideoDialog({url:e,ext:t}){return this.dialog.open(l.a,{data:{url:e,ext:t}})}showRecognizedCitizen({info:e,lastUpdate:t}){return this.dialog.open(f.a,{data:{info:e,lastUpdate:t},panelClass:"my-dialog"})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(u.b))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=o("patT"),p=o("2Vo4"),g=o("tk/3");let b=(()=>{class e{constructor(e){this.http=e}getLocation(){return this.http.get("https://api.ipify.org?format=json&callback=?")}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(g.a))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var v=o("AytR"),w=o("f9VL");let S=(()=>{class e{constructor(e,t){this.http=e,this.requestService=t}GetUsersHistoric(e){return this.http.post(v.a.urlApi+"GroupMatch/GetHistoric",e,{headers:this.requestService.headersAuth})}SetToUsersHistoric(e){return this.http.post(v.a.urlApi+"GroupMatch/AddHistoric",e,{headers:this.requestService.headersAuth})}GetCitizenData(e){return this.http.post(v.a.urlApi+"Ani/GetInfoDocumento",e,{headers:this.requestService.headersAuth})}GetUserData(e){return this.http.post(v.a.urlApi+"Ani/GetInfoDocumento",e,{headers:this.requestService.headers})}SendToIdentificationFace(e){return this.http.post(v.a.urlApi+"GroupMatch/Buscar",e,{headers:this.requestService.headers})}SendToDocumentValidate(e){return this.http.post(v.a.urlApi+"Ani/SaveAndDocumentValidate",e,{headers:this.requestService.headersAuth})}SendImageToEnroll(e){return this.http.post(v.a.urlApi+"GroupMatch/Agregar",e,{headers:this.requestService.headersAuth})}SendToIdentificationFaceById(e){return this.http.post(v.a.urlApi+"CompararRostros/ValidarRostro",e,{headers:this.requestService.headers})}SendVideoRecorder(e){return this.http.post(v.a.urlApi+"GroupMatch/AddVideo",e,{headers:this.requestService.headersAuth,reportProgress:!0})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(g.a),r.Zb(w.a))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),y=(()=>{class e{constructor(e){this.api=e,this.deviceIp$=new p.a(""),this.getLocation()}getLocation(){this.api.getLocation().subscribe(e=>this.deviceIp$.next(e.ip))}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(b))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var O=o("vkgz");let C=(()=>{class e{constructor(e,t,o,n,i){this.api=e,this.dataFacade=t,this.modalsService=o,this.router=n,this.activatedRoute=i,this.usersHistoric$=new p.a([]),this.usersHistoricLast$=new p.a(null),this.citizenInfoState$=new p.a(null),this.faceRecognitionState$=new p.a(null),this.citizenState$=new p.a(null)}GetUsersHistoricById(e){this.api.GetUsersHistoric({Provider:3,Cantidad:10,GroupName:a,IdFeature:e}).pipe(Object(O.a)(e=>this.usersHistoricLast$.next(e.HistoricoList[0]))).subscribe()}GetusersHistoricLast$(){return this.usersHistoricLast$.asObservable()}GetUsersHistoric(){this.api.GetUsersHistoric({Provider:3,GroupName:a,Cantidad:10}).pipe(Object(O.a)(e=>this.usersHistoric$.next(e.HistoricoList))).subscribe()}SetToUsersHistoric(e){const t=[{Ip:e.Ip,Browser:e.Browser,SistemaOperativo:e.SistemaOperativo,Descripcion:e.Descripcion,Fecha:e.Fecha}];this.api.SetToUsersHistoric(e).subscribe(e=>{if(e.EjecucionCorrecta){const e=this.usersHistoric$.value.length;this.usersHistoric$.next(e>=10?t.concat(this.usersHistoric$.value).splice(0,e):t.concat(this.usersHistoric$.value))}})}GetUserData(e){this.dataFacade.setSpinnerState$(!0),this.api.GetUserData(e).subscribe(e=>{this.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?this.modalsService.showInfoCiudadanoDialog({title:"Informaci\xf3n de ciudadano",info:e.Informacion.Respuesta,icon:""}):this.modalsService.showAlertNotificationDialog({title:"Error",info:e.Error,icon:"bad"})})}GetCitizenData(e){return this.api.GetCitizenData(e).subscribe(e=>{e.EjecucionCorrecta?this.citizenState$.next(e.Respuesta):(this.router.navigateByUrl("users/validation?IDConvenio="+this.activatedRoute.snapshot.queryParams.IDConvenio),setTimeout(()=>window.location.reload(!0)))})}GetCitizenState$(){return this.citizenState$.asObservable()}SetCitizenState$(e){return this.citizenState$.next(e)}GetCitizenValue(){return this.citizenState$.value}SendToIdentificationFace(e){this.dataFacade.setSpinnerState$(!0),this.api.SendToIdentificationFace(e).subscribe(e=>{if(this.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta){let t=e.Groups[0].faceGroups.filter(e=>e.Score>92)[0];t?t.Reconocido=!0:t={Reconocido:!1},this.faceRecognitionState$.next(t)}else this.faceRecognitionState$.next({Reconocido:!1})})}GetfaceRecognitionState$(){return this.faceRecognitionState$.next(null),this.faceRecognitionState$.asObservable()}SendToDocumentValidate(e){this.dataFacade.setSpinnerState$(!0),this.api.SendToDocumentValidate(e).subscribe(e=>{this.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?this.citizenInfoState$.next(e.Respuesta):this.modalsService.showAlertNotificationDialog({title:"Error",info:e.Error,icon:"bad"}).afterClosed().subscribe(e=>{this.citizenInfoState$.next(null)})},e=>{this.dataFacade.setSpinnerState$(!1),this.modalsService.showAlertNotificationDialog({title:"Error",info:"Por favor comuniquese con el administrador.",icon:"bad"}).afterClosed().subscribe(e=>{this.citizenInfoState$.next(null)})})}SetCitizenInfoState(e){return this.citizenInfoState$.next(e)}GetCitizenInfoState$(){return this.citizenInfoState$.asObservable()}GetCitizenInfoStateValue(){return this.citizenInfoState$.value}SendImageToEnroll(e){this.dataFacade.setSpinnerState$(!0),this.api.SendImageToEnroll(e).subscribe(e=>{this.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?this.modalsService.showAlertNotificationDialog({title:"Bienvenido",info:"Registro satisfactorio.",icon:"good"}).afterClosed().subscribe(e=>{this.citizenInfoState$.next(null)}):this.modalsService.showAlertNotificationDialog({title:"Error",info:e.Error,icon:"bad"}).afterClosed().subscribe(e=>{this.citizenInfoState$.next(null)})},e=>{this.modalsService.showAlertNotificationDialog({title:"Error",info:"Por favor comuniquese con el administrador.",icon:"bad"}).afterClosed().subscribe(e=>{this.citizenInfoState$.next(null)})})}SendToIdentificationFaceById(e){this.dataFacade.setSpinnerState$(!0);let t=null;this.api.SendToIdentificationFaceById(e).subscribe(o=>{if(o.EjecucionCorrecta){const n=o.faceIdentification;t=n,n.Score<91?(this.dataFacade.setSpinnerState$(!1),this.faceRecognitionState$.next({Reconocido:!1})):n.IdFeature&&0!==n.IdFeature?(this.dataFacade.setSpinnerState$(!1),n.Reconocido=!0,this.faceRecognitionState$.next(n)):this.SendImageToEnrollAfterValidate(n,{Imagen:e.Image,GroupName:a,Provider:3,InformacionCiudadanoId:e.Id,Motivo:"",Descripcion:`${n.Detail.PrimerNombre} ${n.Detail.PrimerApellido}`,Codigo:`${n.Detail.NUIP}`,Tag:""})}else this.dataFacade.setSpinnerState$(!1),this.faceRecognitionState$.next({Reconocido:!1})})}SendImageToEnrollAfterValidate(e,t){const o=e;this.api.SendImageToEnroll(t).subscribe(e=>{this.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?(o.Reconocido=!0,o.IdFeature=e.FeatureId,this.faceRecognitionState$.next(o)):this.faceRecognitionState$.next({Reconocido:!1})})}SendVideoRecorder(e){const t=new FormData;t.append("file",e.video,e.name+"."+e.ext),this.api.SendVideoRecorder(t).subscribe(e=>{console.log("Video upload")})}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(S),r.Zb(h.a),r.Zb(m),r.Zb(n.b),r.Zb(n.a))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var R=o("kmnG"),x=o("d3UM"),k=o("ofXK"),M=o("qFsG");function I(e,t,o,n){return new(o||(o=Promise))((function(i,a){function r(e){try{c(n.next(e))}catch(t){a(t)}}function s(e){try{c(n.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(r,s)}c((n=n.apply(e,t||[])).next())}))}var P=function(e){return e[e.Paused=0]="Paused",e[e.Recording=1]="Recording",e[e.Inactive=2]="Inactive",e}({});const A=[{name:"face-api",src:"assets/js/face-api.min.js"},{name:"commons",src:"assets/js/commons.js"},{name:"faceDetectionControls",src:"assets/js/faceDetectionControls.js"}];let B=(()=>{class e{constructor(){this.scripts={},A.forEach(e=>{this.scripts[e.name]={loaded:!1,src:e.src}})}load(...e){const t=[];return e.forEach(e=>t.push(this.loadScript(e))),Promise.all(t)}removeScript(e){const t=document.getElementsByTagName("script");for(let o=t.length;o>=0;o--)t[o]&&null!=t[o].getAttribute("src")&&t[o].getAttribute("src")===this.scripts[e].src&&t[o].parentNode.removeChild(t[o])}loadScript(e){return new Promise((t,o)=>{if(this.scripts[e].loaded)t({script:e,loaded:!0,status:"Already Loaded"});else{const o=document.createElement("script");o.type="text/javascript",o.src=this.scripts[e].src,o.async=!0,o.defer=!0,o.readyState?o.onreadystatechange=()=>{"loaded"!==o.readyState&&"complete"!==o.readyState||(o.onreadystatechange=null,this.scripts[e].loaded=!0,t({script:e,loaded:!0,status:"Loaded"}))}:o.onload=()=>{this.scripts[e].loaded=!0,t({script:e,loaded:!0,status:"Loaded"})},o.onerror=o=>t({script:e,loaded:!1,status:"Loaded"}),document.getElementsByTagName("head")[0].appendChild(o)}})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class T{constructor(e,t){this.state=P.Inactive,this.mediaRecorder=new MediaRecorder(e.srcObject,t),this.ext=t.ext}PauseRecord(){console.log("pause"),"recording"===this.mediaRecorder.state&&(this.mediaRecorder.pause(),this.state=P.Paused)}ResumeRecord(){console.log("resume"),"paused"===this.mediaRecorder.state&&(this.mediaRecorder.resume(),this.state=P.Recording)}StartRecord(){console.log("start"),"inactive"===this.mediaRecorder.state&&(this.mediaRecorder.start(),this.state=P.Recording,this.mediaRecorder.ondataavailable=this.OnDataAvailable.bind(this))}StopRecord(){return console.log("stop"),new Promise((e,t)=>{this.mediaRecorder.onstop=t=>{this.state=P.Inactive,e(this.BuildVideo(this.videoData))},this.mediaRecorder.stop()})}OnDataAvailable(e){this.videoData=e.data}BuildVideo(e){return{video:new Blob([e],{type:e.type}),ext:this.ext}}}var F=o("qe5e");class L{constructor(e,t){this.state=P.Inactive,this.mediaRecorder=new F(e.srcObject,t),this.ext=t.ext}PauseRecord(){console.log("pause"),"recording"===this.mediaRecorder.getState()&&(this.mediaRecorder.pauseRecording(),this.state=P.Paused)}ResumeRecord(){console.log("resume"),"paused"===this.mediaRecorder.getState()&&(this.mediaRecorder.resumeRecording(),this.state=P.Recording)}StartRecord(){console.log("start"),console.log(this.mediaRecorder.getState()),"inactive"!==this.mediaRecorder.getState()&&"stopped"!==this.mediaRecorder.getState()||(this.mediaRecorder.startRecording(),this.state=P.Recording,console.log(this.mediaRecorder.getState()))}StopRecord(){return console.log("stop"),new Promise((e,t)=>{this.mediaRecorder.stopRecording(()=>{this.state=P.Inactive,e(this.BuildVideo(this.mediaRecorder.getBlob()))})})}BuildVideo(e){return{video:new Blob([e],{type:e.type}),ext:this.ext}}BlobToFile(e){const t=e;return t.lastModifiedDate=new Date,t.name="recorder."+this.ext,t}}var E=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_=[["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["edge",/Edge\/([0-9\._]+)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+)\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["safari",/Version\/([0-9\._]+).*Safari/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/]],U=["Windows Phone","Android","CentOS",{name:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],D={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},z=new RegExp(["(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|","compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|","midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)","\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|","wap|windows ce|xda|xiino"].join(""),"i"),j=new RegExp(["1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|","ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|","avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|","cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|","ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|","g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|","hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|","i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|","kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])","|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|","mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|","n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|","op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|","po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|","raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|","se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|k\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|","so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|","tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|","veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|","w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-"].join(""),"i"),V=function(){function e(e,t,o){this.navigator=t,this.process=o,this.userAgent=e||(this.navigator?t.userAgent||t.vendor:"")}return e.prototype.detect=function(){if(this.process&&!this.userAgent){var e=this.process.version.slice(1).split(".").slice(0,3),t=Array.prototype.slice.call(e,1).join("")||"0";return{name:"node",version:e.join("."),versionNumber:parseFloat(e[0]+"."+t),mobile:!1,os:this.process.platform}}return this.userAgent||this.handleMissingError(),E({},this.checkBrowser(),this.checkMobile(),this.checkOs())},e.prototype.checkBrowser=function(){var e=this;return _.filter((function(t){return t[1].test(e.userAgent)})).map((function(t){var o=t[1].exec(e.userAgent),n=o&&o[1].split(/[._]/).slice(0,3),i=Array.prototype.slice.call(n,1).join("")||"0";return n&&n.length<3&&Array.prototype.push.apply(n,1===n.length?[0,0]:[0]),{name:String(t[0]),version:n.join("."),versionNumber:Number(n[0]+"."+i)}})).shift()},e.prototype.checkMobile=function(){var e=this.userAgent.substr(0,4);return{mobile:z.test(this.userAgent)||j.test(e)}},e.prototype.checkOs=function(){var e=this;return U.map((function(t){var o=t.name||t,n=e.getOsPattern(t);return{name:o,pattern:n,value:RegExp("\\b"+n.replace(/([ -])(?!$)/g,"$1?")+"(?:x?[\\d._]+|[ \\w.]*)","i").exec(e.userAgent)}})).filter((function(e){return e.value})).map((function(e){var t,o=e.value[0]||"";return e.pattern&&e.name&&/^Win/i.test(o)&&!/^Windows Phone /i.test(o)&&(t=D[o.replace(/[^\d.]/g,"")])&&(o="Windows "+t),e.pattern&&e.name&&(o=o.replace(RegExp(e.pattern,"i"),e.name)),o=o.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0].trim(),{os:o=/^(?:webOS|i(?:OS|P))/.test(o)?o:o.charAt(0).toUpperCase()+o.slice(1)}})).shift()},e.prototype.getOsPattern=function(e){return("string"==typeof e?e:void 0)||e.pattern||e.name},e.prototype.handleMissingError=function(){throw new Error("Please give user-agent.\n> browser(navigator.userAgent or res.headers['user-agent']).")},e}();function N(e,t){return e(t={exports:{}},t.exports),t.exports}var W=N((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),G=N((function(e){var t=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=t)})),$=function(e){return"object"==typeof e?null!==e:"function"==typeof e},q=function(e){if(!$(e))throw TypeError(e+" is not an object!");return e},H=function(e){try{return!!e()}catch(t){return!0}},Y=!H((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),X=W.document,J=$(X)&&$(X.createElement),Z=!Y&&!H((function(){return 7!=Object.defineProperty(J?X.createElement("div"):{},"a",{get:function(){return 7}}).a})),Q=Object.defineProperty,K={f:Y?Object.defineProperty:function(e,t,o){if(q(e),t=function(e,t){if(!$(e))return e;var o,n;if("function"==typeof(o=e.toString)&&!$(n=o.call(e)))return n;if("function"==typeof(o=e.valueOf)&&!$(n=o.call(e)))return n;throw TypeError("Can't convert object to primitive value")}(t),q(o),Z)try{return Q(e,t,o)}catch(n){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(e[t]=o.value),e}},ee=Y?function(e,t,o){return K.f(e,t,function(e,t){return{enumerable:!1,configurable:!0,writable:!0,value:t}}(0,o))}:function(e,t,o){return e[t]=o,e},te={}.hasOwnProperty,oe=function(e,t){return te.call(e,t)},ne=0,ie=Math.random(),ae=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++ne+ie).toString(36))},re=N((function(e){var t=ae("src"),o=Function.toString,n=(""+o).split("toString");G.inspectSource=function(e){return o.call(e)},(e.exports=function(e,o,i,a){var r="function"==typeof i;r&&(oe(i,"name")||ee(i,"name",o)),e[o]!==i&&(r&&(oe(i,t)||ee(i,t,e[o]?""+e[o]:n.join(String(o)))),e===W?e[o]=i:a?e[o]?e[o]=i:ee(e,o,i):(delete e[o],ee(e,o,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[t]||o.call(this)}))})),se=function(e,t,o){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(e),void 0===t)return e;switch(o){case 1:return function(o){return e.call(t,o)};case 2:return function(o,n){return e.call(t,o,n)};case 3:return function(o,n,i){return e.call(t,o,n,i)}}return function(){return e.apply(t,arguments)}},ce=function(e,t,o){var n,i,a,r,s=e&ce.F,c=e&ce.G,d=e&ce.P,l=e&ce.B,f=c?W:e&ce.S?W[t]||(W[t]={}):(W[t]||{}).prototype,u=c?G:G[t]||(G[t]={}),m=u.prototype||(u.prototype={});for(n in c&&(o=t),o)a=((i=!s&&f&&void 0!==f[n])?f:o)[n],r=l&&i?se(a,W):d&&"function"==typeof a?se(Function.call,a):a,f&&re(f,n,a,e&ce.U),u[n]!=a&&ee(u,n,r),d&&m[n]!=a&&(m[n]=a)};W.core=G,ce.F=1,ce.G=2,ce.S=4,ce.P=8,ce.B=16,ce.W=32,ce.U=64,ce.R=128;var de=ce,le={}.toString,fe=function(e){return le.call(e).slice(8,-1)},ue=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==fe(e)?e.split(""):Object(e)},me=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},he=Math.ceil,pe=Math.floor,ge=Math.min,be=Array.isArray||function(e){return"Array"==fe(e)},ve=N((function(e){var t=W["__core-js_shared__"]||(W["__core-js_shared__"]={});(e.exports=function(e,o){return t[e]||(t[e]=void 0!==o?o:{})})("versions",[]).push({version:G.version,mode:"global",copyright:"\xa9 2018 Denis Pushkarev (zloirock.ru)"})})),we=N((function(e){var t=ve("wks"),o=W.Symbol,n="function"==typeof o;(e.exports=function(e){return t[e]||(t[e]=n&&o[e]||(n?o:ae)("Symbol."+e))}).store=t}))("species"),Se=function(e,t){return new(function(e){var t;return be(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!be(t.prototype)||(t=void 0),$(t)&&null===(t=t[we])&&(t=void 0)),void 0===t?Array:t}(e))(t)},ye=function(e,t){var o=1==e,n=2==e,i=3==e,a=4==e,r=6==e,s=5==e||r,c=t||Se;return function(t,d,l){for(var f,u,m=Object(me(t)),h=ue(m),p=se(d,l,3),g=function(e){return e>0?ge(function(e){return isNaN(e=+e)?0:(e>0?pe:he)(e)}(e),9007199254740991):0}(h.length),b=0,v=o?c(t,g):n?c(t,0):void 0;g>b;b++)if((s||b in h)&&(u=p(f=h[b],b,m),e))if(o)v[b]=u;else if(u)switch(e){case 3:return!0;case 5:return f;case 6:return b;case 2:v.push(f)}else if(a)return!1;return r?-1:i||a?a:v}},Oe=function(e,t){return!!e&&H((function(){t?e.call(null,(function(){}),1):e.call(null)}))},Ce=ye(2);de(de.P+de.F*!Oe([].filter,!0),"Array",{filter:function(e){return Ce(this,e,arguments[1])}});var Re=ye(1);de(de.P+de.F*!Oe([].map,!0),"Array",{map:function(e){return Re(this,e,arguments[1])}});var xe="\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",ke="["+xe+"]",Me=RegExp("^"+ke+ke+"*"),Ie=RegExp(ke+ke+"*$"),Pe=function(e,t,o){var n={},i=H((function(){return!!xe[e]()||"\u200b\x85"!="\u200b\x85"[e]()})),a=n[e]=i?t(Ae):xe[e];o&&(n[o]=a),de(de.P+de.F*i,"String",n)},Ae=Pe.trim=function(e,t){return e=String(me(e)),1&t&&(e=e.replace(Me,"")),2&t&&(e=e.replace(Ie,"")),e};Pe("trim",(function(e){return function(){return e(this,3)}}));var Be="undefined"!=typeof window?window.navigator:void 0,Te="undefined"!=typeof process?process:void 0,Fe=function(e){return new V(e,Be,Te).detect()},Le=o("vS2R"),Ee=o("RdDz");class _e{constructor(e,t){this.state=P.Inactive,this.images=[],this.ext=t.ext,this.options=t,this.streamPlayer=e}PauseRecord(){console.log("pause"),this.state===P.Recording&&(clearInterval(this.interval),this.state=P.Paused)}ResumeRecord(){console.log("resume"),this.state===P.Paused&&(this.interval=this.OnLoadImage(),this.state=P.Recording)}StartRecord(){console.log("start-new"),this.canvas=document.createElement("canvas"),this.canvas.width=.65*this.streamPlayer.videoWidth,this.canvas.height=.65*this.streamPlayer.videoHeight,this.state===P.Inactive&&(this.interval=this.OnLoadImage(),this.state=P.Recording)}OnLoadImage(){return setInterval(()=>{this.images.push(this.capture())},1e3*this.options.interval)}StopRecord(){return console.log("stop"),new Promise((e,t)=>{clearInterval(this.interval);let o=this.images.map(e=>URL.createObjectURL(e));Le.createGIF({images:o,gifHeight:this.canvas.height,gifWidth:this.canvas.width,numWorkers:6,sampleInterval:10},t=>{t.error||(this.images=[],this.state=P.Inactive,e(t.error?null:this.BuildVideo(t.image)))})})}BuildVideo(e){let t=Ee(e.replace("data:image/gif;base64,",""),"image/gif");return{video:new Blob([t],{type:t.type}),ext:this.ext}}capture(){this.canvas.getContext("2d").drawImage(this.streamPlayer,0,0,this.canvas.width,this.canvas.height);let e=this.canvas.toDataURL("image/png");return Ee(e.replace("data:image/png;base64,",""),"image/png")}}var Ue=o("IZMd");let De=(()=>{class e{constructor(e){this.slackService=e}SelectRecorder(e,t){let o;switch(e){case"chrome":return o={videoBitsPerSecond:25e5,mimeType:"video/webm",ext:"webm"},new T(t,o);case"safari":return o={interval:.2,ext:"gif"},new _e(t,o);case"edge":return o={type:"video",mimeType:"video/webm",ext:"webm"},new L(t,o);default:return null}}GetRecorder(e){try{return this.SelectRecorder(Fe().name.toLowerCase().trim(),e)}catch(t){this.slackService.SetError(this.slackService.GetErrorFormat(t,"Creaci\xf3n Recorder"))}}SetVideoRecorder(e){this.video=e}GetVideoRecorder(){return this.video}GetFileToUrl(e){return URL.createObjectURL(e)}}return e.\u0275fac=function(t){return new(t||e)(r.Zb(Ue.a))},e.\u0275prov=r.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const ze=["video"],je=["canvas"];function Ve(e,t){if(1&e&&(r.Vb(0,"div",6,7),r.Vb(2,"p",null,8),r.Ac(4),r.Ub(),r.Ub()),2&e){const e=r.hc();r.Cb(4),r.Bc(e.validationMessage)}}let Ne=(()=>{class e{constructor(e,t,o,n,i){this.dataFacade=e,this.modalsService=t,this.scriptsService=o,this.videoRecorderService=n,this.slackService=i,this.liveFace=!0,this.liveFaceOptions=[],this.timeToRefresh=1e4,this.timeLastDetection=new Date,this.happyValue={value:.8},this.mouthOpenValue={value:.85},this.validationMessage="",this.isFaceValid=!1,this.livefaceImage=new r.o}ngOnDestroy(){}ngOnInit(){this.isCameraAllowed(),this.timeLastDetection=new Date}prepareValidation(){console.log("Preparando !!!!"),this.reducePrecisionActivate=!0,this.happyValue.value=.8,this.mouthOpenValue.value=.75;const e=[{name:"happy",callback:e=>e.expressions.happy>this.happyValue.value,label:"Regalame una sonrisa",reducePrecisionFunc:()=>{this.reduceFunction(this.happyValue,.45,.012)}},{name:"openMouth",callback:e=>{const t=e.landmarks.getMouth(),o=t[14],n=t[18],i=t[0],a=t[6];return faceapi.euclideanDistance([o.x,o.y],[n.x,n.y])/faceapi.euclideanDistance([i.x,i.y],[a.x,a.y])>this.mouthOpenValue.value},label:"Abra la boca",reducePrecisionFunc:()=>{this.reduceFunction(this.mouthOpenValue,.44,.012)}}];for(let t=e.length-1;t>=0;t--){const t=Math.floor(Math.random()*e.length);this.liveFaceOptions.push({expression:e[t],status:!1}),e.splice(t,1)}this.isImageSended=!1}reduceFunction(e,t,o){this.reducePrecisionActivate&&(this.reducePrecisionActivate=!1,setTimeout(()=>{e.value>=t&&(this.reducePrecisionActivate=!0,e.value-=o)},2e3))}isCameraAllowed(){navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{if(e.getVideoTracks().length>0){this.loadScripts();const t=this.video.nativeElement;t.srcObject=e,this.recorder=this.videoRecorderService.GetRecorder(t)}this.prepareValidation()}).catch(e=>{this.showOverlayMessage=!0,this.validationMessage="ACTIVE SU CAMARA PARA CONTINUAR",setTimeout(()=>this.ngOnInit(),1e3)})}onPlay(){return I(this,void 0,void 0,(function*(){if(this.showOverlayMessage=this.startFaceLive,this.startFaceLive){const e=this.video.nativeElement,t=this.canvas.nativeElement,o=new faceapi.TinyFaceDetectorOptions({inputSize:224,scoreThreshold:.5});let n;if(e.paused||e.ended)return setTimeout(()=>this.onPlay());n=this.liveFace?yield faceapi.detectSingleFace(e,o).withFaceLandmarks().withFaceExpressions():yield faceapi.detectSingleFace(e,o),n?yield this.faceValidation({results:n,canvas:t,video:e}):faceapi.getContext2dOrThrow(t).clearRect(0,0,t.width,t.height)}setTimeout(()=>this.onPlay())}))}faceValidation({results:e,canvas:t,video:o}){return I(this,void 0,void 0,(function*(){if(faceapi.matchDimensions(t,o,!0),t.getContext("2d").clearRect(0,0,t.width,t.height),this.liveFaceOptions.length>0&&this.liveFace){const t=this.liveFaceOptions[0].expression;this.liveOption=this.liveFaceOptions[0].expression,this.validationMessage=t.label,e.expressions.neutral>=.8&&!this.photo&&(this.isFaceValid=!0,this.capture()),t.callback(e)?(this.isFaceValid=!0,this.reducePrecisionActivate=!0,this.liveFaceOptions.splice(0,1),this.RecorderVideoManagement(this.liveFaceOptions.length)):(this.isFaceValid=!1,t.reducePrecisionFunc())}else if(this.liveFace||this.photo){if(this.isFaceValid=!1,this.validationMessage="",this.recorder&&this.recorder.state!==P.Inactive){const e=yield this.recorder.StopRecord();this.videoRecorderService.SetVideoRecorder(e)}this.sendImage(this.photo)}else e.score>=.8&&(this.isFaceValid=!0,this.capture())}))}RecorderVideoManagement(e){if(this.recorder)try{!this.recorder||this.recorder.state!==P.Paused&&this.recorder.state!==P.Inactive||(console.log("estado actual : ",this.recorder.state),this.recorder.state===P.Inactive?this.recorder.StartRecord():this.recorder.state===P.Paused&&this.recorder.ResumeRecord(),0!==this.liveFaceOptions.length&&setTimeout(()=>{e===this.liveFaceOptions.length&&this.recorder.PauseRecord()},3e3))}catch(t){this.recorder=null,this.slackService.SetError(this.slackService.GetErrorFormat(t,"Comandos Recorder"))}}capture(){console.log("CAPTURE"),this.canvas.nativeElement.getContext("2d").drawImage(this.video.nativeElement,0,0),this.photo=this.canvas.nativeElement.toDataURL("image/png")}sendImage(e){this.isImageSended||(this.isImageSended=!0,e&&(this.livefaceImage.emit(e.replace("data:image/png;base64,","")),this.photo=null),setTimeout(()=>this.prepareValidation(),500))}loadScripts(){this.scriptsService.load("face-api").then(()=>{console.log("Se carg\xf3 face-api.js !!"),this.scriptsService.load("commons").then(()=>{console.log("Se carg\xf3 commons.js !!"),this.scriptsService.load("faceDetectionControls").then(()=>{Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri("assets/weights"),faceapi.nets.faceLandmark68Net.loadFromUri("assets/weights"),faceapi.nets.faceExpressionNet.loadFromUri("assets/weights")]).then(()=>{console.log("Se cargaron los modelos !!"),this.onPlay()})}).catch(e=>console.log(e))}).catch(e=>console.log(e))}).catch(e=>console.log(e))}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(h.a),r.Pb(m),r.Pb(B),r.Pb(De),r.Pb(Ue.a))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-liveface-camera"]],viewQuery:function(e,t){var o;1&e&&(r.xc(ze,!0),r.xc(je,!0)),2&e&&(r.pc(o=r.ec())&&(t.video=o.first),r.pc(o=r.ec())&&(t.canvas=o.first))},inputs:{startFaceLive:"startFaceLive"},outputs:{livefaceImage:"livefaceImage"},decls:6,vars:3,consts:[[1,"main__camera__wrapper"],["class","main__camera__wrapper__overlay",4,"ngIf"],["autoplay","","muted","","playsinline","",1,"main__camera__wrapper__video"],["video",""],[1,"main__camera__canvas"],["canvas",""],[1,"main__camera__wrapper__overlay"],["overlayVideo",""],["expressionsLabel",""]],template:function(e,t){1&e&&(r.Vb(0,"div",0),r.zc(1,Ve,5,1,"div",1),r.Qb(2,"video",2,3),r.Ub(),r.Qb(4,"canvas",4,5)),2&e&&(r.Cb(1),r.mc("ngIf",t.showOverlayMessage),r.Cb(1),r.Gb("active",t.isFaceValid))},directives:[k.k],styles:['@charset "UTF-8";@-webkit-keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@-webkit-keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@font-face{font-family:OpenSans-Regular;src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot);src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot?#iefix) format("embedded-opentype"),url(OpenSans-Regular.5d5735e57127db2f7a2a.woff2) format("woff2"),url(OpenSans-Regular.6fde2eb6728eb97fd914.woff) format("woff"),url(OpenSans-Regular.8df00d6176ddae387d94.ttf) format("truetype"),url(OpenSans-Regular.bbbd47d2660d3547e98a.svg#OpenSans-Regular) format("svg");font-weight:400;font-style:normal}@font-face{font-family:OpenSans-ExtraBoldItalic;src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot);src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBoldItalic.d69a748730ffaa1494fb.woff2) format("woff2"),url(OpenSans-ExtraBoldItalic.edbbf5335fcb1e037d0e.woff) format("woff"),url(OpenSans-ExtraBoldItalic.f093928db8789603f791.ttf) format("truetype"),url(OpenSans-ExtraBoldItalic.60cbf3ab7cbcb2732e3c.svg#OpenSans-ExtraBoldItalic) format("svg");font-weight:800;font-style:italic}@font-face{font-family:OpenSans-SemiBold;src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot);src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBold.7106bb83a0e767e12659.woff2) format("woff2"),url(OpenSans-SemiBold.fe241c6c4f5a190e821b.woff) format("woff"),url(OpenSans-SemiBold.f28ed2e40f2a6955ddc5.ttf) format("truetype"),url(OpenSans-SemiBold.dd308ca05314118f5410.svg#OpenSans-SemiBold) format("svg");font-weight:600;font-style:normal}@font-face{font-family:OpenSans-Bold;src:url(OpenSans-Bold.5487bea91cef82008fdc.eot);src:url(OpenSans-Bold.5487bea91cef82008fdc.eot?#iefix) format("embedded-opentype"),url(OpenSans-Bold.93fe8f3415688d16bb94.woff2) format("woff2"),url(OpenSans-Bold.759ea19bccf8a5ca50a5.woff) format("woff"),url(OpenSans-Bold.ab38fda09644c992dc09.ttf) format("truetype"),url(OpenSans-Bold.8eb005f737c1e60d2e4d.svg#OpenSans-Bold) format("svg");font-weight:700;font-style:normal}@font-face{font-family:OpenSans-LightItalic;src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot);src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot?#iefix) format("embedded-opentype"),url(OpenSans-LightItalic.d821368c1b1a2f95186f.woff2) format("woff2"),url(OpenSans-LightItalic.f98d42be17e95311f1f8.woff) format("woff"),url(OpenSans-LightItalic.5a3ac4d0297da9f2b75c.ttf) format("truetype"),url(OpenSans-LightItalic.1d7a2f3d597960cd5d37.svg#OpenSans-LightItalic) format("svg");font-weight:300;font-style:italic}@font-face{font-family:OpenSans-BoldItalic;src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot);src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot?#iefix) format("embedded-opentype"),url(OpenSans-BoldItalic.183f1aa2eb319f83e073.woff2) format("woff2"),url(OpenSans-BoldItalic.0a96d2322aa762873140.woff) format("woff"),url(OpenSans-BoldItalic.ad5795be528d8256833a.ttf) format("truetype"),url(OpenSans-BoldItalic.bcbc56117328195e6bd3.svg#OpenSans-BoldItalic) format("svg");font-weight:700;font-style:italic}@font-face{font-family:OpenSans-SemiBoldItalic;src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot);src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBoldItalic.da6f476d3784fdfb4b33.woff2) format("woff2"),url(OpenSans-SemiBoldItalic.02669c88881b1577a54e.woff) format("woff"),url(OpenSans-SemiBoldItalic.3dc654f4cee24692f644.ttf) format("truetype"),url(OpenSans-SemiBoldItalic.045ad4303be6beb367d6.svg#OpenSans-SemiBoldItalic) format("svg");font-weight:600;font-style:italic}@font-face{font-family:OpenSans-Italic;src:url(OpenSans-Italic.1ec1b222862acc96228e.eot);src:url(OpenSans-Italic.1ec1b222862acc96228e.eot?#iefix) format("embedded-opentype"),url(OpenSans-Italic.c27ebc192b3fe6167aa9.woff2) format("woff2"),url(OpenSans-Italic.052b69c9c418c621fbd9.woff) format("woff"),url(OpenSans-Italic.a709ab6006407a103054.ttf) format("truetype"),url(OpenSans-Italic.2d835a9a0d5ab7cc6f62.svg#OpenSans-Italic) format("svg");font-weight:400;font-style:italic}@font-face{font-family:OpenSans-Light;src:url(OpenSans-Light.d8ba00bc265c4a055470.eot);src:url(OpenSans-Light.d8ba00bc265c4a055470.eot?#iefix) format("embedded-opentype"),url(OpenSans-Light.559e978f49dc58dbe421.woff2) format("woff2"),url(OpenSans-Light.c002a58fc48427af4884.woff) format("woff"),url(OpenSans-Light.b270c40ae5ed0192f44d.ttf) format("truetype"),url(OpenSans-Light.f78850b7adbe96ff18c9.svg#OpenSans-Light) format("svg");font-weight:300;font-style:normal}@font-face{font-family:OpenSans-ExtraBold;src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot);src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBold.1b2c3c4788d5f305789b.woff2) format("woff2"),url(OpenSans-ExtraBold.3f760f718edb65cd95c6.woff) format("woff"),url(OpenSans-ExtraBold.c9e437c181cb1c201188.ttf) format("truetype"),url(OpenSans-ExtraBold.a1a888c4158a9167d356.svg#OpenSans-ExtraBold) format("svg");font-weight:800;font-style:normal}@font-face{font-family:icomoon;src:url(icomoon.d25461326f680e27f6b9.eot?a80olx);src:url(icomoon.d25461326f680e27f6b9.eot?a80olx#iefix) format("embedded-opentype"),url(icomoon.5394b2a687c21e82faff.ttf?a80olx) format("truetype"),url(icomoon.ee719c35803c2cdae449.woff?a80olx) format("woff"),url(icomoon.36f8bbc7721d58817f5a.svg?a80olx#icomoon) format("svg");font-weight:400;font-style:normal;font-display:block}[class*=" icon-"][_ngcontent-%COMP%], [class^=icon-][_ngcontent-%COMP%]{font-family:icomoon!important;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon--no-camera[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue90e";color:#ededed}.icon--no-camera[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue90f";margin-left:-1em;color:#dd141d}.icon--hide-pass[_ngcontent-%COMP%]:before{content:"\ue90c"}.icon--show-pass[_ngcontent-%COMP%]:before{content:"\ue90d"}.icon--end-process[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue9a7";color:rgba(255,186,0,.4)}.icon--end-process[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue9a8";margin-left:-1em;color:#ffba00}.icon--rotate-camera[_ngcontent-%COMP%]:before{content:"\ue900";color:#fff}.icon--rotate-document[_ngcontent-%COMP%]:before{content:"\ue901"}.icon--take-photo[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue902";color:hsla(0,0%,100%,.5)}.icon--take-photo[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue903";margin-left:-1em;color:#fff}.icon--check[_ngcontent-%COMP%]:before{content:"\ue904";color:#fff}.icon--close[_ngcontent-%COMP%]:before{content:"\ue905";color:#fff}.icon--back-document[_ngcontent-%COMP%]:before{content:"\ue906";color:#fff}.icon--front-document[_ngcontent-%COMP%]:before{content:"\ue907";color:#fff}.icon--scan-document[_ngcontent-%COMP%]:before{content:"\ue908";color:#fff}.icon--face[_ngcontent-%COMP%]:before{content:"\ue909";color:#fff}.icon--user-form[_ngcontent-%COMP%]:before{content:"\ue90a";color:#fff}.icon--light[_ngcontent-%COMP%]:before{content:"\ue90b";color:#fff}.icon--pirate[_ngcontent-%COMP%]:before{content:"\ue9a4";color:#fff}.icon--questions[_ngcontent-%COMP%]:before{content:"\ue9a5";color:#fff}.icon--user-data[_ngcontent-%COMP%]:before{content:"\ue9a6";color:#fff}.main__camera__wrapper[_ngcontent-%COMP%]{position:relative}.main__camera__wrapper[_ngcontent-%COMP%]   .main__camera__wrapper__overlay[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:center;-ms-justify-content:center;justify-content:center;-ms-flex-pack:center;-moz-align-items:center;-ms-align-items:center;align-items:center;position:absolute;z-index:40;left:0;right:0;top:0;bottom:85%;text-align:center;background-color:rgba(0,0,0,.46);color:#fff;font-size:16px}.main__camera__wrapper[_ngcontent-%COMP%]   .main__camera__wrapper__video[_ngcontent-%COMP%]{background-color:#000;display:block;z-index:20;height:100%;width:100%;box-shadow:0 0 7px -1px #fff}.main__camera__wrapper[_ngcontent-%COMP%]   .main__camera__wrapper__video.active[_ngcontent-%COMP%]{box-shadow:0 0 9px 6px #0dff00}.main__camera__canvas[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;margin:0 auto}']}),e})();var We=o("bSwM"),Ge=o("bTqV"),$e=o("FKr1");function qe(e,t){if(1&e&&(r.Vb(0,"mat-option",17),r.Ac(1),r.Ub()),2&e){const e=t.$implicit;r.mc("value",e.value),r.Cb(1),r.Cc(" ",e.viewValue," ")}}function He(e,t){1&e&&(r.Vb(0,"mat-error"),r.Ac(1," Documento de identificaci\xf3n es "),r.Vb(2,"strong"),r.Ac(3,"requerido"),r.Ub(),r.Ub())}function Ye(e,t){1&e&&(r.Vb(0,"mat-error"),r.Ac(1," Nombre completo es "),r.Vb(2,"strong"),r.Ac(3,"requerido"),r.Ub(),r.Ub())}function Xe(e,t){if(1&e&&(r.Vb(0,"div",3),r.Vb(1,"mat-form-field",18),r.Vb(2,"mat-label"),r.Ac(3,"Ingrese su nombre completo"),r.Ub(),r.Qb(4,"input",19),r.zc(5,Ye,4,0,"mat-error",9),r.Ub(),r.Ub()),2&e){const e=r.hc();r.Cb(4),r.mc("formControl",e.nameFormControl),r.Cb(1),r.mc("ngIf",e.nameFormControl.hasError("required"))}}const Je=function(e){return{authorization:!0,"check-animation":e}},Ze=function(e){return{disabled:e}};let Qe=(()=>{class e{constructor(e,t){this.modalsService=e,this.userFacade=t,this.startFaceLive=!1,this.buttonEnable=!0,this.checkAnimation=!1,this.subscription=[],this.nameFormControl=new i.c("",[i.n.required]),this.documentFormControl=new i.c("",[i.n.required]),this.nationality=new i.c("CO"),this.tipoDocumento=[{value:"CO",viewValue:"CC - Colombia"},{value:"MX",viewValue:"DNI - Mexico"}],this.authChecked=new i.c(!1,[i.n.requiredTrue])}ngOnDestroy(){this.subscription.forEach(e=>e.unsubscribe())}ngOnInit(){this.subscription.push(this.userFacade.GetCitizenInfoState$().subscribe(e=>{e?(console.log("startFaceLive",this.startFaceLive),this.startFaceLive=!0):(this.ClearControls(),this.EnableControls(!0))}))}showModalAuthorization(){this.modalsService.showContractAuthorizationDialog()}sendImageToValidate(e){this.startFaceLive=!1;const t=this.userFacade.GetCitizenInfoStateValue();this.userFacade.SendImageToEnroll({Imagen:e,GroupName:a,Provider:3,InformacionCiudadanoId:t.Id,Motivo:"",Descripcion:`${t.PrimerNombre} ${t.PrimerApellido}`,Codigo:`${t.NUIP}`,Tag:""})}Register(){this.SendUserData()}SendUserData(){!this.authChecked.value||!this.documentFormControl.value&&""===this.documentFormControl.value||"CO"!==this.nationality.value&&!this.nameFormControl.value&&""===this.nameFormControl.value?(this.documentFormControl.markAllAsTouched(),this.nameFormControl.markAllAsTouched(),this.checkAnimation||(this.checkAnimation=!this.authChecked.value,setTimeout(()=>this.checkAnimation=!1,400))):(this.EnableControls(!1),this.userFacade.SendToDocumentValidate({Data:{CodigoAplicacion:"B09E1729-CDDB-40E7-86BD-F7AF5461B7D8",Documento:this.documentFormControl.value,TipoDocumento:1,Nacionalidad:this.nationality.value,NombreCompleto:this.nameFormControl.value},Provider:3,GroupName:a}))}ClearControls(){this.authChecked.setValue(!1),this.documentFormControl.setValue(""),this.nameFormControl.setValue(""),this.nationality.setValue("CO"),this.authChecked.markAsUntouched(),this.documentFormControl.markAsUntouched(),this.nameFormControl.markAsUntouched(),this.nationality.markAsUntouched()}EnableControls(e){e?this.authChecked.enable():this.authChecked.disable(),e?this.documentFormControl.enable():this.documentFormControl.disable(),e?this.nameFormControl.enable():this.nameFormControl.disable(),e?this.nationality.enable():this.nationality.disable(),this.buttonEnable=e}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(m),r.Pb(C))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-users-register"]],decls:28,vars:14,consts:[[1,"container"],[1,"message"],[1,"control"],[1,"form-row"],[1,"w30"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[1,"w70","pl5"],["matInput","","placeholder","Ingrese su c\xe9dula de ciudadania",3,"formControl"],[4,"ngIf"],["class","form-row",4,"ngIf"],[1,"camera"],[3,"startFaceLive","livefaceImage","startFaceLiveChange"],[3,"ngClass"],[2,"color","rgb(153,217,243)","cursor","pointer",3,"click"],[1,"button"],["mat-raised-button","","color","primary",3,"disabled","ngClass","click"],[3,"value"],[1,"w100"],["matInput","","placeholder","Ingrese su nombre completo",3,"formControl"]],template:function(e,t){1&e&&(r.Vb(0,"section",0),r.Vb(1,"span",1),r.Ac(2,"COMPLETE LA INFORMACION PARA CONTINUAR"),r.Ub(),r.Vb(3,"div",2),r.Vb(4,"div",3),r.Vb(5,"mat-form-field",4),r.Vb(6,"mat-label"),r.Ac(7,"Tipo de documento"),r.Ub(),r.Vb(8,"mat-select",5),r.zc(9,qe,2,2,"mat-option",6),r.Ub(),r.Ub(),r.Vb(10,"mat-form-field",7),r.Vb(11,"mat-label"),r.Ac(12,"Ingrese su n\xfamero de identificaci\xf3n"),r.Ub(),r.Qb(13,"input",8),r.zc(14,He,4,0,"mat-error",9),r.Ub(),r.Ub(),r.zc(15,Xe,6,2,"div",10),r.Ub(),r.Vb(16,"div",11),r.Vb(17,"app-liveface-camera",12),r.dc("livefaceImage",(function(e){return t.sendImageToValidate(e)}))("startFaceLiveChange",(function(e){return t.startFaceLive=e})),r.Ub(),r.Ub(),r.Vb(18,"div",13),r.Qb(19,"mat-checkbox",5),r.Vb(20,"span"),r.Ac(21,"Acepto la "),r.Vb(22,"span",14),r.dc("click",(function(){return t.showModalAuthorization()})),r.Ac(23,"autorizaci\xf3n del tratamiento de datos personales"),r.Ub(),r.Ac(24," de ReconoSER ID"),r.Ub(),r.Ub(),r.Vb(25,"div",15),r.Vb(26,"button",16),r.dc("click",(function(){return t.Register()})),r.Ac(27,"Iniciar"),r.Ub(),r.Ub(),r.Ub()),2&e&&(r.Cb(8),r.mc("formControl",t.nationality),r.Cb(1),r.mc("ngForOf",t.tipoDocumento),r.Cb(4),r.mc("formControl",t.documentFormControl),r.Cb(1),r.mc("ngIf",t.documentFormControl.hasError("required")),r.Cb(1),r.mc("ngIf","MX"===t.nationality.value),r.Cb(2),r.mc("startFaceLive",t.startFaceLive),r.Cb(1),r.mc("ngClass",r.oc(10,Je,t.checkAnimation)),r.Cb(1),r.mc("formControl",t.authChecked),r.Cb(7),r.mc("disabled",!t.buttonEnable)("ngClass",r.oc(12,Ze,!t.buttonEnable)))},directives:[R.c,R.f,x.a,i.k,i.d,k.j,M.a,i.b,k.k,Ne,k.i,We.a,Ge.b,$e.f,R.b],styles:['@charset "UTF-8";@font-face{font-family:OpenSans-Regular;src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot);src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot?#iefix) format("embedded-opentype"),url(OpenSans-Regular.5d5735e57127db2f7a2a.woff2) format("woff2"),url(OpenSans-Regular.6fde2eb6728eb97fd914.woff) format("woff"),url(OpenSans-Regular.8df00d6176ddae387d94.ttf) format("truetype"),url(OpenSans-Regular.bbbd47d2660d3547e98a.svg#OpenSans-Regular) format("svg");font-weight:400;font-style:normal}@font-face{font-family:OpenSans-ExtraBoldItalic;src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot);src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBoldItalic.d69a748730ffaa1494fb.woff2) format("woff2"),url(OpenSans-ExtraBoldItalic.edbbf5335fcb1e037d0e.woff) format("woff"),url(OpenSans-ExtraBoldItalic.f093928db8789603f791.ttf) format("truetype"),url(OpenSans-ExtraBoldItalic.60cbf3ab7cbcb2732e3c.svg#OpenSans-ExtraBoldItalic) format("svg");font-weight:800;font-style:italic}@font-face{font-family:OpenSans-SemiBold;src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot);src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBold.7106bb83a0e767e12659.woff2) format("woff2"),url(OpenSans-SemiBold.fe241c6c4f5a190e821b.woff) format("woff"),url(OpenSans-SemiBold.f28ed2e40f2a6955ddc5.ttf) format("truetype"),url(OpenSans-SemiBold.dd308ca05314118f5410.svg#OpenSans-SemiBold) format("svg");font-weight:600;font-style:normal}@font-face{font-family:OpenSans-Bold;src:url(OpenSans-Bold.5487bea91cef82008fdc.eot);src:url(OpenSans-Bold.5487bea91cef82008fdc.eot?#iefix) format("embedded-opentype"),url(OpenSans-Bold.93fe8f3415688d16bb94.woff2) format("woff2"),url(OpenSans-Bold.759ea19bccf8a5ca50a5.woff) format("woff"),url(OpenSans-Bold.ab38fda09644c992dc09.ttf) format("truetype"),url(OpenSans-Bold.8eb005f737c1e60d2e4d.svg#OpenSans-Bold) format("svg");font-weight:700;font-style:normal}@font-face{font-family:OpenSans-LightItalic;src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot);src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot?#iefix) format("embedded-opentype"),url(OpenSans-LightItalic.d821368c1b1a2f95186f.woff2) format("woff2"),url(OpenSans-LightItalic.f98d42be17e95311f1f8.woff) format("woff"),url(OpenSans-LightItalic.5a3ac4d0297da9f2b75c.ttf) format("truetype"),url(OpenSans-LightItalic.1d7a2f3d597960cd5d37.svg#OpenSans-LightItalic) format("svg");font-weight:300;font-style:italic}@font-face{font-family:OpenSans-BoldItalic;src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot);src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot?#iefix) format("embedded-opentype"),url(OpenSans-BoldItalic.183f1aa2eb319f83e073.woff2) format("woff2"),url(OpenSans-BoldItalic.0a96d2322aa762873140.woff) format("woff"),url(OpenSans-BoldItalic.ad5795be528d8256833a.ttf) format("truetype"),url(OpenSans-BoldItalic.bcbc56117328195e6bd3.svg#OpenSans-BoldItalic) format("svg");font-weight:700;font-style:italic}@font-face{font-family:OpenSans-SemiBoldItalic;src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot);src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBoldItalic.da6f476d3784fdfb4b33.woff2) format("woff2"),url(OpenSans-SemiBoldItalic.02669c88881b1577a54e.woff) format("woff"),url(OpenSans-SemiBoldItalic.3dc654f4cee24692f644.ttf) format("truetype"),url(OpenSans-SemiBoldItalic.045ad4303be6beb367d6.svg#OpenSans-SemiBoldItalic) format("svg");font-weight:600;font-style:italic}@font-face{font-family:OpenSans-Italic;src:url(OpenSans-Italic.1ec1b222862acc96228e.eot);src:url(OpenSans-Italic.1ec1b222862acc96228e.eot?#iefix) format("embedded-opentype"),url(OpenSans-Italic.c27ebc192b3fe6167aa9.woff2) format("woff2"),url(OpenSans-Italic.052b69c9c418c621fbd9.woff) format("woff"),url(OpenSans-Italic.a709ab6006407a103054.ttf) format("truetype"),url(OpenSans-Italic.2d835a9a0d5ab7cc6f62.svg#OpenSans-Italic) format("svg");font-weight:400;font-style:italic}@font-face{font-family:OpenSans-Light;src:url(OpenSans-Light.d8ba00bc265c4a055470.eot);src:url(OpenSans-Light.d8ba00bc265c4a055470.eot?#iefix) format("embedded-opentype"),url(OpenSans-Light.559e978f49dc58dbe421.woff2) format("woff2"),url(OpenSans-Light.c002a58fc48427af4884.woff) format("woff"),url(OpenSans-Light.b270c40ae5ed0192f44d.ttf) format("truetype"),url(OpenSans-Light.f78850b7adbe96ff18c9.svg#OpenSans-Light) format("svg");font-weight:300;font-style:normal}@font-face{font-family:OpenSans-ExtraBold;src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot);src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBold.1b2c3c4788d5f305789b.woff2) format("woff2"),url(OpenSans-ExtraBold.3f760f718edb65cd95c6.woff) format("woff"),url(OpenSans-ExtraBold.c9e437c181cb1c201188.ttf) format("truetype"),url(OpenSans-ExtraBold.a1a888c4158a9167d356.svg#OpenSans-ExtraBold) format("svg");font-weight:800;font-style:normal}@font-face{font-family:icomoon;src:url(icomoon.d25461326f680e27f6b9.eot?a80olx);src:url(icomoon.d25461326f680e27f6b9.eot?a80olx#iefix) format("embedded-opentype"),url(icomoon.5394b2a687c21e82faff.ttf?a80olx) format("truetype"),url(icomoon.ee719c35803c2cdae449.woff?a80olx) format("woff"),url(icomoon.36f8bbc7721d58817f5a.svg?a80olx#icomoon) format("svg");font-weight:400;font-style:normal;font-display:block}[class*=" icon-"][_ngcontent-%COMP%], [class^=icon-][_ngcontent-%COMP%]{font-family:icomoon!important;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon--no-camera[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue90e";color:#ededed}.icon--no-camera[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue90f";margin-left:-1em;color:#dd141d}.icon--hide-pass[_ngcontent-%COMP%]:before{content:"\ue90c"}.icon--show-pass[_ngcontent-%COMP%]:before{content:"\ue90d"}.icon--end-process[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue9a7";color:rgba(255,186,0,.4)}.icon--end-process[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue9a8";margin-left:-1em;color:#ffba00}.icon--rotate-camera[_ngcontent-%COMP%]:before{content:"\ue900";color:#fff}.icon--rotate-document[_ngcontent-%COMP%]:before{content:"\ue901"}.icon--take-photo[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue902";color:hsla(0,0%,100%,.5)}.icon--take-photo[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue903";margin-left:-1em;color:#fff}.icon--check[_ngcontent-%COMP%]:before{content:"\ue904";color:#fff}.icon--close[_ngcontent-%COMP%]:before{content:"\ue905";color:#fff}.icon--back-document[_ngcontent-%COMP%]:before{content:"\ue906";color:#fff}.icon--front-document[_ngcontent-%COMP%]:before{content:"\ue907";color:#fff}.icon--scan-document[_ngcontent-%COMP%]:before{content:"\ue908";color:#fff}.icon--face[_ngcontent-%COMP%]:before{content:"\ue909";color:#fff}.icon--user-form[_ngcontent-%COMP%]:before{content:"\ue90a";color:#fff}.icon--light[_ngcontent-%COMP%]:before{content:"\ue90b";color:#fff}.icon--pirate[_ngcontent-%COMP%]:before{content:"\ue9a4";color:#fff}.icon--questions[_ngcontent-%COMP%]:before{content:"\ue9a5";color:#fff}.icon--user-data[_ngcontent-%COMP%]:before{content:"\ue9a6";color:#fff}@-webkit-keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@-webkit-keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}.mat-dialog-container[_ngcontent-%COMP%]{padding:0!important}.check-animation[_ngcontent-%COMP%]{-webkit-animation-duration:.1s;animation-duration:.1s;-webkit-animation-name:slidein;animation-name:slidein;-webkit-animation-iteration-count:6;animation-iteration-count:6;-webkit-animation-direction:alternate;animation-direction:alternate}@-webkit-keyframes slidein{0%{transform:scale(1)}to{transform:scale(1.05)}}@keyframes slidein{0%{transform:scale(1)}to{transform:scale(1.05)}}.container[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:column;flex-direction:column;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;-moz-align-items:center;-ms-align-items:center;align-items:center;width:700px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:2% 0}.container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{background-color:#f4f4f4;height:1.36rem}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{display:flex;-moz-align-items:center;-ms-align-items:center;align-items:center;width:100%;padding-left:5%;font-size:1rem}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]{-moz-flex-direction:column;flex-direction:column;padding-top:1rem}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;flex-wrap:nowrap;-moz-align-items:center;-ms-align-items:center;align-items:center;-ms-align-content:stretch;align-content:stretch;width:100%;padding-right:5%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .w30[_ngcontent-%COMP%]{width:30%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .w70[_ngcontent-%COMP%]{width:70%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .pl5[_ngcontent-%COMP%]{padding-left:5%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .w100[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{position:relative;display:block;padding-top:.5rem;margin-top:0;width:680px;min-height:-webkit-fit-content;min-height:-moz-fit-content;min-height:fit-content}.container[_ngcontent-%COMP%]   .authorization[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;width:100%;padding-bottom:2%;padding-top:1.5rem;padding-left:5%;text-align:left;color:#bababa}.container[_ngcontent-%COMP%]   .authorization[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:last-child{padding-left:5px;font-size:.8rem;letter-spacing:1px}.container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{width:100%;display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:flex-end;-ms-justify-content:flex-end;justify-content:flex-end;-ms-flex-pack:flex-end;padding:2%}.container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#00a1e2;width:30%;letter-spacing:1px;bottom:7%;font-weight:100;font-size:16px}.container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{background-color:#d6d6d6;color:#666}@media (max-width:1366px){.container[_ngcontent-%COMP%]{width:480px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:450px}}@media (max-width:1024px){.container[_ngcontent-%COMP%]{width:460px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:440px}}']}),e})();var Ke=o("yuJt");const et=n.e.forChild([{path:"register",component:Qe},{path:"validation",component:(()=>{class e{constructor(e,t,o,n,i){this.modalsService=e,this.userFacade=t,this.videoRecorderService=o,this.locationFacade=n,this.router=i,this.startFaceLive=!0,this.subscription=[],this.helper=new Ke.a,this.browserName=Fe().name+" V"+Fe().version,this.osName=Fe().os}ngOnDestroy(){this.subscription.forEach(e=>e.unsubscribe())}ngOnInit(){this.FaceRecognitionInit()}FaceRecognitionInit(){const e=this.userFacade.GetfaceRecognitionState$();this.subscription.push(e.subscribe(e=>{if(e)if(e.Reconocido){let t="";const o=this.videoRecorderService.GetVideoRecorder();o&&(t=e.Detail.PrimerNombre+"-"+this.helper.convertToDate(new Date),o.name=t,this.userFacade.SendVideoRecorder(o)),this.userFacade.SetToUsersHistoric(this.BuildHistoricoRequest(e,t)),this.userFacade.GetUsersHistoricById(e.IdFeature),this.modalsService.showRecognizedCitizen({info:e,lastUpdate:this.userFacade.GetusersHistoricLast$()}).afterClosed().subscribe(e=>{e&&this.router.navigate(["/home/register"],{fragment:"information"})})}else this.subscription.push(this.modalsService.showAlertNotificationDialog({info:"No identificado",title:"Error",icon:"bad"}).afterClosed().subscribe(e=>{setTimeout(()=>{this.startFaceLive=!0},2e3)}))}))}BuildHistoricoRequest(e,t){return{VideoUrl:t,Provider:3,GroupName:a,IdFeature:e.IdFeature,Ip:this.locationFacade.deviceIp$.value,Browser:this.browserName,SistemaOperativo:this.osName,Descripcion:e.Descripcion,Fecha:this.helper.convertToDateFormat(new Date)}}sendImageToValidate(e){this.userFacade.SendToIdentificationFace({Imagen:e,GroupName:a,Provider:3})}}return e.\u0275fac=function(t){return new(t||e)(r.Pb(m),r.Pb(C),r.Pb(De),r.Pb(y),r.Pb(n.b))},e.\u0275cmp=r.Jb({type:e,selectors:[["app-users-validation"]],decls:10,vars:1,consts:[[1,"container"],[1,"message"],[1,"camera"],[3,"startFaceLive","livefaceImage","startFaceLiveChange"],[1,"footer"],[1,"material-icons"]],template:function(e,t){1&e&&(r.Vb(0,"section",0),r.Vb(1,"span",1),r.Ac(2,"SIGA LAS INDICACIONES EN PANTALLA"),r.Ub(),r.Vb(3,"div",2),r.Vb(4,"app-liveface-camera",3),r.dc("livefaceImage",(function(e){return t.sendImageToValidate(e)}))("startFaceLiveChange",(function(e){return t.startFaceLive=e})),r.Ub(),r.Ub(),r.Vb(5,"div",4),r.Vb(6,"i",5),r.Ac(7,"error"),r.Ub(),r.Vb(8,"span"),r.Ac(9,"El rostro que se capture se comparar\xe1 frente a todos los rostros registrados en esta plataforma."),r.Ub(),r.Ub(),r.Ub()),2&e&&(r.Cb(4),r.mc("startFaceLive",t.startFaceLive))},directives:[Ne],styles:['@charset "UTF-8";@font-face{font-family:OpenSans-Regular;src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot);src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot?#iefix) format("embedded-opentype"),url(OpenSans-Regular.5d5735e57127db2f7a2a.woff2) format("woff2"),url(OpenSans-Regular.6fde2eb6728eb97fd914.woff) format("woff"),url(OpenSans-Regular.8df00d6176ddae387d94.ttf) format("truetype"),url(OpenSans-Regular.bbbd47d2660d3547e98a.svg#OpenSans-Regular) format("svg");font-weight:400;font-style:normal}@font-face{font-family:OpenSans-ExtraBoldItalic;src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot);src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBoldItalic.d69a748730ffaa1494fb.woff2) format("woff2"),url(OpenSans-ExtraBoldItalic.edbbf5335fcb1e037d0e.woff) format("woff"),url(OpenSans-ExtraBoldItalic.f093928db8789603f791.ttf) format("truetype"),url(OpenSans-ExtraBoldItalic.60cbf3ab7cbcb2732e3c.svg#OpenSans-ExtraBoldItalic) format("svg");font-weight:800;font-style:italic}@font-face{font-family:OpenSans-SemiBold;src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot);src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBold.7106bb83a0e767e12659.woff2) format("woff2"),url(OpenSans-SemiBold.fe241c6c4f5a190e821b.woff) format("woff"),url(OpenSans-SemiBold.f28ed2e40f2a6955ddc5.ttf) format("truetype"),url(OpenSans-SemiBold.dd308ca05314118f5410.svg#OpenSans-SemiBold) format("svg");font-weight:600;font-style:normal}@font-face{font-family:OpenSans-Bold;src:url(OpenSans-Bold.5487bea91cef82008fdc.eot);src:url(OpenSans-Bold.5487bea91cef82008fdc.eot?#iefix) format("embedded-opentype"),url(OpenSans-Bold.93fe8f3415688d16bb94.woff2) format("woff2"),url(OpenSans-Bold.759ea19bccf8a5ca50a5.woff) format("woff"),url(OpenSans-Bold.ab38fda09644c992dc09.ttf) format("truetype"),url(OpenSans-Bold.8eb005f737c1e60d2e4d.svg#OpenSans-Bold) format("svg");font-weight:700;font-style:normal}@font-face{font-family:OpenSans-LightItalic;src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot);src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot?#iefix) format("embedded-opentype"),url(OpenSans-LightItalic.d821368c1b1a2f95186f.woff2) format("woff2"),url(OpenSans-LightItalic.f98d42be17e95311f1f8.woff) format("woff"),url(OpenSans-LightItalic.5a3ac4d0297da9f2b75c.ttf) format("truetype"),url(OpenSans-LightItalic.1d7a2f3d597960cd5d37.svg#OpenSans-LightItalic) format("svg");font-weight:300;font-style:italic}@font-face{font-family:OpenSans-BoldItalic;src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot);src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot?#iefix) format("embedded-opentype"),url(OpenSans-BoldItalic.183f1aa2eb319f83e073.woff2) format("woff2"),url(OpenSans-BoldItalic.0a96d2322aa762873140.woff) format("woff"),url(OpenSans-BoldItalic.ad5795be528d8256833a.ttf) format("truetype"),url(OpenSans-BoldItalic.bcbc56117328195e6bd3.svg#OpenSans-BoldItalic) format("svg");font-weight:700;font-style:italic}@font-face{font-family:OpenSans-SemiBoldItalic;src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot);src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBoldItalic.da6f476d3784fdfb4b33.woff2) format("woff2"),url(OpenSans-SemiBoldItalic.02669c88881b1577a54e.woff) format("woff"),url(OpenSans-SemiBoldItalic.3dc654f4cee24692f644.ttf) format("truetype"),url(OpenSans-SemiBoldItalic.045ad4303be6beb367d6.svg#OpenSans-SemiBoldItalic) format("svg");font-weight:600;font-style:italic}@font-face{font-family:OpenSans-Italic;src:url(OpenSans-Italic.1ec1b222862acc96228e.eot);src:url(OpenSans-Italic.1ec1b222862acc96228e.eot?#iefix) format("embedded-opentype"),url(OpenSans-Italic.c27ebc192b3fe6167aa9.woff2) format("woff2"),url(OpenSans-Italic.052b69c9c418c621fbd9.woff) format("woff"),url(OpenSans-Italic.a709ab6006407a103054.ttf) format("truetype"),url(OpenSans-Italic.2d835a9a0d5ab7cc6f62.svg#OpenSans-Italic) format("svg");font-weight:400;font-style:italic}@font-face{font-family:OpenSans-Light;src:url(OpenSans-Light.d8ba00bc265c4a055470.eot);src:url(OpenSans-Light.d8ba00bc265c4a055470.eot?#iefix) format("embedded-opentype"),url(OpenSans-Light.559e978f49dc58dbe421.woff2) format("woff2"),url(OpenSans-Light.c002a58fc48427af4884.woff) format("woff"),url(OpenSans-Light.b270c40ae5ed0192f44d.ttf) format("truetype"),url(OpenSans-Light.f78850b7adbe96ff18c9.svg#OpenSans-Light) format("svg");font-weight:300;font-style:normal}@font-face{font-family:OpenSans-ExtraBold;src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot);src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBold.1b2c3c4788d5f305789b.woff2) format("woff2"),url(OpenSans-ExtraBold.3f760f718edb65cd95c6.woff) format("woff"),url(OpenSans-ExtraBold.c9e437c181cb1c201188.ttf) format("truetype"),url(OpenSans-ExtraBold.a1a888c4158a9167d356.svg#OpenSans-ExtraBold) format("svg");font-weight:800;font-style:normal}@font-face{font-family:icomoon;src:url(icomoon.d25461326f680e27f6b9.eot?a80olx);src:url(icomoon.d25461326f680e27f6b9.eot?a80olx#iefix) format("embedded-opentype"),url(icomoon.5394b2a687c21e82faff.ttf?a80olx) format("truetype"),url(icomoon.ee719c35803c2cdae449.woff?a80olx) format("woff"),url(icomoon.36f8bbc7721d58817f5a.svg?a80olx#icomoon) format("svg");font-weight:400;font-style:normal;font-display:block}[class*=" icon-"][_ngcontent-%COMP%], [class^=icon-][_ngcontent-%COMP%]{font-family:icomoon!important;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon--no-camera[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue90e";color:#ededed}.icon--no-camera[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue90f";margin-left:-1em;color:#dd141d}.icon--hide-pass[_ngcontent-%COMP%]:before{content:"\ue90c"}.icon--show-pass[_ngcontent-%COMP%]:before{content:"\ue90d"}.icon--end-process[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue9a7";color:rgba(255,186,0,.4)}.icon--end-process[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue9a8";margin-left:-1em;color:#ffba00}.icon--rotate-camera[_ngcontent-%COMP%]:before{content:"\ue900";color:#fff}.icon--rotate-document[_ngcontent-%COMP%]:before{content:"\ue901"}.icon--take-photo[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue902";color:hsla(0,0%,100%,.5)}.icon--take-photo[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue903";margin-left:-1em;color:#fff}.icon--check[_ngcontent-%COMP%]:before{content:"\ue904";color:#fff}.icon--close[_ngcontent-%COMP%]:before{content:"\ue905";color:#fff}.icon--back-document[_ngcontent-%COMP%]:before{content:"\ue906";color:#fff}.icon--front-document[_ngcontent-%COMP%]:before{content:"\ue907";color:#fff}.icon--scan-document[_ngcontent-%COMP%]:before{content:"\ue908";color:#fff}.icon--face[_ngcontent-%COMP%]:before{content:"\ue909";color:#fff}.icon--user-form[_ngcontent-%COMP%]:before{content:"\ue90a";color:#fff}.icon--light[_ngcontent-%COMP%]:before{content:"\ue90b";color:#fff}.icon--pirate[_ngcontent-%COMP%]:before{content:"\ue9a4";color:#fff}.icon--questions[_ngcontent-%COMP%]:before{content:"\ue9a5";color:#fff}.icon--user-data[_ngcontent-%COMP%]:before{content:"\ue9a6";color:#fff}@-webkit-keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@-webkit-keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}.container[_ngcontent-%COMP%]{-moz-flex-direction:column;flex-direction:column;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;width:700px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:2% 0}.container[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{display:flex;-moz-align-items:center;-ms-align-items:center;align-items:center}.container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{width:100%;padding-left:5%;background-color:#f4f4f4;font-size:1rem;height:1.36rem}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{position:relative;display:block;padding-top:.5rem;margin-top:0;width:680px;min-height:-webkit-fit-content;min-height:-moz-fit-content;min-height:fit-content}.container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;-moz-align-items:center;-ms-align-items:center;align-items:center;color:#f84751;font-size:1rem;padding-left:5%}.container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{font-size:1.8rem;padding-right:10px}@media (max-width:1366px){.container[_ngcontent-%COMP%]{width:480px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:450px;background:0}}@media (max-width:1024px){.container[_ngcontent-%COMP%]{width:460px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:440px}}']}),e})()}]);var tt=o("cnhx"),ot=o("VEcq");o.d(t,"UsersModule",(function(){return nt}));let nt=(()=>{class e{}return e.\u0275mod=r.Nb({type:e}),e.\u0275inj=r.Mb({factory:function(t){return new(t||e)},imports:[[tt.a,ot.a,et]]}),e})()},RdDz:function(e,t,o){var n,i;void 0===(i="function"==typeof(n=function(){"use strict";return function(e,t,o){t=t||"",o=o||512;for(var n=atob(e),i=[],a=0;a<n.length;a+=o){for(var r=n.slice(a,a+o),s=new Array(r.length),c=0;c<r.length;c++)s[c]=r.charCodeAt(c);var d=new Uint8Array(s);i.push(d)}return new Blob(i,{type:t})}})?n.apply(t,[]):n)||(e.exports=i)},qe5e:function(e,t,o){"use strict";var n,i;function a(e,t){if(!e)throw"First parameter is required.";t=new r(e,t=t||{type:"video"});var o=this;function n(o){o&&(t.initCallback=function(){o(),o=t.initCallback=null});var n=new s(e,t);(u=new n(e,t)).record(),f("recording"),t.disableLogs||console.log("Initialized recorderType:",u.constructor.name,"for output-type:",t.type)}function i(e){if(e=e||function(){},u){if("paused"===o.state)return o.resumeRecording(),void setTimeout((function(){i(e)}),1);"recording"===o.state||t.disableLogs||console.warn('Recording state should be: "recording", however current state is: ',o.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),"gif"!==t.type?u.stop(n):(u.stop(),n()),f("stopped")}else p();function n(n){if(u){Object.keys(u).forEach((function(e){"function"!=typeof u[e]&&(o[e]=u[e])}));var i=u.blob;if(!i){if(!n)throw"Recording failed.";u.blob=i=n}if(i&&!t.disableLogs&&console.log(i.type,"->",S(i.size)),e){var a;try{a=m.createObjectURL(i)}catch(r){}"function"==typeof e.call?e.call(o,a):e(a)}t.autoWriteToDisk&&d((function(e){var o={};o[t.type+"Blob"]=e,T.Store(o)}))}else"function"==typeof e.call?e.call(o,""):e("")}}function c(e){postMessage((new FileReaderSync).readAsDataURL(e))}function d(e,o){if(!e)throw"Pass a callback function over getDataURL.";var n=o?o.blob:(u||{}).blob;if(!n)return t.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout((function(){d(e,o)}),1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var i=new FileReader;i.readAsDataURL(n),i.onload=function(t){e(t.target.result)}}else{var a=function(e){try{var t=m.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),o=new Worker(t);return m.revokeObjectURL(t),o}catch(n){}}(c);a.onmessage=function(t){e(t.data)},a.postMessage(n)}}function l(e){e=e||0,"paused"!==o.state?"stopped"!==o.state&&(e>=o.recordingDuration?i(o.onRecordingStopped):(e+=1e3,setTimeout((function(){l(e)}),1e3))):setTimeout((function(){l(e)}),1e3)}function f(e){o&&(o.state=e,"function"==typeof o.onStateChanged.call?o.onStateChanged.call(o,e):o.onStateChanged(e))}var u,h='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function p(){!0!==t.disableLogs&&console.warn(h)}var g={startRecording:function(i){return t.disableLogs||console.log("RecordRTC version: ",o.version),i&&(t=new r(e,i)),t.disableLogs||console.log("started recording "+t.type+" stream."),u?(u.clearRecordedData(),u.record(),f("recording"),o.recordingDuration&&l(),o):(n((function(){o.recordingDuration&&l()})),o)},stopRecording:i,pauseRecording:function(){u?"recording"===o.state?(f("paused"),u.pause(),t.disableLogs||console.log("Paused recording.")):t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",o.state):p()},resumeRecording:function(){u?"paused"===o.state?(f("recording"),u.resume(),t.disableLogs||console.log("Resumed recording.")):t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",o.state):p()},initRecorder:n,setRecordingDuration:function(e,t){if(void 0===e)throw"recordingDuration is required.";if("number"!=typeof e)throw"recordingDuration must be a number.";return o.recordingDuration=e,o.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){o.onRecordingStopped=e}}},clearRecordedData:function(){u?(u.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")):p()},getBlob:function(){if(u)return u.blob;p()},getDataURL:d,toURL:function(){if(u)return m.createObjectURL(u.blob);p()},getInternalRecorder:function(){return u},save:function(e){u?y(u.blob,e):p()},getFromDisk:function(e){u?a.getFromDisk(t.type,e):p()},setAdvertisementArray:function(e){t.advertisement=[];for(var o=e.length,n=0;n<o;n++)t.advertisement.push({duration:n,image:e[n]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"!==o.state||t.disableLogs||console.warn("Stop an active recorder."),u&&"function"==typeof u.clearRecordedData&&u.clearRecordedData(),u=null,f("inactive"),o.blob=null},onStateChanged:function(e){t.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return o.state},destroy:function(){var e=t.disableLogs;t={disableLogs:!0},o.reset(),f("destroyed"),g=o=null,x.AudioContextConstructor&&(x.AudioContextConstructor.close(),x.AudioContextConstructor=null),t.disableLogs=e,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.5.9"};if(!this)return o=g,g;for(var b in g)this[b]=g[b];return o=this,g}function r(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===A||t.recorderType===P||t.recorderType===_?t.type="video":t.recorderType===F?t.type="gif":t.recorderType===I?t.type="audio":t.recorderType===M&&(C(e,"audio").length&&C(e,"video").length?t.type="video":!C(e,"audio").length&&C(e,"video").length?t.type="video":C(e,"audio").length&&!C(e,"video").length&&(t.type="audio"))),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0])),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}function s(e,t){var o;return(b||h||p)&&(o=I),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!b&&(o=M),"video"===t.type&&(b||p)&&(o=A,"undefined"!=typeof ReadableStream&&(o=_)),"gif"===t.type&&(o=F),"canvas"===t.type&&(o=P),k()&&o!==P&&o!==F&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(C(e,"video").length||C(e,"audio").length)&&("audio"===t.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(o=M):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(o=M)),e instanceof Array&&e.length&&(o=E),t.recorderType&&(o=t.recorderType),!t.disableLogs&&o&&o.name&&console.log("Using recorderType:",o.name||o.constructor.name),!o&&v&&(o=M),o}function c(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,o=this.mediaType,n=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof o.audio&&k()&&!C(e,"audio").length&&(o.audio=!1),"function"!=typeof o.video&&k()&&!C(e,"video").length&&(o.video=!1),"function"!=typeof o.gif&&k()&&!C(e,"video").length&&(o.gif=!1),!o.audio&&!o.video&&!o.gif)throw"MediaStream must have either audio or video tracks.";if(o.audio&&(t=null,"function"==typeof o.audio&&(t=o.audio),this.audioRecorder=new a(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:n.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),o.video||this.audioRecorder.startRecording()),o.video){t=null,"function"==typeof o.video&&(t=o.video);var i=e;if(k()&&o.audio&&"function"==typeof o.audio){var r=C(e,"video")[0];g?((i=new w).addTrack(r),t&&t===A&&(t=M)):(i=new w).addTrack(r)}this.videoRecorder=new a(i,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:n.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),o.audio||this.videoRecorder.startRecording()}if(o.audio&&o.video){var s=this,c=!0===k();o.audio instanceof I&&o.video?c=!1:!0!==o.audio&&!0!==o.video&&o.audio!==o.video&&(c=!1),!0===c?(s.audioRecorder=null,s.videoRecorder.startRecording()):s.videoRecorder.initRecorder((function(){s.audioRecorder.initRecorder((function(){s.videoRecorder.startRecording(),s.audioRecorder.startRecording()}))}))}o.gif&&(t=null,"function"==typeof o.gif&&(t=o.gif),this.gifRecorder=new a(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:n.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording((function(t){e(t,"audio")})),this.videoRecorder&&this.videoRecorder.stopRecording((function(t){e(t,"video")})),this.gifRecorder&&this.gifRecorder.stopRecording((function(t){e(t,"gif")}))},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function t(e,t){if("undefined"!=typeof Worker){var o=function(e){var t,o=m.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),n=new Worker(o);if(void 0!==m)t=m;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(o),n}((function(e){postMessage((new FileReaderSync).readAsDataURL(e))}));o.onmessage=function(e){t(e.data)},o.postMessage(e)}else{var n=new FileReader;n.readAsDataURL(e),n.onload=function(e){t(e.target.result)}}}this.getBlob((function(o){o.audio&&o.video?t(o.audio,(function(n){t(o.video,(function(t){e({audio:n,video:t})}))})):o.audio?t(o.audio,(function(t){e({audio:t})})):o.video&&t(o.video,(function(t){e({video:t})}))}))},this.writeToDisk=function(){a.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){(e=e||{audio:!0,video:!0,gif:!0}).audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}a.version="5.5.9",e.exports=a,void 0===(n=(function(){return a}).apply(t,[]))||(e.exports=n),a.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),T.Fetch((function(o,n){"all"!==e&&n===e+"Blob"&&t&&t(o),"all"===e&&t&&t(o,n.replace("Blob",""))}))},a.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),(e=e||{}).audio&&e.video&&e.gif?e.audio.getDataURL((function(t){e.video.getDataURL((function(o){e.gif.getDataURL((function(e){T.Store({audioBlob:t,videoBlob:o,gifBlob:e})}))}))})):e.audio&&e.video?e.audio.getDataURL((function(t){e.video.getDataURL((function(e){T.Store({audioBlob:t,videoBlob:e})}))})):e.audio&&e.gif?e.audio.getDataURL((function(t){e.gif.getDataURL((function(e){T.Store({audioBlob:t,gifBlob:e})}))})):e.video&&e.gif?e.video.getDataURL((function(t){e.gif.getDataURL((function(e){T.Store({videoBlob:t,gifBlob:e})}))})):e.audio?e.audio.getDataURL((function(e){T.Store({audioBlob:e})})):e.video?e.video.getDataURL((function(e){T.Store({videoBlob:e})})):e.gif&&e.gif.getDataURL((function(e){T.Store({gifBlob:e})}))},c.getFromDisk=a.getFromDisk,c.writeToDisk=a.writeToDisk,a.MRecordRTC=c,(i="undefined"!=typeof global?global:null)&&"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},global.console||(global.console={}),void 0!==global.console.log&&void 0!==global.console.error||(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(i.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},i.HTMLVideoElement=function(){}),"undefined"==typeof location&&(i.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(i.screen={width:0,height:0}),void 0===m&&(i.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),i.window=global);var d=window.requestAnimationFrame;if(void 0===d)if("undefined"!=typeof webkitRequestAnimationFrame)d=webkitRequestAnimationFrame;else if("undefined"!=typeof mozRequestAnimationFrame)d=mozRequestAnimationFrame;else if("undefined"!=typeof msRequestAnimationFrame)d=msRequestAnimationFrame;else if(void 0===d){var l=0;d=function(e,t){var o=(new Date).getTime(),n=Math.max(0,16-(o-l)),i=setTimeout((function(){e(o+n)}),n);return l=o+n,i}}var f=window.cancelAnimationFrame;void 0===f&&("undefined"!=typeof webkitCancelAnimationFrame?f=webkitCancelAnimationFrame:"undefined"!=typeof mozCancelAnimationFrame?f=mozCancelAnimationFrame:"undefined"!=typeof msCancelAnimationFrame?f=msCancelAnimationFrame:void 0===f&&(f=function(e){clearTimeout(e)}));var u=window.AudioContext;void 0===u&&("undefined"!=typeof webkitAudioContext&&(u=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(u=mozAudioContext));var m=window.URL;void 0===m&&"undefined"!=typeof webkitURL&&(m=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var h=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),p=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),b=!p&&!h&&!!navigator.webkitGetUserMedia||O()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),v=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);v&&!b&&-1!==navigator.userAgent.indexOf("CriOS")&&(v=!1,b=!0);var w=window.MediaStream;function S(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function y(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(r){}var o=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var n=t.split(".");t=n[0],o=n[1]}var i=(t||Math.round(9999999999*Math.random())+888888888)+"."+o;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,i);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,i);var a=document.createElement("a");a.href=m.createObjectURL(e),a.download=i,a.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(a),"function"==typeof a.click?a.click():(a.target="_blank",a.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),m.revokeObjectURL(a.href)}function O(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}function C(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function R(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}void 0===w&&"undefined"!=typeof webkitMediaStream&&(w=webkitMediaStream),void 0!==w&&void 0===w.prototype.stop&&(w.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))}),a.invokeSaveAsDialog=y,a.getTracks=C,a.getSeekableBlob=function(e,t){if("undefined"==typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var o=new EBML.Reader,n=new EBML.Decoder,i=EBML.tools,a=new FileReader;a.onload=function(e){n.decode(this.result).forEach((function(e){o.read(e)})),o.stop();var a=i.makeMetadataSeekable(o.metadatas,o.duration,o.cues),r=this.result.slice(o.metadataSize),s=new Blob([a,r],{type:"video/webm"});t(s)},a.readAsArrayBuffer(e)},a.bytesToSize=S,a.isElectron=O;var x={};function k(){if(g||v||h)return!0;navigator;var e,t,o=navigator.userAgent,n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10);return(b||p)&&(e=o.indexOf("Chrome"),n=o.substring(e+7)),-1!==(t=n.indexOf(";"))&&(n=n.substring(0,t)),-1!==(t=n.indexOf(" "))&&(n=n.substring(0,t)),i=parseInt(""+n,10),isNaN(i)&&(n=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),i>=49}function M(e,t){var o,n=this;if(void 0===e)throw'First argument "MediaStream" is required.';if("undefined"==typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";"audio"===(t=t||{mimeType:"video/webm"}).type&&(C(e,"video").length&&C(e,"audio").length&&(navigator.mozGetUserMedia?(o=new w).addTrack(C(e,"audio")[0]):o=new w(C(e,"audio")),e=o),t.mimeType&&-1!==t.mimeType.toString().toLowerCase().indexOf("audio")||(t.mimeType=b?"audio/webm":"audio/ogg"),t.mimeType&&"audio/ogg"!==t.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(t.mimeType="audio/ogg"));var i,a=[];function r(){n.timestamps.push((new Date).getTime()),"function"==typeof t.onTimeStamp&&t.onTimeStamp(n.timestamps[n.timestamps.length-1],n.timestamps)}function s(e){return i&&i.mimeType?i.mimeType:e.mimeType||"video/webm"}function c(){a=[],i=null,n.timestamps=[]}this.getArrayOfBlobs=function(){return a},this.record=function(){n.blob=null,n.clearRecordedData(),n.timestamps=[],d=[],a=[];var o=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",o),i&&(i=null),b&&!k()&&(o="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&o.mimeType&&(MediaRecorder.isTypeSupported(o.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",o.mimeType),o.mimeType="audio"===t.type?"audio/webm":"video/webm"));try{i=new MediaRecorder(e,o),t.mimeType=o.mimeType}catch(c){i=new MediaRecorder(e)}o.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in i&&!1===i.canRecordMimeType(o.mimeType)&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",o.mimeType)),i.ondataavailable=function(e){if(e.data&&d.push("ondataavailable: "+S(e.data.size)),"number"!=typeof t.timeSlice)!e.data||!e.data.size||e.data.size<100||n.blob?n.recordingCallback&&(n.recordingCallback(new Blob([],{type:s(o)})),n.recordingCallback=null):(n.blob=t.getNativeBlob?e.data:new Blob([e.data],{type:s(o)}),n.recordingCallback&&(n.recordingCallback(n.blob),n.recordingCallback=null));else if(e.data&&e.data.size&&e.data.size>100&&(a.push(e.data),r(),"function"==typeof t.ondataavailable)){var i=t.getNativeBlob?e.data:new Blob([e.data],{type:s(o)});t.ondataavailable(i)}},i.onstart=function(){d.push("started")},i.onpause=function(){d.push("paused")},i.onresume=function(){d.push("resumed")},i.onstop=function(){d.push("stopped")},i.onerror=function(e){e&&(e.name||(e.name="UnknownError"),d.push("error: "+e),t.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",o.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),function(e){if(!n.manuallyStopped&&i&&"inactive"===i.state)return delete t.timeslice,void i.start(6e5);setTimeout(void 0,1e3)}(),"inactive"!==i.state&&"stopped"!==i.state&&i.stop())},"number"==typeof t.timeSlice?(r(),i.start(t.timeSlice)):i.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},n.manuallyStopped=!0,i&&(this.recordingCallback=e,"recording"===i.state&&i.stop(),"number"==typeof t.timeSlice&&setTimeout((function(){n.blob=new Blob(a,{type:s(t)}),n.recordingCallback(n.blob)}),100))},this.pause=function(){i&&"recording"===i.state&&i.pause()},this.resume=function(){i&&"paused"===i.state&&i.resume()},this.clearRecordedData=function(){i&&"recording"===i.state&&n.stop(c),c()},this.getInternalRecorder=function(){return i},this.blob=null,this.getState=function(){return i&&i.state||"inactive"};var d=[];this.getAllStates=function(){return d},void 0===t.checkForInactiveTracks&&(t.checkForInactiveTracks=!1),n=this,function o(){if(i&&!1!==t.checkForInactiveTracks)return!1===function(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}()?(t.disableLogs||console.log("MediaStream seems stopped."),void n.stop()):void setTimeout(o,1e3)}(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}function I(e,t){if(!C(e,"audio").length)throw"Your stream has no audio tracks.";var o,n=this,i=[],r=[],s=!1,c=0,d=2,l=(t=t||{}).desiredSampRate;function f(){if(!1===t.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function u(e,t){function o(e,t){var o,n=e.numberOfAudioChannels,i=e.leftBuffers.slice(0),a=e.rightBuffers.slice(0),r=e.sampleRate,s=e.internalInterleavedLength,c=e.desiredSampRate;function d(e,t,o){var n=Math.round(e.length*(t/o)),i=[],a=Number((e.length-1)/(n-1));i[0]=e[0];for(var r=1;r<n-1;r++){var s=r*a,c=Number(Math.floor(s)).toFixed(),d=Number(Math.ceil(s)).toFixed();i[r]=l(e[c],e[d],s-c)}return i[n-1]=e[e.length-1],i}function l(e,t,o){return e+(t-e)*o}function f(e,t){for(var o=new Float64Array(t),n=0,i=e.length,a=0;a<i;a++){var r=e[a];o.set(r,n),n+=r.length}return o}function u(e,t,o){for(var n=o.length,i=0;i<n;i++)e.setUint8(t+i,o.charCodeAt(i))}2===n&&(i=f(i,s),a=f(a,s),c&&(i=d(i,c,r),a=d(a,c,r))),1===n&&(i=f(i,s),c&&(i=d(i,c,r))),c&&(r=c),2===n&&(o=function(e,t){for(var o=e.length+t.length,n=new Float64Array(o),i=0,a=0;a<o;)n[a++]=e[i],n[a++]=t[i],i++;return n}(i,a)),1===n&&(o=i);var m=o.length,h=new ArrayBuffer(44+2*m),p=new DataView(h);u(p,0,"RIFF"),p.setUint32(4,36+2*m,!0),u(p,8,"WAVE"),u(p,12,"fmt "),p.setUint32(16,16,!0),p.setUint16(20,1,!0),p.setUint16(22,n,!0),p.setUint32(24,r,!0),p.setUint32(28,2*r,!0),p.setUint16(32,2*n,!0),p.setUint16(34,16,!0),u(p,36,"data"),p.setUint32(40,2*m,!0);for(var g=m,b=44,v=0;v<g;v++)p.setInt16(b,32767*o[v],!0),b+=2;if(t)return t({buffer:h,view:p});postMessage({buffer:h,view:p})}if(e.noWorker)o(e,(function(e){t(e.buffer,e.view)}));else{var n,i,a,r=(n=o,i=m.createObjectURL(new Blob([n.toString(),";this.onmessage =  function (eee) {"+n.name+"(eee.data);}"],{type:"application/javascript"})),(a=new Worker(i)).workerURL=i,a);r.onmessage=function(e){t(e.data.buffer,e.data.view),m.revokeObjectURL(r.workerURL),r.terminate()},r.postMessage(e)}}!0===t.leftChannel&&(d=1),1===t.numberOfAudioChannels&&(d=1),(!d||d<1)&&(d=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+d),void 0===t.checkForInactiveTracks&&(t.checkForInactiveTracks=!0),this.record=function(){if(!1===f())throw"Please make sure MediaStream is active.";S(),O=w=!1,s=!0,void 0!==t.timeSlice&&x()},this.stop=function(e){e=e||function(){},s=!1,u({desiredSampRate:l,sampleRate:v,numberOfAudioChannels:d,internalInterleavedLength:c,leftBuffers:i,rightBuffers:1===d?[]:r,noWorker:t.noWorker},(function(t,o){n.blob=new Blob([o],{type:"audio/wav"}),n.buffer=new ArrayBuffer(o.buffer.byteLength),n.view=o,n.sampleRate=l||v,n.bufferSize=b,n.length=c,O=!1,e&&e(n.blob)}))},void 0===a.Storage&&(a.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),a.Storage.AudioContextConstructor&&"closed"!==a.Storage.AudioContextConstructor.state||(a.Storage.AudioContextConstructor=new a.Storage.AudioContext);var h=a.Storage.AudioContextConstructor,p=h.createMediaStreamSource(e),g=[0,256,512,1024,2048,4096,8192,16384],b=void 0===t.bufferSize?4096:t.bufferSize;if(-1===g.indexOf(b)&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(g,null,"\t"))),h.createJavaScriptNode)o=h.createJavaScriptNode(b,d,d);else{if(!h.createScriptProcessor)throw"WebAudio API has no support on this browser.";o=h.createScriptProcessor(b,d,d)}p.connect(o),t.bufferSize||(b=o.bufferSize);var v=void 0!==t.sampleRate?t.sampleRate:h.sampleRate||44100;(v<22050||v>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var w=!1;function S(){r=[],c=0,O=!1,s=!1,w=!1,h=null,n.leftchannel=i=[],n.rightchannel=r,n.numberOfAudioChannels=d,n.desiredSampRate=l,n.sampleRate=v,n.recordingLength=c,R={left:[],right:[],recordingLength:0}}function y(){o&&(o.onaudioprocess=null,o.disconnect(),o=null),p&&(p.disconnect(),p=null),S()}this.pause=function(){w=!0},this.resume=function(){if(!1===f())throw"Please make sure MediaStream is active.";if(!s)return t.disableLogs||console.log("Seems recording has been restarted."),void this.record();w=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,s&&this.stop(y),y()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var O=!1;o.onaudioprocess=function(e){if(!w)if(!1===f()&&(t.disableLogs||console.log("MediaStream seems stopped."),o.disconnect(),s=!1),s){O||(O=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var a=e.inputBuffer.getChannelData(0),l=new Float32Array(a);if(i.push(l),2===d){var u=e.inputBuffer.getChannelData(1),m=new Float32Array(u);r.push(m)}n.recordingLength=c+=b,void 0!==t.timeSlice&&(R.recordingLength+=b,R.left.push(l),2===d&&R.right.push(m))}else p&&(p.disconnect(),p=null)},o.connect(h.createMediaStreamDestination?h.createMediaStreamDestination():h.destination),this.leftchannel=i,this.rightchannel=r,this.numberOfAudioChannels=d,this.desiredSampRate=l,this.sampleRate=v,n.recordingLength=c;var R={left:[],right:[],recordingLength:0};function x(){s&&"function"==typeof t.ondataavailable&&void 0!==t.timeSlice&&(R.left.length?(u({desiredSampRate:l,sampleRate:v,numberOfAudioChannels:d,internalInterleavedLength:R.recordingLength,leftBuffers:R.left,rightBuffers:1===d?[]:R.right},(function(e,o){var n=new Blob([o],{type:"audio/wav"});t.ondataavailable(n),setTimeout(x,t.timeSlice)})),R={left:[],right:[],recordingLength:0}):setTimeout(x,t.timeSlice))}}function P(e,t){if("undefined"==typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";(t=t||{}).frameInterval||(t.frameInterval=10);var o=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){e in document.createElement("canvas")&&(o=!0)}));var n,i,a,r=!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome),s=50,c=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(r&&c&&c[2]&&(s=parseInt(c[2],10)),r&&s<52&&(o=!1),t.useWhammyRecorder&&(o=!1),o)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)n=e;else{if(!(e instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";n=e.canvas}else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(a=!0,o&&!t.useWhammyRecorder){var e;"captureStream"in n?e=n.captureStream(25):"mozCaptureStream"in n?e=n.mozCaptureStream(25):"webkitCaptureStream"in n&&(e=n.webkitCaptureStream(25));try{var r=new w;r.addTrack(C(e,"video")[0]),e=r}catch(s){}if(!e)throw"captureStream API are NOT available.";(i=new M(e,{mimeType:t.mimeType||"video/webm"})).record()}else m.frames=[],u=(new Date).getTime(),f();t.initCallback&&t.initCallback()},this.getWebPImages=function(o){if("canvas"===e.nodeName.toLowerCase()){var n=m.frames.length;m.frames.forEach((function(e,o){var i=n-o;t.disableLogs||console.log(i+"/"+n+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(i,n);var a=e.image.toDataURL("image/webp",1);m.frames[o].image=a})),t.disableLogs||console.log("Generating WebM"),o()}else o()},this.stop=function(e){a=!1;var n=this;o&&i?i.stop(e):this.getWebPImages((function(){m.compile((function(o){t.disableLogs||console.log("Recording finished!"),n.blob=o,n.blob.forEach&&(n.blob=new Blob([],{type:"video/webm"})),e&&e(n.blob),m.frames=[]}))}))};var d=!1;function l(){m.frames=[],a=!1,d=!1}function f(){if(d)return u=(new Date).getTime(),setTimeout(f,500);if("canvas"===e.nodeName.toLowerCase()){var o=(new Date).getTime()-u;return u=(new Date).getTime(),m.frames.push({image:(n=document.createElement("canvas"),i=n.getContext("2d"),n.width=e.width,n.height=e.height,i.drawImage(e,0,0),n),duration:o}),void(a&&setTimeout(f,t.frameInterval))}var n,i;html2canvas(e,{grabMouse:void 0===t.showMousePointer||t.showMousePointer,onrendered:function(e){var o=(new Date).getTime()-u;if(!o)return setTimeout(f,t.frameInterval);u=(new Date).getTime(),m.frames.push({image:e.toDataURL("image/webp",1),duration:o}),a&&setTimeout(f,t.frameInterval)}})}this.pause=function(){d=!0,i instanceof M&&i.pause()},this.resume=function(){d=!1,i instanceof M?i.resume():a||this.record()},this.clearRecordedData=function(){a&&this.stop(l),l()},this.name="CanvasRecorder",this.toString=function(){return this.name};var u=(new Date).getTime(),m=new B.Video(100)}function A(e,t){function o(e){e=void 0!==e?e:10;var t=(new Date).getTime()-s;return t?i?(s=(new Date).getTime(),setTimeout(o,100)):(s=(new Date).getTime(),r.paused&&r.play(),l.drawImage(r,0,0,d.width,d.height),c.frames.push({duration:t,image:d.toDataURL("image/webp")}),void(n||setTimeout(o,e,e))):setTimeout(o,e,e)}(t=t||{}).frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),d.width=t.canvas.width||320,d.height=t.canvas.height||240,l=d.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(r=t.video.cloneNode(),t.initCallback&&t.initCallback()):(r=document.createElement("video"),R(e,r),r.onloadedmetadata=function(){t.initCallback&&t.initCallback()},r.width=t.video.width,r.height=t.video.height),r.muted=!0,r.play(),s=(new Date).getTime(),c=new B.Video,t.disableLogs||(console.log("canvas resolutions",d.width,"*",d.height),console.log("video width/height",r.width||d.width,"*",r.height||d.height)),o(t.frameInterval)};var n=!1;this.stop=function(e){e=e||function(){},n=!0;var o=this;setTimeout((function(){!function(e,t,o,n,i){var a=document.createElement("canvas");a.width=d.width,a.height=d.height;var r,s,c,l=a.getContext("2d"),f=[],u=e.length,m=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),h=!1;s=-1,c=(r={length:u,functionToLoop:function(t,o){var n,i,a,r=function(){!h&&a-n<=0*a||(h=!0,f.push(e[o])),t()};if(h)r();else{var s=new Image;s.onload=function(){l.drawImage(s,0,0,d.width,d.height);var e=l.getImageData(0,0,d.width,d.height);n=0,i=e.data.length,a=e.data.length/4;for(var t=0;t<i;t+=4){var o={r:e.data[t],g:e.data[t+1],b:e.data[t+2]};Math.sqrt(Math.pow(o.r-0,2)+Math.pow(o.g-0,2)+Math.pow(o.b-0,2))<=0*m&&n++}r()},s.src=e[o].image}},callback:function(){(f=f.concat(e.slice(u))).length<=0&&f.push(e[e.length-1]),i(f)}}).length,function e(){++s!==c?setTimeout((function(){r.functionToLoop(e,s)}),1):r.callback()}()}(c.frames,0,0,0,(function(n){c.frames=n,t.advertisement&&t.advertisement.length&&(c.frames=t.advertisement.concat(c.frames)),c.compile((function(t){o.blob=t,o.blob.forEach&&(o.blob=new Blob([],{type:"video/webm"})),e&&e(o.blob)}))}))}),10)};var i=!1;function a(){c.frames=[],n=!0,i=!1}this.pause=function(){i=!0},this.resume=function(){i=!1,n&&this.record()},this.clearRecordedData=function(){n||this.stop(a),a()},this.name="WhammyRecorder",this.toString=function(){return this.name};var r,s,c,d=document.createElement("canvas"),l=d.getContext("2d")}void 0!==u?x.AudioContext=u:"undefined"!=typeof webkitAudioContext&&(x.AudioContext=webkitAudioContext),a.Storage=x,a.MediaStreamRecorder=M,a.StereoAudioRecorder=I,a.CanvasRecorder=P,a.WhammyRecorder=A;var B=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){function t(e,t,o){return[{data:e,id:231}].concat(o.map((function(e){var o=function(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:o,id:163}})))}function o(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function n(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var o=0;o<e.length;o+=8)t.push(parseInt(e.substr(o,8),2));return new Uint8Array(t)}function i(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}var a=new function(e){var i=function(e){if(e[0]){for(var t=e[0].width,o=e[0].height,n=e[0].duration,i=1;i<e.length;i++)n+=e[i].duration;return{duration:n,width:t,height:o}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}(e);if(!i)return[];for(var a,r=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(a=i.duration,[].slice.call(new Uint8Array(new Float64Array([a]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:i.width,id:176},{data:i.height,id:186}]}]}]}]}],s=0,c=0;s<e.length;){var d=[],l=0;do{d.push(e[s]),l+=e[s].duration,s++}while(s<e.length&&l<3e4);var f={id:524531317,data:t(c,0,d)};r[1].data.push(f),c+=l}return function e(t){for(var i=[],a=0;a<t.length;a++){var r=t[a].data;"object"==typeof r&&(r=e(r)),"number"==typeof r&&(r=n(r.toString(2))),"string"==typeof r&&(r=new Uint8Array(r.split("").map((function(e){return e.charCodeAt(0)}))));var s=r.size||r.byteLength||r.length,c=Math.ceil(Math.ceil(Math.log(s)/Math.log(2))/8),d=s.toString(2),l=new Array(7*c+7+1-d.length).join("0")+d,f=new Array(c).join("0")+"1"+l;i.push(o(t[a].id)),i.push(n(f)),i.push(r)}return new Blob(i,{type:"video/webm"})}(r)}(e.map((function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],o=t.indexOf("\x9d\x01*"),n=0,i=[];n<4;n++)i[n]=t.charCodeAt(o+3+n);return{width:16383&(i[1]<<8|i[0]),height:16383&(i[3]<<8|i[2]),data:t,riff:e}}(function e(t){for(var o=0,n={};o<t.length;){var a=t.substr(o,4),r=i(t,o),s=t.substr(o+4+4,r);o+=8+r,n[a]=n[a]||[],n[a].push("RIFF"===a||"LIST"===a?e(s):s)}return n}(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(a)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var o,n,i,a=(o=t,n=m.createObjectURL(new Blob([o.toString(),"this.onmessage =  function (eee) {"+o.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(n),m.revokeObjectURL(n),i);a.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},a.postMessage(this.frames)},{Video:e}}();a.Whammy=B;var T={init:function(){var e=this;if("undefined"!=typeof indexedDB&&void 0!==indexedDB.open){var t,o=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),n=indexedDB.open(o,1);n.onerror=e.onError,n.onsuccess=function(){(t=n.result).onerror=e.onError,t.setVersion&&1!==t.version?t.setVersion(1).onsuccess=function(){i(t),a()}:a()},n.onupgradeneeded=function(e){i(e.target.result)}}else console.error("IndexedDB API are not available in this browser.");function i(t){t.createObjectStore(e.dataStoreName)}function a(){var o=t.transaction([e.dataStoreName],"readwrite");function n(t){o.objectStore(e.dataStoreName).get(t).onsuccess=function(o){e.callback&&e.callback(o.target.result,t)}}e.videoBlob&&o.objectStore(e.dataStoreName).put(e.videoBlob,"videoBlob"),e.gifBlob&&o.objectStore(e.dataStoreName).put(e.gifBlob,"gifBlob"),e.audioBlob&&o.objectStore(e.dataStoreName).put(e.audioBlob,"audioBlob"),n("audioBlob"),n("videoBlob"),n("gifBlob")}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};function F(e,t){if("undefined"==typeof GIFEncoder){var o=document.createElement("script");o.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(o)}t=t||{};var n=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){"undefined"!=typeof GIFEncoder&&s?(n||(t.width||(t.width=c.offsetWidth||320),t.height||(t.height=c.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),a.width=t.canvas.width||320,a.height=t.canvas.height||240,c.width=t.video.width||320,c.height=t.video.height||240),(u=new GIFEncoder).setRepeat(0),u.setDelay(t.frameRate||200),u.setQuality(t.quality||10),u.start(),"function"==typeof t.onGifRecordingStarted&&t.onGifRecordingStarted(),Date.now(),m=d((function e(o){if(!0!==h.clearedRecordedData){if(i)return setTimeout((function(){e(o)}),100);m=d(e),void 0===typeof l&&(l=o),o-l<90||(!n&&c.paused&&c.play(),n||r.drawImage(c,0,0,a.width,a.height),t.onGifPreview&&t.onGifPreview(a.toDataURL("image/png")),u.addFrame(r),l=o)}})),t.initCallback&&t.initCallback()):setTimeout(h.record,1e3)},this.stop=function(e){e=e||function(){},m&&f(m),Date.now(),this.blob=new Blob([new Uint8Array(u.stream().bin)],{type:"image/gif"}),e(this.blob),u.stream().bin=[]};var i=!1;this.pause=function(){i=!0},this.resume=function(){i=!1},this.clearRecordedData=function(){h.clearedRecordedData=!0,u&&(u.stream().bin=[])},this.name="GifRecorder",this.toString=function(){return this.name};var a=document.createElement("canvas"),r=a.getContext("2d");n&&(e instanceof CanvasRenderingContext2D?a=(r=e).canvas:e instanceof HTMLCanvasElement&&(r=e.getContext("2d"),a=e));var s=!0;if(!n){var c=document.createElement("video");c.muted=!0,c.autoplay=!0,c.playsInline=!0,s=!1,c.onloadedmetadata=function(){s=!0},R(e,c),c.play()}var l,u,m=null,h=this}function L(e,t){"undefined"!=typeof global&&global,t=t||"multi-streams-mixer";var o=[],n=!1,i=document.createElement("canvas"),a=i.getContext("2d");i.style.opacity=0,i.style.position="absolute",i.style.zIndex=-1,i.style.top="-1000em",i.style.left="-1000em",i.className=t,(document.body||document.documentElement).appendChild(i),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var r=this,s=window.AudioContext;void 0===s&&("undefined"!=typeof webkitAudioContext&&(s=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(s=mozAudioContext));var c=window.URL;void 0===c&&"undefined"!=typeof webkitURL&&(c=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var d=window.MediaStream;void 0===d&&"undefined"!=typeof webkitMediaStream&&(d=webkitMediaStream),void 0!==d&&void 0===d.prototype.stop&&(d.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))});var l={};function f(){if(!n){var e=o.length,t=!1,a=[];if(o.forEach((function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:a.push(e)})),t)i.width=t.stream.width,i.height=t.stream.height;else if(a.length){i.width=e>1?2*a[0].width:a[0].width;var s=1;3!==e&&4!==e||(s=2),5!==e&&6!==e||(s=3),7!==e&&8!==e||(s=4),9!==e&&10!==e||(s=5),i.height=a[0].height*s}else i.width=r.width||360,i.height=r.height||240;t&&t instanceof HTMLVideoElement&&u(t),a.forEach((function(e,t){u(e,t)})),setTimeout(f,r.frameInterval)}}function u(e,t){if(!n){var o=0,i=0,r=e.width,s=e.height;1===t&&(o=e.width),2===t&&(i=e.height),3===t&&(o=e.width,i=e.height),4===t&&(i=2*e.height),5===t&&(o=e.width,i=2*e.height),6===t&&(i=3*e.height),7===t&&(o=e.width,i=3*e.height),void 0!==e.stream.left&&(o=e.stream.left),void 0!==e.stream.top&&(i=e.stream.top),void 0!==e.stream.width&&(r=e.stream.width),void 0!==e.stream.height&&(s=e.stream.height),a.drawImage(e,o,i,r,s),"function"==typeof e.stream.onRender&&e.stream.onRender(a,o,i,r,s,t)}}function m(e){var o=document.createElement("video");return function(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}(e,o),o.className=t,o.muted=!0,o.volume=0,o.width=e.width||r.width||360,o.height=e.height||r.height||240,o.play(),o}function h(t){o=[],(t=t||e).forEach((function(e){if(e.getTracks().filter((function(e){return"video"===e.kind})).length){var t=m(e);t.stream=e,o.push(t)}}))}void 0!==s?l.AudioContext=s:"undefined"!=typeof webkitAudioContext&&(l.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){f()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach((function(t){var n=new d;if(t.getTracks().filter((function(e){return"video"===e.kind})).length){var i=m(t);i.stream=t,o.push(i),n.addTrack(t.getTracks().filter((function(e){return"video"===e.kind}))[0])}if(t.getTracks().filter((function(e){return"audio"===e.kind})).length){var a=r.audioContext.createMediaStreamSource(t);r.audioDestination=r.audioContext.createMediaStreamDestination(),a.connect(r.audioDestination),n.addTrack(r.audioDestination.stream.getTracks().filter((function(e){return"audio"===e.kind}))[0])}e.push(n)}))},this.releaseStreams=function(){o=[],n=!0,r.gainNode&&(r.gainNode.disconnect(),r.gainNode=null),r.audioSources.length&&(r.audioSources.forEach((function(e){e.disconnect()})),r.audioSources=[]),r.audioDestination&&(r.audioDestination.disconnect(),r.audioDestination=null),r.audioContext&&r.audioContext.close(),r.audioContext=null,a.clearRect(0,0,i.width,i.height),i.stream&&(i.stream.stop(),i.stream=null)},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),h(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function(){n=!1;var t=function(){var e;h(),"captureStream"in i?e=i.captureStream():"mozCaptureStream"in i?e=i.mozCaptureStream():r.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new d;return e.getTracks().filter((function(e){return"video"===e.kind})).forEach((function(e){t.addTrack(e)})),i.stream=t,t}(),o=function(){l.AudioContextConstructor||(l.AudioContextConstructor=new l.AudioContext),r.audioContext=l.AudioContextConstructor,r.audioSources=[],!0===r.useGainNode&&(r.gainNode=r.audioContext.createGain(),r.gainNode.connect(r.audioContext.destination),r.gainNode.gain.value=0);var t=0;if(e.forEach((function(e){if(e.getTracks().filter((function(e){return"audio"===e.kind})).length){t++;var o=r.audioContext.createMediaStreamSource(e);!0===r.useGainNode&&o.connect(r.gainNode),r.audioSources.push(o)}})),t)return r.audioDestination=r.audioContext.createMediaStreamDestination(),r.audioSources.forEach((function(e){e.connect(r.audioDestination)})),r.audioDestination.stream}();return o&&o.getTracks().filter((function(e){return"audio"===e.kind})).forEach((function(e){t.addTrack(e)})),e.forEach((function(e){})),t}}function E(e,t){e=e||[];var o,n,i=this;(t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}}).frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){var i;o=new L(e,t.elementClass||"multi-streams-mixer"),(i=[],e.forEach((function(e){C(e,"video").forEach((function(e){i.push(e)}))})),i).length&&(o.frameInterval=t.frameInterval||10,o.width=t.video.width||360,o.height=t.video.height||240,o.startDrawingFrames()),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(o.getMixedStream()),(n=new M(o.getMixedStream(),t)).record()},this.stop=function(e){n&&n.stop((function(t){i.blob=t,e(t),i.clearRecordedData()}))},this.pause=function(){n&&n.pause()},this.resume=function(){n&&n.resume()},this.clearRecordedData=function(){n&&(n.clearRecordedData(),n=null),o&&(o.releaseStreams(),o=null)},this.addStreams=function(i){if(!i)throw"First parameter is required.";i instanceof Array||(i=[i]),e.concat(i),n&&o&&(o.appendStreams(i),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(o.getMixedStream()))},this.resetVideoStreams=function(e){o&&(!e||e instanceof Array||(e=[e]),o.resetVideoStreams(e))},this.getMixer=function(){return o},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}function _(e,t){function o(){return new ReadableStream({start:function(o){var n=document.createElement("canvas"),i=document.createElement("video");i.srcObject=e,i.onplaying=function(){n.width=t.width,n.height=t.height;var e=n.getContext("2d"),a=1e3/t.frameRate;setTimeout((function n(){e.drawImage(i,0,0),o.enqueue(e.getImageData(0,0,t.width,t.height)),setTimeout(n,a)}),a)},i.play()}})}var n,i;"undefined"!=typeof ReadableStream&&"undefined"!=typeof WritableStream||console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),(t=t||{}).width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,this.record=function(){a=[],i=!1,this.blob=null,function e(r,s){if(t.workerPath||s){if(!t.workerPath&&s instanceof ArrayBuffer){var c=new Blob([s],{type:"text/javascript"});t.workerPath=m.createObjectURL(c)}t.workerPath||console.error("workerPath parameter is missing."),(n=new Worker(t.workerPath)).postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),n.addEventListener("message",(function(e){"READY"===e.data?(n.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:!0}),o().pipeTo(new WritableStream({write:function(e){n&&n.postMessage(e.data.buffer,[e.data.buffer])}}))):e.data&&(i||a.push(e.data))}))}else fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then((function(t){t.arrayBuffer().then((function(t){e(r,t)}))}))}(e),"function"==typeof t.initCallback&&t.initCallback()},this.pause=function(){i=!0},this.resume=function(){i=!1};var a=[];this.stop=function(e){n&&(n.postMessage(null),n.terminate(),n=null),this.blob=new Blob(a,{type:"video/webm"}),e(this.blob)},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){a=[],i=!1,this.blob=null},this.blob=null}a.DiskStorage=T,a.GifRecorder=F,a.MultiStreamRecorder=E,a.RecordRTCPromisesHandler=function(e,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(void 0===e)throw'First argument "MediaStream" is required.';var o=this;o.recordRTC=new a(e,t),this.startRecording=function(){return new Promise((function(e,t){try{o.recordRTC.startRecording(),e()}catch(n){t(n)}}))},this.stopRecording=function(){return new Promise((function(e,t){try{o.recordRTC.stopRecording((function(n){o.blob=o.recordRTC.getBlob(),o.blob&&o.blob.size?e(n):t("Empty blob.",o.blob)}))}catch(n){t(n)}}))},this.pauseRecording=function(){return new Promise((function(e,t){try{o.recordRTC.pauseRecording(),e()}catch(n){t(n)}}))},this.resumeRecording=function(){return new Promise((function(e,t){try{o.recordRTC.resumeRecording(),e()}catch(n){t(n)}}))},this.getDataURL=function(e){return new Promise((function(e,t){try{o.recordRTC.getDataURL((function(t){e(t)}))}catch(n){t(n)}}))},this.getBlob=function(){return new Promise((function(e,t){try{e(o.recordRTC.getBlob())}catch(n){t(n)}}))},this.getInternalRecorder=function(){return new Promise((function(e,t){try{e(o.recordRTC.getInternalRecorder())}catch(n){t(n)}}))},this.reset=function(){return new Promise((function(e,t){try{e(o.recordRTC.reset())}catch(n){t(n)}}))},this.destroy=function(){return new Promise((function(e,t){try{e(o.recordRTC.destroy())}catch(n){t(n)}}))},this.getState=function(){return new Promise((function(e,t){try{e(o.recordRTC.getState())}catch(n){t(n)}}))},this.blob=null,this.version="5.5.9"},a.WebAssemblyRecorder=_},vS2R:function(e,t,o){var n;!function(o,i,a,r){"use strict";var s,c,d={URL:o.URL||o.webkitURL||o.mozURL||o.msURL,getUserMedia:(c=a.getUserMedia||a.webkitGetUserMedia||a.mozGetUserMedia||a.msGetUserMedia,c?c.bind(a):c),requestAnimFrame:o.requestAnimationFrame||o.webkitRequestAnimationFrame||o.mozRequestAnimationFrame||o.oRequestAnimationFrame||o.msRequestAnimationFrame,requestTimeout:function(e,t){if(e=e||d.noop,t=t||0,!d.requestAnimFrame)return setTimeout(e,t);var o=(new Date).getTime(),n=new Object,i=d.requestAnimFrame;return n.value=i((function a(){(new Date).getTime()-o>=t?e.call():n.value=i(a)})),n},Blob:o.Blob||o.BlobBuilder||o.WebKitBlobBuilder||o.MozBlobBuilder||o.MSBlobBuilder,btoa:(s=o.btoa||function(e){for(var t="",o=0,n=e.length,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=void 0,r=void 0,s=void 0,c=void 0,d=void 0,l=void 0,f=void 0;o<n;)c=(a=e.charCodeAt(o++))>>2,d=(3&a)<<4|(r=e.charCodeAt(o++))>>4,l=(15&r)<<2|(s=e.charCodeAt(o++))>>6,f=63&s,isNaN(r)?l=f=64:isNaN(s)&&(f=64),t=t+i.charAt(c)+i.charAt(d)+i.charAt(l)+i.charAt(f);return t},s?s.bind(o):d.noop),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){return d.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=i.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return o.Worker},blob:function(){return d.Blob},Uint8Array:function(){return o.Uint8Array},Uint32Array:function(){return o.Uint32Array},videoCodecs:function(){var e=i.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(o){}return t}()},noop:function(){},each:function(e,t){var o=void 0,n=void 0;if(d.isArray(e))for(o=-1,n=e.length;++o<n&&!1!==t(o,e[o]););else if(d.isObject(e))for(o in e)if(e.hasOwnProperty(o)&&!1===t(o,e[o]))break},mergeOptions:function(e,t){if(d.isObject(e)&&d.isObject(t)&&Object.keys){var o={};return d.each(e,(function(t,n){o[t]=e[t]})),d.each(t,(function(n,i){var a=t[n];o[n]=d.isObject(a)&&e[n]?d.mergeOptions(e[n],a):a})),o}},setCSSAttr:function(e,t,o){d.isElement(e)&&(d.isString(t)&&d.isString(o)?e.style[t]=o:d.isObject(t)&&d.each(t,(function(t,o){e.style[t]=o})))},removeElement:function(e){d.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!d.isString(e))return{};try{var t=new d.Blob([e],{type:"text/javascript"}),o=d.URL.createObjectURL(t);return{objectUrl:o,worker:new Worker(o)}}catch(n){return""+n}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i.body||!1===e.resizeFont)return e.fontSize;var t=e.text,o=e.gifWidth,n=parseInt(e.fontSize,10),a=parseInt(e.minFontSize,10),r=i.createElement("div"),s=i.createElement("span");for(r.setAttribute("width",o),r.appendChild(s),s.innerHTML=t,s.style.fontSize=n+"px",s.style.textIndent="-9999px",s.style.visibility="hidden",i.body.appendChild(s);s.offsetWidth>o&&n>=a;)s.style.fontSize=--n+"px";return i.body.removeChild(s),n+"px"},webWorkerError:!1},l=Object.freeze({default:d}),f={validate:function(e){e=d.isObject(e)?e:{};var t={};return d.each(f.validators,(function(o,n){if(!e[n.errorCode]&&!n.condition)return(t=n).error=!0,!1})),delete t.condition,t},isValid:function(e){return!0!==f.validate(e).error},validators:[{condition:d.isFunction(d.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:d.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:d.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:d.isFunction(d.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:d.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:d.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:d.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},u=Object.freeze({default:f}),m=function(){},h={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:m,completeCallback:m,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},p=Object.freeze({default:h});function g(){return f.isValid()}function b(){var e,t,o,n,i,a=256,r=499,s=491,c=487,d=503,l=3*d,f=a-1,u=4,m=100,h=16,p=1<<h,g=10,b=10,v=p>>b,w=p<<g-b,S=a>>3,y=6,O=1<<y,C=S*O,R=30,x=10,k=1<<x,M=8,I=1<<M,P=x+M,A=1<<P,B=[],T=[],F=[],L=[];function E(e,r,s){var c,d;for(t=e,o=r,n=s,i=new Array(a),c=0;c<a;c++)i[c]=new Array(4),(d=i[c])[0]=d[1]=d[2]=(c<<u+8)/a|0,F[c]=p/a|0,T[c]=0}function _(){for(var e=[],t=new Array(a),o=0;o<a;o++)t[i[o][3]]=o;for(var n=0,r=0;r<a;r++){var s=t[r];e[n++]=i[s][0],e[n++]=i[s][1],e[n++]=i[s][2]}return e}function U(){var e,t,o,n,r,s,c,d;for(c=0,d=0,e=0;e<a;e++){for(o=e,n=(r=i[e])[1],t=e+1;t<a;t++)(s=i[t])[1]<n&&(o=t,n=s[1]);if(s=i[o],e!=o&&(t=s[0],s[0]=r[0],r[0]=t,t=s[1],s[1]=r[1],r[1]=t,t=s[2],s[2]=r[2],r[2]=t,t=s[3],s[3]=r[3],r[3]=t),n!=c){for(B[c]=d+e>>1,t=c+1;t<n;t++)B[t]=e;c=n,d=e}}for(B[c]=d+f>>1,t=c+1;t<256;t++)B[t]=f}function D(){var i,a,f,h,p,g,b,v,w,S,O,x,M,P;for(o<l&&(n=1),e=30+(n-1)/3,x=t,M=0,P=o,S=(O=o/(3*n))/m|0,v=k,(b=(g=C)>>y)<=1&&(b=0),i=0;i<b;i++)L[i]=v*((b*b-i*i)*I/(b*b));for(w=o<l?3:o%r!=0?3*r:o%s!=0?3*s:o%c!=0?3*c:3*d,i=0;i<O;)if(W(v,a=G(f=(255&x[M+0])<<u,h=(255&x[M+1])<<u,p=(255&x[M+2])<<u),f,h,p),0!==b&&N(b,a,f,h,p),(M+=w)>=P&&(M-=o),0===S&&(S=1),++i%S==0)for(v-=v/e,(b=(g-=g/R)>>y)<=1&&(b=0),a=0;a<b;a++)L[a]=v*((b*b-a*a)*I/(b*b))}function z(e,t,o){var n,r,s,c,d,l,f;for(d=1e3,f=-1,r=(n=B[t])-1;n<a||r>=0;)n<a&&((s=(l=i[n])[1]-t)>=d?n=a:(n++,s<0&&(s=-s),(c=l[0]-e)<0&&(c=-c),(s+=c)<d&&((c=l[2]-o)<0&&(c=-c),(s+=c)<d&&(d=s,f=l[3])))),r>=0&&((s=t-(l=i[r])[1])>=d?r=-1:(r--,s<0&&(s=-s),(c=l[0]-e)<0&&(c=-c),(s+=c)<d&&((c=l[2]-o)<0&&(c=-c),(s+=c)<d&&(d=s,f=l[3]))));return f}function j(){return D(),V(),U(),_()}function V(){var e;for(e=0;e<a;e++)i[e][0]>>=u,i[e][1]>>=u,i[e][2]>>=u,i[e][3]=e}function N(e,t,o,n,r){var s,c,d,l,f,u,m;for((d=t-e)<-1&&(d=-1),(l=t+e)>a&&(l=a),s=t+1,c=t-1,u=1;s<l||c>d;){if(f=L[u++],s<l){m=i[s++];try{m[0]-=f*(m[0]-o)/A|0,m[1]-=f*(m[1]-n)/A|0,m[2]-=f*(m[2]-r)/A|0}catch(h){}}if(c>d){m=i[c--];try{m[0]-=f*(m[0]-o)/A|0,m[1]-=f*(m[1]-n)/A|0,m[2]-=f*(m[2]-r)/A|0}catch(h){}}}}function W(e,t,o,n,a){var r=i[t],s=e/k;r[0]-=s*(r[0]-o)|0,r[1]-=s*(r[1]-n)|0,r[2]-=s*(r[2]-a)|0}function G(e,t,o){var n,r,s,c,d,l,f,m,p,S;for(p=m=~(1<<31),f=l=-1,n=0;n<a;n++)(r=(S=i[n])[0]-e)<0&&(r=-r),(s=S[1]-t)<0&&(s=-s),r+=s,(s=S[2]-o)<0&&(s=-s),(r+=s)<m&&(m=r,l=n),(c=r-(T[n]>>h-u))<p&&(p=c,f=n),F[n]-=d=F[n]>>b,T[n]+=d<<g;return F[l]+=v,T[l]-=w,f}E.apply(this,arguments);var $={};return $.map=z,$.process=j,$}function v(){try{this.onmessage=function(t){var o,n=t.data||{};n.gifshot&&(o=e.run(n),postMessage(o))}}catch(t){}var e={dataToRGB:function(e,t,o){for(var n=t*o*4,i=0,a=[];i<n;)a.push(e[i++]),a.push(e[i++]),a.push(e[i++]),i++;return a},componentizedPaletteToArray:function(e){e=e||[];for(var t=[],o=0;o<e.length;o+=3)t.push(e[o]<<16|e[o+1]<<8|e[o+2]);return t},processFrameWithQuantizer:function(e,t,o,n){for(var i=this.dataToRGB(e,t,o),a=new b(i,i.length,n),r=a.process(),s=new Uint32Array(this.componentizedPaletteToArray(r)),c=t*o,d=new Uint8Array(c),l=0,f=0;f<c;f++){var u=i[l++],m=i[l++],h=i[l++];d[f]=a.map(u,m,h)}return{pixels:d,palette:s}},run:function(e){return this.processFrameWithQuantizer((e=e||{}).data,e.width,e.height,e.sampleInterval)}};return e}function w(e,t,o,n){var i=0,a=void 0===(n=void 0===n?{}:n).loop?null:n.loop,r=void 0===n.palette?null:n.palette;if(t<=0||o<=0||t>65535||o>65535)throw"Width/Height invalid.";if(e[i++]=71,e[i++]=73,e[i++]=70,e[i++]=56,e[i++]=57,e[i++]=97,e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&o,e[i++]=o>>8&255,e[i++]=0|(null!==r?128:0),e[i++]=0,e[i++]=0,null!==a){if(a<0||a>65535)throw"Loop count invalid.";e[i++]=33,e[i++]=255,e[i++]=11,e[i++]=78,e[i++]=69,e[i++]=84,e[i++]=83,e[i++]=67,e[i++]=65,e[i++]=80,e[i++]=69,e[i++]=50,e[i++]=46,e[i++]=48,e[i++]=3,e[i++]=1,e[i++]=255&a,e[i++]=a>>8&255,e[i++]=0}var s=!1;this.addFrame=function(t,o,n,a,c,d){if(!0===s&&(--i,s=!1),t<0||o<0||t>65535||o>65535)throw"x/y invalid.";if(n<=0||a<=0||n>65535||a>65535)throw"Width/Height invalid.";if(c.length<n*a)throw"Not enough pixels for the frame size.";var l=!0,f=(d=void 0===d?{}:d).palette;if(null==f&&(l=!1,f=r),null==f)throw"Must supply either a local or global palette.";for(var u=function(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}(f),m=0;u>>=1;)++m;u=1<<m;var h=void 0===d.delay?0:d.delay,p=void 0===d.disposal?0:d.disposal;if(p<0||p>3)throw"Disposal out of range.";var g=!1,b=0;if(null!=d.transparent&&(g=!0,(b=d.transparent)<0||b>=u))throw"Transparent color index.";if((0!==p||g||0!==h)&&(e[i++]=33,e[i++]=249,e[i++]=4,e[i++]=p<<2|(!0===g?1:0),e[i++]=255&h,e[i++]=h>>8&255,e[i++]=b,e[i++]=0),e[i++]=44,e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&o,e[i++]=o>>8&255,e[i++]=255&n,e[i++]=n>>8&255,e[i++]=255&a,e[i++]=a>>8&255,e[i++]=!0===l?128|m-1:0,!0===l)for(var v=0,w=f.length;v<w;++v){var S=f[v];e[i++]=S>>16&255,e[i++]=S>>8&255,e[i++]=255&S}i=function(e,t,o,n){e[t++]=o;var i=t++,a=1<<o,r=a-1,s=a+1,c=s+1,d=o+1,l=0,f=0;function u(o){for(;l>=o;)e[t++]=255&f,f>>=8,l-=8,t===i+256&&(e[i]=255,i=t++)}function m(e){f|=e<<l,l+=d,u(8)}var h=n[0]&r,p={};m(a);for(var g=1,b=n.length;g<b;++g){var v=n[g]&r,w=h<<8|v,S=p[w];if(void 0===S){for(f|=h<<l,l+=d;l>=8;)e[t++]=255&f,f>>=8,l-=8,t===i+256&&(e[i]=255,i=t++);4096===c?(m(a),c=s+1,d=o+1,p={}):(c>=1<<d&&++d,p[w]=c++),h=v}else h=S}return m(h),m(s),u(1),i+1===t?e[i]=0:(e[i]=t-i-1,e[t++]=0),t}(e,i,m<2?2:m,c)},this.end=function(){return!1===s&&(e[i++]=59,s=!0),i}}var S=function(){},y=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=S,this.onRenderProgressCallback=S,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};function O(e,t){e.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})}))}y.prototype={workerMethods:v(),initializeWebWorkers:function(e){var t,o=b.toString()+"("+v.toString()+"());",n=void 0,a=void 0,r=-1,s="";for(t=e.numWorkers;++r<t;)n=d.createWebWorker(o),d.isObject(n)?(this.workers.push({worker:a=n.worker,objectUrl:n.objectUrl}),this.availableWorkers.push(a)):(s=n,d.webWorkerError=!!n);this.workerError=s,this.canvas=i.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,o="",n=-1;++n<t;)o+=this.byteMap[e[n]];return o},onFrameFinished:function(e){var t=this,o=t.frames,n=!!(t.options.images||[]).length,i=o.every((function(e){return!e.beingProcessed&&e.done}));t.numRenderedFrames++,n&&e(t.numRenderedFrames/o.length),t.onRenderProgressCallback(.75*t.numRenderedFrames/o.length),i?t.generatingGIF||t.generateGIF(o,t.onRenderCompleteCallback):d.requestTimeout((function(){t.processNextFrame()}),1)},processFrame:function(e){var t=this,o=this.options,n=o.progressCallback,i=o.sampleInterval,a=void 0,r=void 0,s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.data;delete a.data,a.pixels=Array.prototype.slice.call(o.pixels),a.palette=Array.prototype.slice.call(o.palette),a.done=!0,a.beingProcessed=!1,t.freeWorker(r),t.onFrameFinished(n)};(a=this.frames[e]).beingProcessed||a.done?this.onFrameFinished():(a.sampleInterval=i,a.beingProcessed=!0,a.gifshot=!0,(r=this.getWorker())?(r.onmessage=s,r.postMessage(a)):s({data:t.workerMethods.run(a)}))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var o=this.frames[t];if(!o.done&&!o.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,t){var o=[],n=this.options,i=n.interval,a=n.frameDuration,r=!!n.images.length,s=n.gifHeight,c=n.gifWidth,l=new w(o,c,s,{loop:this.repeat}),f=this.onRenderProgressCallback,u=r?100*i:0,m=void 0;this.generatingGIF=!0,d.each(e,(function(t,o){var n=o.palette;f(.75+.25*o.position*1/e.length);for(var i=0;i<a;i++)l.addFrame(0,0,c,s,o.pixels,{palette:n,delay:u})})),l.end(),f(1),this.frames=[],this.generatingGIF=!1,d.isFunction(t)&&(m=this.bufferToString(o),t("data:image/gif;base64,"+d.btoa(m)))},setRepeat:function(e){this.repeat=e},addFrame:function(e,t){t=d.isObject(t)?t:{};var o=this.ctx,n=this.options,i=n.gifWidth,a=n.gifHeight,r=d.getFontSize(t),s=t.filter,c=t.fontColor,l=t.text,f=t.textAlign,u=t.textBaseline,m=t.textXCoordinate?t.textXCoordinate:"left"===f?1:"right"===f?i:i/2,h=t.textYCoordinate?t.textYCoordinate:"top"===u?1:"center"===u?a/2:a,p=t.fontWeight+" "+r+" "+t.fontFamily,g=void 0;try{o.filter=s,o.drawImage(e,0,0,i,a),l&&(o.font=p,o.fillStyle=c,o.textAlign=f,o.textBaseline=u,o.fillText(l,m,h)),g=o.getImageData(0,0,i,a),this.addFrameImageData(g)}catch(b){return""+b}},addFrameImageData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.frames,o=e.data;this.frames.push({data:o,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var t=this;t.startRendering((function(o){t.destroyWorkers(),d.requestTimeout((function(){e(o)}),0)}))},destroyWorkers:function(){this.workerError||d.each(this.workers,(function(e,t){var o=t.objectUrl;t.worker.terminate(),d.URL.revokeObjectURL(o)}))}};var C=function(){},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];t=d.isFunction(t)?t:C;var o=i.createElement("canvas"),n=void 0,a=e.images,r=!!a.length,s=e.cameraStream,c=e.crop,l=e.filter,f=e.fontColor,u=e.fontFamily,m=e.fontWeight,h=e.keepCameraOn,p=e.progressCallback,g=e.saveRenderingContexts,b=e.savedRenderingContexts,v=e.text,w=e.textAlign,S=e.textBaseline,O=e.videoElement,R=e.videoHeight,x=e.videoWidth,k=e.webcamVideoElement,M=Number(e.gifWidth),I=Number(e.gifHeight),P=Number(e.interval),A=(Number(e.sampleInterval),r?0:1e3*P),B=[],T=b.length?b.length:e.numFrames,F=T,L=new y(e),E=d.getFontSize(e),_=e.textXCoordinate?e.textXCoordinate:"left"===w?1:"right"===w?M:M/2,U=e.textYCoordinate?e.textYCoordinate:"top"===S?1:"center"===S?I/2:I,D=m+" "+E+" "+u,z=c?Math.floor(c.scaledWidth/2):0,j=c?x-c.scaledWidth:0,V=c?Math.floor(c.scaledHeight/2):0,N=c?R-c.scaledHeight:0,W=function e(){var o=F-1;function i(){var i;g&&B.push(n.getImageData(0,0,M,I)),v&&(n.font=D,n.fillStyle=f,n.textAlign=w,n.textBaseline=S,n.fillText(v,_,U)),i=n.getImageData(0,0,M,I),L.addFrameImageData(i),p((T-(F=o))/T),o>0&&d.requestTimeout(e,A),F||L.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:s,videoElement:O,webcamVideoElement:k,savedRenderingContexts:B,keepCameraOn:h})}))}b.length?(n.putImageData(b[T-F],0,0),i()):function e(){try{j>x&&(j=x),N>R&&(N=R),z<0&&(z=0),V<0&&(V=0),n.filter=l,n.drawImage(O,z,V,j,N,0,0,M,I),i()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;d.requestTimeout(e,100)}}()};T=void 0!==T?T:10,P=void 0!==P?P:.1,o.width=M,o.height=I,n=o.getContext("2d"),function e(){b.length||0!==O.currentTime?W():d.requestTimeout(e,100)}()},x={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function e(t){e.attempts=e.attempts||0;var o=t.cameraStream,n=t.completedCallback,i=t.videoElement;i&&(i.videoWidth>0&&i.videoHeight>0?(i.removeEventListener("loadeddata",x.findVideoSize),n({videoElement:i,cameraStream:o,videoWidth:i.videoWidth,videoHeight:i.videoHeight})):e.attempts<10?(e.attempts+=1,d.requestTimeout((function(){x.findVideoSize(t)}),400)):n({videoElement:i,cameraStream:o,videoWidth:x.defaultVideoDimensions.width,videoHeight:x.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){d.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=d.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,o=e.cameraStream,n=e.completedCallback,i=e.streamedCallback,a=e.videoElement;if(d.isFunction(i)&&i(),t){if(d.isString(t))a.src=t,a.innerHTML='<source src="'+t+'" type="video/'+d.getExtension(t)+'" />';else if(t instanceof Blob){try{a.src=d.URL.createObjectURL(t)}catch(r){}a.innerHTML='<source src="'+t+'" type="'+t.type+'" />'}}else if(a.mozSrcObject)a.mozSrcObject=o;else if(d.URL)try{a.srcObject=o,a.src=d.URL.createObjectURL(o)}catch(r){a.srcObject=o}a.play(),d.requestTimeout((function e(){e.count=e.count||0,!0===x.loadedData?(x.findVideoSize({videoElement:a,cameraStream:o,completedCallback:n}),x.loadedData=!1):(e.count+=1)>10?x.findVideoSize({videoElement:a,cameraStream:o,completedCallback:n}):e()}),0)},startStreaming:function(e){var t=d.isFunction(e.error)?e.error:d.noop,o=d.isFunction(e.streamed)?e.streamed:d.noop,n=d.isFunction(e.completed)?e.completed:d.noop,a=e.crossOrigin,r=e.existingVideo,s=e.lastCameraStream,c=e.options,l=e.webcamVideoElement,f=d.isElement(r)?r:l||i.createElement("video");a&&(f.crossOrigin=c.crossOrigin),f.autoplay=!0,f.loop=!0,f.muted=!0,f.addEventListener("loadeddata",(function(e){x.loadedData=!0,c.offset&&(f.currentTime=c.offset)})),r?x.stream({videoElement:f,existingVideo:r,completedCallback:n}):s?x.stream({videoElement:f,cameraStream:s,streamedCallback:o,completedCallback:n}):d.getUserMedia({video:!0},(function(e){x.stream({videoElement:f,cameraStream:e,streamedCallback:o,completedCallback:n})}),t)},startVideoStreaming:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=void 0!==t.timeout?t.timeout:0,n=t.callback,i=t.webcamVideoElement,a=void 0;o>0&&(a=d.requestTimeout((function(){x.onStreamingTimeout(n)}),1e4)),x.startStreaming({error:function(){n({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(a)},completed:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.cameraStream,n=t.videoElement,i=t.videoHeight,a=t.videoWidth;e({cameraStream:o,videoElement:n,videoHeight:i,videoWidth:a})},lastCameraStream:t.lastCameraStream,webcamVideoElement:i,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){var t=(e=d.isObject(e)?e:{}).keepCameraOn,o=e.videoElement,n=e.webcamVideoElement,i=e.cameraStream||{},a=i.getTracks&&i.getTracks()||[],r=a[0];!t&&!!a.length&&d.isFunction(r.stop)&&r.stop(),d.isElement(o)&&!n&&(o.pause(),d.isFunction(d.URL.revokeObjectURL)&&!d.webWorkerError&&o.src&&d.URL.revokeObjectURL(o.src),d.removeElement(o))}};function k(e){e=d.isObject(e)?e:{},x.stopVideoStreaming(e)}function M(e,t){var o=e.options||{},n=o.images,a=o.video,r=Number(o.gifWidth),s=Number(o.gifHeight),c=(Number(o.numFrames),e.cameraStream),l=e.videoElement,f=e.videoWidth,u=e.videoHeight,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.videoWidth,o=e.videoHeight,n=e.gifWidth,i=e.gifHeight,a={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>o?(a.width=Math.round(t*(i/o))-n,a.scaledWidth=Math.round(a.width*(o/i))):(a.height=Math.round(o*(n/t))-i,a.scaledHeight=Math.round(a.height*(t/n))),a}({videoWidth:f,videoHeight:u,gifHeight:s,gifWidth:r}),h=t;o.crop=m,o.videoElement=l,o.videoWidth=f,o.videoHeight=u,o.cameraStream=c,d.isElement(l)&&(l.width=r+m.width,l.height=s+m.height,o.webcamVideoElement||(d.setCSSAttr(l,{position:"fixed",opacity:"0"}),i.body.appendChild(l)),l.play(),R(o,(function(e){n&&n.length||a&&a.length||k(e),h(e)})))}function I(e,t){if(t=d.isFunction(e)?e:t,e=d.isObject(e)?e:{},d.isFunction(t)){var o=d.mergeOptions(h,e)||{},n=e.cameraStream,a=o.images,r=a?a.length:0,s=o.video,c=o.webcamVideoElement;o=d.mergeOptions(o,{gifWidth:Math.floor(o.gifWidth),gifHeight:Math.floor(o.gifHeight)}),r?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,o=e.images,n=e.options,a=e.imagesLength,r={getUserMedia:!0,"window.URL":!0},s=f.validate(r),c=[],l=0,u=void 0,m=void 0;if(s.error)return t(s);function h(){d.each(c,(function(e,t){t&&(t.text?m.addFrame(t.img,n,t.text):m.addFrame(t,n))})),O(m,t)}m=new y(n),d.each(o,(function(e,o){var r=o;o.src&&(r=r.src),d.isElement(r)?(n.crossOrigin&&(r.crossOrigin=n.crossOrigin),c[e]=r,(l+=1)===a&&h()):d.isString(r)&&(u=new Image,n.crossOrigin&&(u.crossOrigin=n.crossOrigin),function(n){o.text&&(n.text=o.text),n.onerror=function(e){var o=void 0;if(0==--a)return(o={}).error="None of the requested images was capable of being retrieved",t(o)},n.onload=function(t){c[e]=o.text?{img:n,text:n.text}:n,(l+=1)===a&&h(),d.removeElement(n)},n.src=r}(u),d.setCSSAttr(u,{position:"fixed",opacity:"0"}),i.body.appendChild(u))}))}({images:a,imagesLength:r,callback:t,options:o}):s?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,o=e.existingVideo,n=e.options,i={getUserMedia:!0,"window.URL":!0},a=f.validate(i),r=void 0;if(a.error)return t(a);if(d.isElement(o)&&o.src){if(r=d.getExtension(o.src),!d.isSupported.videoCodecs[r])return t(f.messages.videoCodecs)}else d.isArray(o)&&d.each(o,(function(e,t){if(r=t instanceof Blob?t.type.substr(t.type.lastIndexOf("/")+1,t.length):t.substr(t.lastIndexOf(".")+1,t.length),d.isSupported.videoCodecs[r])return o=t,!1}));x.startStreaming({completed:function(e){e.options=n||{},M(e,t)},existingVideo:o,crossOrigin:n.crossOrigin,options:n})}({existingVideo:s,callback:t,options:o}):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,o=e.lastCameraStream,n=e.options,i=e.webcamVideoElement;if(!g())return t(f.validate());n.savedRenderingContexts.length?R(n,(function(e){t(e)})):x.startVideoStreaming((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.options=n||{},M(e,t)}),{lastCameraStream:o,callback:t,webcamVideoElement:i,crossOrigin:n.crossOrigin})}({lastCameraStream:n,callback:t,webcamVideoElement:c,options:o})}}var P={utils:l,error:u,defaultOptions:p,createGIF:I,takeSnapShot:function(e,t){if(t=d.isFunction(e)?e:t,e=d.isObject(e)?e:{},d.isFunction(t)){var o=d.mergeOptions(h,e);I(d.mergeOptions(o,{interval:.1,numFrames:1,gifWidth:Math.floor(o.gifWidth),gifHeight:Math.floor(o.gifHeight)}),t)}},stopVideoStreaming:k,isSupported:function(){return f.isValid()},isWebCamGIFSupported:g,isExistingVideoGIFSupported:function(e){var t=!1;if(d.isArray(e)&&e.length){if(d.each(e,(function(e,o){d.isSupported.videoCodecs[o]&&(t=!0)})),!t)return!1}else if(d.isString(e)&&e.length&&!d.isSupported.videoCodecs[e])return!1;return f.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return f.isValid({getUserMedia:!0})},VERSION:"0.4.5"};void 0===(n=(function(){return P}).apply(t,[]))||(e.exports=n)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})}}]);