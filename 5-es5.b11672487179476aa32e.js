function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{BJHQ:function(e,t,n){"use strict";n.r(t);var o,i,a,r,c,s=n("tyNb"),d=n("3Pt+"),l="DemoLandingPage",f=n("fXoL"),u=n("fCJ/"),m=n("R7i2"),h=n("/oK/"),p=n("Eax+"),g=n("Lt5k"),b=n("0IaG"),v=((o=function(){function e(t){_classCallCheck(this,e),this.dialog=t}return _createClass(e,[{key:"showAlertNotificationDialog",value:function(e){var t=e.title,n=e.info,o=e.icon;return this.dialog.open(u.a,{data:{title:t,info:n,icon:o}})}},{key:"showInfoCiudadanoDialog",value:function(e){var t=e.title,n=e.info,o=e.icon;return this.dialog.open(m.a,{data:{title:t,info:n,icon:o}})}},{key:"showContractAuthorizationDialog",value:function(){return this.dialog.open(h.a)}},{key:"showVideoDialog",value:function(e){var t=e.url,n=e.ext;return this.dialog.open(p.a,{data:{url:t,ext:n}})}},{key:"showRecognizedCitizen",value:function(e){var t=e.info,n=e.lastUpdate;return this.dialog.open(g.a,{data:{info:t,lastUpdate:n},panelClass:"my-dialog"})}}]),e}()).\u0275fac=function(e){return new(e||o)(f.Zb(b.b))},o.\u0275prov=f.Lb({token:o,factory:o.\u0275fac,providedIn:"root"}),o),w=n("patT"),y=n("2Vo4"),S=n("tk/3"),C=((i=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"getLocation",value:function(){return this.http.get("https://api.ipify.org?format=json&callback=?")}}]),e}()).\u0275fac=function(e){return new(e||i)(f.Zb(S.a))},i.\u0275prov=f.Lb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),O=n("AytR"),k=n("f9VL"),R=((r=function(){function e(t,n){_classCallCheck(this,e),this.http=t,this.requestService=n}return _createClass(e,[{key:"GetUsersHistoric",value:function(e){return this.http.post(O.a.urlApi+"GroupMatch/GetHistoric",e,{headers:this.requestService.headersAuth})}},{key:"SetToUsersHistoric",value:function(e){return this.http.post(O.a.urlApi+"GroupMatch/AddHistoric",e,{headers:this.requestService.headersAuth})}},{key:"GetCitizenData",value:function(e){return this.http.post(O.a.urlApi+"Ani/GetInfoDocumento",e,{headers:this.requestService.headersAuth})}},{key:"GetUserData",value:function(e){return this.http.post(O.a.urlApi+"Ani/GetInfoDocumento",e,{headers:this.requestService.headers})}},{key:"SendToIdentificationFace",value:function(e){return this.http.post(O.a.urlApi+"GroupMatch/Buscar",e,{headers:this.requestService.headers})}},{key:"SendToDocumentValidate",value:function(e){return this.http.post(O.a.urlApi+"Ani/SaveAndDocumentValidate",e,{headers:this.requestService.headersAuth})}},{key:"SendImageToEnroll",value:function(e){return this.http.post(O.a.urlApi+"GroupMatch/Agregar",e,{headers:this.requestService.headersAuth})}},{key:"SendToIdentificationFaceById",value:function(e){return this.http.post(O.a.urlApi+"CompararRostros/ValidarRostro",e,{headers:this.requestService.headers})}},{key:"SendVideoRecorder",value:function(e){return this.http.post(O.a.urlApi+"GroupMatch/AddVideo",e,{headers:this.requestService.headersAuth,reportProgress:!0})}}]),e}()).\u0275fac=function(e){return new(e||r)(f.Zb(S.a),f.Zb(k.a))},r.\u0275prov=f.Lb({token:r,factory:r.\u0275fac,providedIn:"root"}),r),x=((a=function(){function e(t){_classCallCheck(this,e),this.api=t,this.deviceIp$=new y.a(""),this.getLocation()}return _createClass(e,[{key:"getLocation",value:function(){var e=this;this.api.getLocation().subscribe((function(t){return e.deviceIp$.next(t.ip)}))}}]),e}()).\u0275fac=function(e){return new(e||a)(f.Zb(C))},a.\u0275prov=f.Lb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),M=n("vkgz"),I=((c=function(){function e(t,n,o,i,a){_classCallCheck(this,e),this.api=t,this.dataFacade=n,this.modalsService=o,this.router=i,this.activatedRoute=a,this.usersHistoric$=new y.a([]),this.usersHistoricLast$=new y.a(null),this.citizenInfoState$=new y.a(null),this.faceRecognitionState$=new y.a(null),this.citizenState$=new y.a(null)}return _createClass(e,[{key:"GetUsersHistoricById",value:function(e){var t=this;this.api.GetUsersHistoric({Provider:3,Cantidad:10,GroupName:l,IdFeature:e}).pipe(Object(M.a)((function(e){return t.usersHistoricLast$.next(e.HistoricoList[0])}))).subscribe()}},{key:"GetusersHistoricLast$",value:function(){return this.usersHistoricLast$.asObservable()}},{key:"GetUsersHistoric",value:function(){var e=this;this.api.GetUsersHistoric({Provider:3,GroupName:l,Cantidad:10}).pipe(Object(M.a)((function(t){return e.usersHistoric$.next(t.HistoricoList)}))).subscribe()}},{key:"SetToUsersHistoric",value:function(e){var t=this,n=[{Ip:e.Ip,Browser:e.Browser,SistemaOperativo:e.SistemaOperativo,Descripcion:e.Descripcion,Fecha:e.Fecha}];this.api.SetToUsersHistoric(e).subscribe((function(e){if(e.EjecucionCorrecta){var o=t.usersHistoric$.value.length;t.usersHistoric$.next(o>=10?n.concat(t.usersHistoric$.value).splice(0,o):n.concat(t.usersHistoric$.value))}}))}},{key:"GetUserData",value:function(e){var t=this;this.dataFacade.setSpinnerState$(!0),this.api.GetUserData(e).subscribe((function(e){t.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?t.modalsService.showInfoCiudadanoDialog({title:"Informaci\xf3n de ciudadano",info:e.Informacion.Respuesta,icon:""}):t.modalsService.showAlertNotificationDialog({title:"Error",info:e.Error,icon:"bad"})}))}},{key:"GetCitizenData",value:function(e){var t=this;return this.api.GetCitizenData(e).subscribe((function(e){e.EjecucionCorrecta?t.citizenState$.next(e.Respuesta):(t.router.navigateByUrl("users/validation?IDConvenio="+t.activatedRoute.snapshot.queryParams.IDConvenio),setTimeout((function(){return window.location.reload(!0)})))}))}},{key:"GetCitizenState$",value:function(){return this.citizenState$.asObservable()}},{key:"SetCitizenState$",value:function(e){return this.citizenState$.next(e)}},{key:"GetCitizenValue",value:function(){return this.citizenState$.value}},{key:"SendToIdentificationFace",value:function(e){var t=this;this.dataFacade.setSpinnerState$(!0),this.api.SendToIdentificationFace(e).subscribe((function(e){if(t.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta){var n=e.Groups[0].faceGroups.filter((function(e){return e.Score>92}))[0];n?n.Reconocido=!0:n={Reconocido:!1},t.faceRecognitionState$.next(n)}else t.faceRecognitionState$.next({Reconocido:!1})}))}},{key:"GetfaceRecognitionState$",value:function(){return this.faceRecognitionState$.next(null),this.faceRecognitionState$.asObservable()}},{key:"SendToDocumentValidate",value:function(e){var t=this;this.dataFacade.setSpinnerState$(!0),this.api.SendToDocumentValidate(e).subscribe((function(e){t.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?t.citizenInfoState$.next(e.Respuesta):t.modalsService.showAlertNotificationDialog({title:"Error",info:e.Error,icon:"bad"}).afterClosed().subscribe((function(e){t.citizenInfoState$.next(null)}))}),(function(e){t.dataFacade.setSpinnerState$(!1),t.modalsService.showAlertNotificationDialog({title:"Error",info:"Por favor comuniquese con el administrador.",icon:"bad"}).afterClosed().subscribe((function(e){t.citizenInfoState$.next(null)}))}))}},{key:"SetCitizenInfoState",value:function(e){return this.citizenInfoState$.next(e)}},{key:"GetCitizenInfoState$",value:function(){return this.citizenInfoState$.asObservable()}},{key:"GetCitizenInfoStateValue",value:function(){return this.citizenInfoState$.value}},{key:"SendImageToEnroll",value:function(e){var t=this;this.dataFacade.setSpinnerState$(!0),this.api.SendImageToEnroll(e).subscribe((function(e){t.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?t.modalsService.showAlertNotificationDialog({title:"Bienvenido",info:"Registro satisfactorio.",icon:"good"}).afterClosed().subscribe((function(e){t.citizenInfoState$.next(null)})):t.modalsService.showAlertNotificationDialog({title:"Error",info:e.Error,icon:"bad"}).afterClosed().subscribe((function(e){t.citizenInfoState$.next(null)}))}),(function(e){t.modalsService.showAlertNotificationDialog({title:"Error",info:"Por favor comuniquese con el administrador.",icon:"bad"}).afterClosed().subscribe((function(e){t.citizenInfoState$.next(null)}))}))}},{key:"SendToIdentificationFaceById",value:function(e){var t=this;this.dataFacade.setSpinnerState$(!0),this.api.SendToIdentificationFaceById(e).subscribe((function(n){if(n.EjecucionCorrecta){var o=n.faceIdentification;o.Score<91?(t.dataFacade.setSpinnerState$(!1),t.faceRecognitionState$.next({Reconocido:!1})):o.IdFeature&&0!==o.IdFeature?(t.dataFacade.setSpinnerState$(!1),o.Reconocido=!0,t.faceRecognitionState$.next(o)):t.SendImageToEnrollAfterValidate(o,{Imagen:e.Image,GroupName:l,Provider:3,InformacionCiudadanoId:e.Id,Motivo:"",Descripcion:"".concat(o.Detail.PrimerNombre," ").concat(o.Detail.PrimerApellido),Codigo:"".concat(o.Detail.NUIP),Tag:""})}else t.dataFacade.setSpinnerState$(!1),t.faceRecognitionState$.next({Reconocido:!1})}))}},{key:"SendImageToEnrollAfterValidate",value:function(e,t){var n=this,o=e;this.api.SendImageToEnroll(t).subscribe((function(e){n.dataFacade.setSpinnerState$(!1),e.EjecucionCorrecta?(o.Reconocido=!0,o.IdFeature=e.FeatureId,n.faceRecognitionState$.next(o)):n.faceRecognitionState$.next({Reconocido:!1})}))}},{key:"SendVideoRecorder",value:function(e){var t=new FormData;t.append("file",e.video,e.name+"."+e.ext),this.api.SendVideoRecorder(t).subscribe((function(e){console.log("Video upload")}))}}]),e}()).\u0275fac=function(e){return new(e||c)(f.Zb(R),f.Zb(w.a),f.Zb(v),f.Zb(s.b),f.Zb(s.a))},c.\u0275prov=f.Lb({token:c,factory:c.\u0275fac,providedIn:"root"}),c),P=n("kmnG"),A=n("d3UM"),B=n("ofXK"),T=n("qFsG");function F(e,t,n,o){return new(n||(n=Promise))((function(i,a){function r(e){try{s(o.next(e))}catch(t){a(t)}}function c(e){try{s(o.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,c)}s((o=o.apply(e,t||[])).next())}))}var _,L=function(e){return e[e.Paused=0]="Paused",e[e.Recording=1]="Recording",e[e.Inactive=2]="Inactive",e}({}),E=[{name:"face-api",src:"assets/js/face-api.min.js"},{name:"commons",src:"assets/js/commons.js"},{name:"faceDetectionControls",src:"assets/js/faceDetectionControls.js"}],U=((_=function(){function e(){var t=this;_classCallCheck(this,e),this.scripts={},E.forEach((function(e){t.scripts[e.name]={loaded:!1,src:e.src}}))}return _createClass(e,[{key:"load",value:function(){for(var e=this,t=[],n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach((function(n){return t.push(e.loadScript(n))})),Promise.all(t)}},{key:"removeScript",value:function(e){for(var t=document.getElementsByTagName("script"),n=t.length;n>=0;n--)t[n]&&null!=t[n].getAttribute("src")&&t[n].getAttribute("src")===this.scripts[e].src&&t[n].parentNode.removeChild(t[n])}},{key:"loadScript",value:function(e){var t=this;return new Promise((function(n,o){if(t.scripts[e].loaded)n({script:e,loaded:!0,status:"Already Loaded"});else{var i=document.createElement("script");i.type="text/javascript",i.src=t.scripts[e].src,i.async=!0,i.defer=!0,i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,t.scripts[e].loaded=!0,n({script:e,loaded:!0,status:"Loaded"}))}:i.onload=function(){t.scripts[e].loaded=!0,n({script:e,loaded:!0,status:"Loaded"})},i.onerror=function(t){return n({script:e,loaded:!1,status:"Loaded"})},document.getElementsByTagName("head")[0].appendChild(i)}}))}}]),e}()).\u0275fac=function(e){return new(e||_)},_.\u0275prov=f.Lb({token:_,factory:_.\u0275fac,providedIn:"root"}),_),D=function(){function e(t,n){_classCallCheck(this,e),this.state=L.Inactive,this.mediaRecorder=new MediaRecorder(t.srcObject,n),this.ext=n.ext}return _createClass(e,[{key:"PauseRecord",value:function(){console.log("pause"),"recording"===this.mediaRecorder.state&&(this.mediaRecorder.pause(),this.state=L.Paused)}},{key:"ResumeRecord",value:function(){console.log("resume"),"paused"===this.mediaRecorder.state&&(this.mediaRecorder.resume(),this.state=L.Recording)}},{key:"StartRecord",value:function(){console.log("start"),"inactive"===this.mediaRecorder.state&&(this.mediaRecorder.start(),this.state=L.Recording,this.mediaRecorder.ondataavailable=this.OnDataAvailable.bind(this))}},{key:"StopRecord",value:function(){var e=this;return console.log("stop"),new Promise((function(t,n){e.mediaRecorder.onstop=function(n){e.state=L.Inactive,t(e.BuildVideo(e.videoData))},e.mediaRecorder.stop()}))}},{key:"OnDataAvailable",value:function(e){this.videoData=e.data}},{key:"BuildVideo",value:function(e){return{video:new Blob([e],{type:e.type}),ext:this.ext}}}]),e}(),z=n("qe5e"),j=function(){function e(t,n){_classCallCheck(this,e),this.state=L.Inactive,this.mediaRecorder=new z(t.srcObject,n),this.ext=n.ext}return _createClass(e,[{key:"PauseRecord",value:function(){console.log("pause"),"recording"===this.mediaRecorder.getState()&&(this.mediaRecorder.pauseRecording(),this.state=L.Paused)}},{key:"ResumeRecord",value:function(){console.log("resume"),"paused"===this.mediaRecorder.getState()&&(this.mediaRecorder.resumeRecording(),this.state=L.Recording)}},{key:"StartRecord",value:function(){console.log("start"),console.log(this.mediaRecorder.getState()),"inactive"!==this.mediaRecorder.getState()&&"stopped"!==this.mediaRecorder.getState()||(this.mediaRecorder.startRecording(),this.state=L.Recording,console.log(this.mediaRecorder.getState()))}},{key:"StopRecord",value:function(){var e=this;return console.log("stop"),new Promise((function(t,n){e.mediaRecorder.stopRecording((function(){e.state=L.Inactive,t(e.BuildVideo(e.mediaRecorder.getBlob()))}))}))}},{key:"BuildVideo",value:function(e){return{video:new Blob([e],{type:e.type}),ext:this.ext}}},{key:"BlobToFile",value:function(e){var t=e;return t.lastModifiedDate=new Date,t.name="recorder."+this.ext,t}}]),e}(),V=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},N=[["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["edge",/Edge\/([0-9\._]+)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+)\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["safari",/Version\/([0-9\._]+).*Safari/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/]],W=["Windows Phone","Android","CentOS",{name:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "],G={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"},q=new RegExp(["(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|","compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|","midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)","\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|","wap|windows ce|xda|xiino"].join(""),"i"),H=new RegExp(["1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|","ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|","avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|","cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|","ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|","g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|","hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|","i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|","kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])","|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|","mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|","n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|","op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|","po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|","raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|","se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|k\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|","so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|","tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|","veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|","w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-"].join(""),"i"),$=function(){function e(e,t,n){this.navigator=t,this.process=n,this.userAgent=e||(this.navigator?t.userAgent||t.vendor:"")}return e.prototype.detect=function(){if(this.process&&!this.userAgent){var e=this.process.version.slice(1).split(".").slice(0,3),t=Array.prototype.slice.call(e,1).join("")||"0";return{name:"node",version:e.join("."),versionNumber:parseFloat(e[0]+"."+t),mobile:!1,os:this.process.platform}}return this.userAgent||this.handleMissingError(),V({},this.checkBrowser(),this.checkMobile(),this.checkOs())},e.prototype.checkBrowser=function(){var e=this;return N.filter((function(t){return t[1].test(e.userAgent)})).map((function(t){var n=t[1].exec(e.userAgent),o=n&&n[1].split(/[._]/).slice(0,3),i=Array.prototype.slice.call(o,1).join("")||"0";return o&&o.length<3&&Array.prototype.push.apply(o,1===o.length?[0,0]:[0]),{name:String(t[0]),version:o.join("."),versionNumber:Number(o[0]+"."+i)}})).shift()},e.prototype.checkMobile=function(){var e=this.userAgent.substr(0,4);return{mobile:q.test(this.userAgent)||H.test(e)}},e.prototype.checkOs=function(){var e=this;return W.map((function(t){var n=t.name||t,o=e.getOsPattern(t);return{name:n,pattern:o,value:RegExp("\\b"+o.replace(/([ -])(?!$)/g,"$1?")+"(?:x?[\\d._]+|[ \\w.]*)","i").exec(e.userAgent)}})).filter((function(e){return e.value})).map((function(e){var t,n=e.value[0]||"";return e.pattern&&e.name&&/^Win/i.test(n)&&!/^Windows Phone /i.test(n)&&(t=G[n.replace(/[^\d.]/g,"")])&&(n="Windows "+t),e.pattern&&e.name&&(n=n.replace(RegExp(e.pattern,"i"),e.name)),n=n.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0].trim(),{os:n=/^(?:webOS|i(?:OS|P))/.test(n)?n:n.charAt(0).toUpperCase()+n.slice(1)}})).shift()},e.prototype.getOsPattern=function(e){return("string"==typeof e?e:void 0)||e.pattern||e.name},e.prototype.handleMissingError=function(){throw new Error("Please give user-agent.\n> browser(navigator.userAgent or res.headers['user-agent']).")},e}();function Y(e,t){return e(t={exports:{}},t.exports),t.exports}var X=Y((function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)})),J=Y((function(e){var t=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=t)})),Z=function(e){return"object"==typeof e?null!==e:"function"==typeof e},Q=function(e){if(!Z(e))throw TypeError(e+" is not an object!");return e},K=function(e){try{return!!e()}catch(t){return!0}},ee=!K((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),te=X.document,ne=Z(te)&&Z(te.createElement),oe=!ee&&!K((function(){return 7!=Object.defineProperty(ne?te.createElement("div"):{},"a",{get:function(){return 7}}).a})),ie=Object.defineProperty,ae={f:ee?Object.defineProperty:function(e,t,n){if(Q(e),t=function(e,t){if(!Z(e))return e;var n,o;if("function"==typeof(n=e.toString)&&!Z(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!Z(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}(t),Q(n),oe)try{return ie(e,t,n)}catch(o){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},re=ee?function(e,t,n){return ae.f(e,t,function(e,t){return{enumerable:!1,configurable:!0,writable:!0,value:t}}(0,n))}:function(e,t,n){return e[t]=n,e},ce={}.hasOwnProperty,se=function(e,t){return ce.call(e,t)},de=0,le=Math.random(),fe=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++de+le).toString(36))},ue=Y((function(e){var t=fe("src"),n=Function.toString,o=(""+n).split("toString");J.inspectSource=function(e){return n.call(e)},(e.exports=function(e,n,i,a){var r="function"==typeof i;r&&(se(i,"name")||re(i,"name",n)),e[n]!==i&&(r&&(se(i,t)||re(i,t,e[n]?""+e[n]:o.join(String(n)))),e===X?e[n]=i:a?e[n]?e[n]=i:re(e,n,i):(delete e[n],re(e,n,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[t]||n.call(this)}))})),me=function(e,t,n){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,i){return e.call(t,n,o,i)}}return function(){return e.apply(t,arguments)}},he=function e(t,n,o){var i,a,r,c,s=t&e.F,d=t&e.G,l=t&e.P,f=t&e.B,u=d?X:t&e.S?X[n]||(X[n]={}):(X[n]||{}).prototype,m=d?J:J[n]||(J[n]={}),h=m.prototype||(m.prototype={});for(i in d&&(o=n),o)r=((a=!s&&u&&void 0!==u[i])?u:o)[i],c=f&&a?me(r,X):l&&"function"==typeof r?me(Function.call,r):r,u&&ue(u,i,r,t&e.U),m[i]!=r&&re(m,i,c),l&&h[i]!=r&&(h[i]=r)};X.core=J,he.F=1,he.G=2,he.S=4,he.P=8,he.B=16,he.W=32,he.U=64,he.R=128;var pe=he,ge={}.toString,be=function(e){return ge.call(e).slice(8,-1)},ve=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==be(e)?e.split(""):Object(e)},we=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},ye=Math.ceil,Se=Math.floor,Ce=Math.min,Oe=Array.isArray||function(e){return"Array"==be(e)},ke=Y((function(e){var t=X["__core-js_shared__"]||(X["__core-js_shared__"]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:J.version,mode:"global",copyright:"\xa9 2018 Denis Pushkarev (zloirock.ru)"})})),Re=Y((function(e){var t=ke("wks"),n=X.Symbol,o="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=o&&n[e]||(o?n:fe)("Symbol."+e))}).store=t}))("species"),xe=function(e,t){return new(function(e){var t;return Oe(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!Oe(t.prototype)||(t=void 0),Z(t)&&null===(t=t[Re])&&(t=void 0)),void 0===t?Array:t}(e))(t)},Me=function(e,t){var n=1==e,o=2==e,i=3==e,a=4==e,r=6==e,c=5==e||r,s=t||xe;return function(t,d,l){for(var f,u,m=Object(we(t)),h=ve(m),p=me(d,l,3),g=(w=h.length)>0?Ce(function(e){return isNaN(e=+e)?0:(e>0?Se:ye)(e)}(w),9007199254740991):0,b=0,v=n?s(t,g):o?s(t,0):void 0;g>b;b++)if((c||b in h)&&(u=p(f=h[b],b,m),e))if(n)v[b]=u;else if(u)switch(e){case 3:return!0;case 5:return f;case 6:return b;case 2:v.push(f)}else if(a)return!1;var w;return r?-1:i||a?a:v}},Ie=function(e,t){return!!e&&K((function(){t?e.call(null,(function(){}),1):e.call(null)}))},Pe=Me(2);pe(pe.P+pe.F*!Ie([].filter,!0),"Array",{filter:function(e){return Pe(this,e,arguments[1])}});var Ae=Me(1);pe(pe.P+pe.F*!Ie([].map,!0),"Array",{map:function(e){return Ae(this,e,arguments[1])}});var Be="\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",Te="["+Be+"]",Fe=RegExp("^"+Te+Te+"*"),_e=RegExp(Te+Te+"*$"),Le=function(e,t,n){var o={},i=K((function(){return!!Be[e]()||"\u200b\x85"!="\u200b\x85"[e]()})),a=o[e]=i?t(Ee):Be[e];n&&(o[n]=a),pe(pe.P+pe.F*i,"String",o)},Ee=Le.trim=function(e,t){return e=String(we(e)),1&t&&(e=e.replace(Fe,"")),2&t&&(e=e.replace(_e,"")),e};Le("trim",(function(e){return function(){return e(this,3)}}));var Ue,De="undefined"!=typeof window?window.navigator:void 0,ze="undefined"!=typeof process?process:void 0,je=function(e){return new $(e,De,ze).detect()},Ve=n("vS2R"),Ne=n("RdDz"),We=function(){function e(t,n){_classCallCheck(this,e),this.state=L.Inactive,this.images=[],this.ext=n.ext,this.options=n,this.streamPlayer=t}return _createClass(e,[{key:"PauseRecord",value:function(){console.log("pause"),this.state===L.Recording&&(clearInterval(this.interval),this.state=L.Paused)}},{key:"ResumeRecord",value:function(){console.log("resume"),this.state===L.Paused&&(this.interval=this.OnLoadImage(),this.state=L.Recording)}},{key:"StartRecord",value:function(){console.log("start-new"),this.canvas=document.createElement("canvas"),this.canvas.width=.65*this.streamPlayer.videoWidth,this.canvas.height=.65*this.streamPlayer.videoHeight,this.state===L.Inactive&&(this.interval=this.OnLoadImage(),this.state=L.Recording)}},{key:"OnLoadImage",value:function(){var e=this;return setInterval((function(){e.images.push(e.capture())}),1e3*this.options.interval)}},{key:"StopRecord",value:function(){var e=this;return console.log("stop"),new Promise((function(t,n){clearInterval(e.interval);var o=e.images.map((function(e){return URL.createObjectURL(e)}));Ve.createGIF({images:o,gifHeight:e.canvas.height,gifWidth:e.canvas.width,numWorkers:6,sampleInterval:10},(function(n){n.error||(e.images=[],e.state=L.Inactive,t(n.error?null:e.BuildVideo(n.image)))}))}))}},{key:"BuildVideo",value:function(e){var t=Ne(e.replace("data:image/gif;base64,",""),"image/gif");return{video:new Blob([t],{type:t.type}),ext:this.ext}}},{key:"capture",value:function(){this.canvas.getContext("2d").drawImage(this.streamPlayer,0,0,this.canvas.width,this.canvas.height);var e=this.canvas.toDataURL("image/png");return Ne(e.replace("data:image/png;base64,",""),"image/png")}}]),e}(),Ge=n("IZMd"),qe=((Ue=function(){function e(t){_classCallCheck(this,e),this.slackService=t}return _createClass(e,[{key:"SelectRecorder",value:function(e,t){switch(e){case"chrome":return new D(t,{videoBitsPerSecond:25e5,mimeType:"video/webm",ext:"webm"});case"safari":return new We(t,{interval:.2,ext:"gif"});case"edge":return new j(t,{type:"video",mimeType:"video/webm",ext:"webm"});default:return null}}},{key:"GetRecorder",value:function(e){try{return this.SelectRecorder(je().name.toLowerCase().trim(),e)}catch(t){this.slackService.SetError(this.slackService.GetErrorFormat(t,"Creaci\xf3n Recorder"))}}},{key:"SetVideoRecorder",value:function(e){this.video=e}},{key:"GetVideoRecorder",value:function(){return this.video}},{key:"GetFileToUrl",value:function(e){return URL.createObjectURL(e)}}]),e}()).\u0275fac=function(e){return new(e||Ue)(f.Zb(Ge.a))},Ue.\u0275prov=f.Lb({token:Ue,factory:Ue.\u0275fac,providedIn:"root"}),Ue),He=["video"],$e=["canvas"];function Ye(e,t){if(1&e&&(f.Vb(0,"div",6,7),f.Vb(2,"p",null,8),f.Ac(4),f.Ub(),f.Ub()),2&e){var n=f.hc();f.Cb(4),f.Bc(n.validationMessage)}}var Xe,Je=((Xe=function(){function e(t,n,o,i,a){_classCallCheck(this,e),this.dataFacade=t,this.modalsService=n,this.scriptsService=o,this.videoRecorderService=i,this.slackService=a,this.liveFace=!0,this.liveFaceOptions=[],this.timeToRefresh=1e4,this.timeLastDetection=new Date,this.happyValue={value:.8},this.mouthOpenValue={value:.85},this.validationMessage="",this.isFaceValid=!1,this.livefaceImage=new f.o}return _createClass(e,[{key:"ngOnDestroy",value:function(){}},{key:"ngOnInit",value:function(){this.isCameraAllowed(),this.timeLastDetection=new Date}},{key:"prepareValidation",value:function(){var e=this;console.log("Preparando !!!!"),this.reducePrecisionActivate=!0,this.happyValue.value=.8,this.mouthOpenValue.value=.75;for(var t=[{name:"happy",callback:function(t){return t.expressions.happy>e.happyValue.value},label:"Regalame una sonrisa",reducePrecisionFunc:function(){e.reduceFunction(e.happyValue,.45,.012)}},{name:"openMouth",callback:function(t){var n=t.landmarks.getMouth(),o=n[14],i=n[18],a=n[0],r=n[6];return faceapi.euclideanDistance([o.x,o.y],[i.x,i.y])/faceapi.euclideanDistance([a.x,a.y],[r.x,r.y])>e.mouthOpenValue.value},label:"Abra la boca",reducePrecisionFunc:function(){e.reduceFunction(e.mouthOpenValue,.44,.012)}}],n=t.length-1;n>=0;n--){var o=Math.floor(Math.random()*t.length);this.liveFaceOptions.push({expression:t[o],status:!1}),t.splice(o,1)}this.isImageSended=!1}},{key:"reduceFunction",value:function(e,t,n){var o=this;this.reducePrecisionActivate&&(this.reducePrecisionActivate=!1,setTimeout((function(){e.value>=t&&(o.reducePrecisionActivate=!0,e.value-=n)}),2e3))}},{key:"isCameraAllowed",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){if(t.getVideoTracks().length>0){e.loadScripts();var n=e.video.nativeElement;n.srcObject=t,e.recorder=e.videoRecorderService.GetRecorder(n)}e.prepareValidation()})).catch((function(t){e.showOverlayMessage=!0,e.validationMessage="ACTIVE SU CAMARA PARA CONTINUAR",setTimeout((function(){return e.ngOnInit()}),1e3)}))}},{key:"onPlay",value:function(){return F(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,o,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.showOverlayMessage=this.startFaceLive,!this.startFaceLive){e.next=20;break}if(t=this.video.nativeElement,n=this.canvas.nativeElement,o=new faceapi.TinyFaceDetectorOptions({inputSize:224,scoreThreshold:.5}),!t.paused&&!t.ended){e.next=4;break}return e.abrupt("return",setTimeout((function(){return a.onPlay()})));case 4:if(!this.liveFace){e.next=10;break}return e.next=7,faceapi.detectSingleFace(t,o).withFaceLandmarks().withFaceExpressions();case 7:e.t0=e.sent,e.next=13;break;case 10:return e.next=12,faceapi.detectSingleFace(t,o);case 12:e.t0=e.sent;case 13:if(!(i=e.t0)){e.next=19;break}return e.next=17,this.faceValidation({results:i,canvas:n,video:t});case 17:e.next=20;break;case 19:faceapi.getContext2dOrThrow(n).clearRect(0,0,n.width,n.height);case 20:setTimeout((function(){return a.onPlay()}));case 21:case"end":return e.stop()}}),e,this)})))}},{key:"faceValidation",value:function(e){var t=e.results,n=e.canvas,o=e.video;return F(this,void 0,void 0,regeneratorRuntime.mark((function e(){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(faceapi.matchDimensions(n,o,!0),n.getContext("2d").clearRect(0,0,n.width,n.height),!(this.liveFaceOptions.length>0&&this.liveFace)){e.next=5;break}i=this.liveFaceOptions[0].expression,this.liveOption=this.liveFaceOptions[0].expression,this.validationMessage=i.label,t.expressions.neutral>=.8&&!this.photo&&(this.isFaceValid=!0,this.capture()),i.callback(t)?(this.isFaceValid=!0,this.reducePrecisionActivate=!0,this.liveFaceOptions.splice(0,1),this.RecorderVideoManagement(this.liveFaceOptions.length)):(this.isFaceValid=!1,i.reducePrecisionFunc()),e.next=15;break;case 5:if(!this.liveFace&&!this.photo){e.next=14;break}if(this.isFaceValid=!1,this.validationMessage="",!this.recorder||this.recorder.state===L.Inactive){e.next=11;break}return e.next=9,this.recorder.StopRecord();case 9:a=e.sent,this.videoRecorderService.SetVideoRecorder(a);case 11:this.sendImage(this.photo),e.next=15;break;case 14:t.score>=.8&&(this.isFaceValid=!0,this.capture());case 15:case"end":return e.stop()}}),e,this)})))}},{key:"RecorderVideoManagement",value:function(e){var t=this;if(this.recorder)try{!this.recorder||this.recorder.state!==L.Paused&&this.recorder.state!==L.Inactive||(console.log("estado actual : ",this.recorder.state),this.recorder.state===L.Inactive?this.recorder.StartRecord():this.recorder.state===L.Paused&&this.recorder.ResumeRecord(),0!==this.liveFaceOptions.length&&setTimeout((function(){e===t.liveFaceOptions.length&&t.recorder.PauseRecord()}),3e3))}catch(n){this.recorder=null,this.slackService.SetError(this.slackService.GetErrorFormat(n,"Comandos Recorder"))}}},{key:"capture",value:function(){console.log("CAPTURE"),this.canvas.nativeElement.getContext("2d").drawImage(this.video.nativeElement,0,0),this.photo=this.canvas.nativeElement.toDataURL("image/png")}},{key:"sendImage",value:function(e){var t=this;this.isImageSended||(this.isImageSended=!0,e&&(this.livefaceImage.emit(e.replace("data:image/png;base64,","")),this.photo=null),setTimeout((function(){return t.prepareValidation()}),500))}},{key:"loadScripts",value:function(){var e=this;this.scriptsService.load("face-api").then((function(){console.log("Se carg\xf3 face-api.js !!"),e.scriptsService.load("commons").then((function(){console.log("Se carg\xf3 commons.js !!"),e.scriptsService.load("faceDetectionControls").then((function(){Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri("assets/weights"),faceapi.nets.faceLandmark68Net.loadFromUri("assets/weights"),faceapi.nets.faceExpressionNet.loadFromUri("assets/weights")]).then((function(){console.log("Se cargaron los modelos !!"),e.onPlay()}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))}}]),e}()).\u0275fac=function(e){return new(e||Xe)(f.Pb(w.a),f.Pb(v),f.Pb(U),f.Pb(qe),f.Pb(Ge.a))},Xe.\u0275cmp=f.Jb({type:Xe,selectors:[["app-liveface-camera"]],viewQuery:function(e,t){var n;1&e&&(f.xc(He,!0),f.xc($e,!0)),2&e&&(f.pc(n=f.ec())&&(t.video=n.first),f.pc(n=f.ec())&&(t.canvas=n.first))},inputs:{startFaceLive:"startFaceLive"},outputs:{livefaceImage:"livefaceImage"},decls:6,vars:3,consts:[[1,"main__camera__wrapper"],["class","main__camera__wrapper__overlay",4,"ngIf"],["autoplay","","muted","","playsinline","",1,"main__camera__wrapper__video"],["video",""],[1,"main__camera__canvas"],["canvas",""],[1,"main__camera__wrapper__overlay"],["overlayVideo",""],["expressionsLabel",""]],template:function(e,t){1&e&&(f.Vb(0,"div",0),f.zc(1,Ye,5,1,"div",1),f.Qb(2,"video",2,3),f.Ub(),f.Qb(4,"canvas",4,5)),2&e&&(f.Cb(1),f.mc("ngIf",t.showOverlayMessage),f.Cb(1),f.Gb("active",t.isFaceValid))},directives:[B.k],styles:['@charset "UTF-8";@-webkit-keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@-webkit-keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@font-face{font-family:OpenSans-Regular;src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot);src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot?#iefix) format("embedded-opentype"),url(OpenSans-Regular.5d5735e57127db2f7a2a.woff2) format("woff2"),url(OpenSans-Regular.6fde2eb6728eb97fd914.woff) format("woff"),url(OpenSans-Regular.8df00d6176ddae387d94.ttf) format("truetype"),url(OpenSans-Regular.bbbd47d2660d3547e98a.svg#OpenSans-Regular) format("svg");font-weight:400;font-style:normal}@font-face{font-family:OpenSans-ExtraBoldItalic;src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot);src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBoldItalic.d69a748730ffaa1494fb.woff2) format("woff2"),url(OpenSans-ExtraBoldItalic.edbbf5335fcb1e037d0e.woff) format("woff"),url(OpenSans-ExtraBoldItalic.f093928db8789603f791.ttf) format("truetype"),url(OpenSans-ExtraBoldItalic.60cbf3ab7cbcb2732e3c.svg#OpenSans-ExtraBoldItalic) format("svg");font-weight:800;font-style:italic}@font-face{font-family:OpenSans-SemiBold;src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot);src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBold.7106bb83a0e767e12659.woff2) format("woff2"),url(OpenSans-SemiBold.fe241c6c4f5a190e821b.woff) format("woff"),url(OpenSans-SemiBold.f28ed2e40f2a6955ddc5.ttf) format("truetype"),url(OpenSans-SemiBold.dd308ca05314118f5410.svg#OpenSans-SemiBold) format("svg");font-weight:600;font-style:normal}@font-face{font-family:OpenSans-Bold;src:url(OpenSans-Bold.5487bea91cef82008fdc.eot);src:url(OpenSans-Bold.5487bea91cef82008fdc.eot?#iefix) format("embedded-opentype"),url(OpenSans-Bold.93fe8f3415688d16bb94.woff2) format("woff2"),url(OpenSans-Bold.759ea19bccf8a5ca50a5.woff) format("woff"),url(OpenSans-Bold.ab38fda09644c992dc09.ttf) format("truetype"),url(OpenSans-Bold.8eb005f737c1e60d2e4d.svg#OpenSans-Bold) format("svg");font-weight:700;font-style:normal}@font-face{font-family:OpenSans-LightItalic;src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot);src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot?#iefix) format("embedded-opentype"),url(OpenSans-LightItalic.d821368c1b1a2f95186f.woff2) format("woff2"),url(OpenSans-LightItalic.f98d42be17e95311f1f8.woff) format("woff"),url(OpenSans-LightItalic.5a3ac4d0297da9f2b75c.ttf) format("truetype"),url(OpenSans-LightItalic.1d7a2f3d597960cd5d37.svg#OpenSans-LightItalic) format("svg");font-weight:300;font-style:italic}@font-face{font-family:OpenSans-BoldItalic;src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot);src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot?#iefix) format("embedded-opentype"),url(OpenSans-BoldItalic.183f1aa2eb319f83e073.woff2) format("woff2"),url(OpenSans-BoldItalic.0a96d2322aa762873140.woff) format("woff"),url(OpenSans-BoldItalic.ad5795be528d8256833a.ttf) format("truetype"),url(OpenSans-BoldItalic.bcbc56117328195e6bd3.svg#OpenSans-BoldItalic) format("svg");font-weight:700;font-style:italic}@font-face{font-family:OpenSans-SemiBoldItalic;src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot);src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBoldItalic.da6f476d3784fdfb4b33.woff2) format("woff2"),url(OpenSans-SemiBoldItalic.02669c88881b1577a54e.woff) format("woff"),url(OpenSans-SemiBoldItalic.3dc654f4cee24692f644.ttf) format("truetype"),url(OpenSans-SemiBoldItalic.045ad4303be6beb367d6.svg#OpenSans-SemiBoldItalic) format("svg");font-weight:600;font-style:italic}@font-face{font-family:OpenSans-Italic;src:url(OpenSans-Italic.1ec1b222862acc96228e.eot);src:url(OpenSans-Italic.1ec1b222862acc96228e.eot?#iefix) format("embedded-opentype"),url(OpenSans-Italic.c27ebc192b3fe6167aa9.woff2) format("woff2"),url(OpenSans-Italic.052b69c9c418c621fbd9.woff) format("woff"),url(OpenSans-Italic.a709ab6006407a103054.ttf) format("truetype"),url(OpenSans-Italic.2d835a9a0d5ab7cc6f62.svg#OpenSans-Italic) format("svg");font-weight:400;font-style:italic}@font-face{font-family:OpenSans-Light;src:url(OpenSans-Light.d8ba00bc265c4a055470.eot);src:url(OpenSans-Light.d8ba00bc265c4a055470.eot?#iefix) format("embedded-opentype"),url(OpenSans-Light.559e978f49dc58dbe421.woff2) format("woff2"),url(OpenSans-Light.c002a58fc48427af4884.woff) format("woff"),url(OpenSans-Light.b270c40ae5ed0192f44d.ttf) format("truetype"),url(OpenSans-Light.f78850b7adbe96ff18c9.svg#OpenSans-Light) format("svg");font-weight:300;font-style:normal}@font-face{font-family:OpenSans-ExtraBold;src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot);src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBold.1b2c3c4788d5f305789b.woff2) format("woff2"),url(OpenSans-ExtraBold.3f760f718edb65cd95c6.woff) format("woff"),url(OpenSans-ExtraBold.c9e437c181cb1c201188.ttf) format("truetype"),url(OpenSans-ExtraBold.a1a888c4158a9167d356.svg#OpenSans-ExtraBold) format("svg");font-weight:800;font-style:normal}@font-face{font-family:icomoon;src:url(icomoon.d25461326f680e27f6b9.eot?a80olx);src:url(icomoon.d25461326f680e27f6b9.eot?a80olx#iefix) format("embedded-opentype"),url(icomoon.5394b2a687c21e82faff.ttf?a80olx) format("truetype"),url(icomoon.ee719c35803c2cdae449.woff?a80olx) format("woff"),url(icomoon.36f8bbc7721d58817f5a.svg?a80olx#icomoon) format("svg");font-weight:400;font-style:normal;font-display:block}[class*=" icon-"][_ngcontent-%COMP%], [class^=icon-][_ngcontent-%COMP%]{font-family:icomoon!important;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon--no-camera[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue90e";color:#ededed}.icon--no-camera[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue90f";margin-left:-1em;color:#dd141d}.icon--hide-pass[_ngcontent-%COMP%]:before{content:"\ue90c"}.icon--show-pass[_ngcontent-%COMP%]:before{content:"\ue90d"}.icon--end-process[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue9a7";color:rgba(255,186,0,.4)}.icon--end-process[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue9a8";margin-left:-1em;color:#ffba00}.icon--rotate-camera[_ngcontent-%COMP%]:before{content:"\ue900";color:#fff}.icon--rotate-document[_ngcontent-%COMP%]:before{content:"\ue901"}.icon--take-photo[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue902";color:hsla(0,0%,100%,.5)}.icon--take-photo[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue903";margin-left:-1em;color:#fff}.icon--check[_ngcontent-%COMP%]:before{content:"\ue904";color:#fff}.icon--close[_ngcontent-%COMP%]:before{content:"\ue905";color:#fff}.icon--back-document[_ngcontent-%COMP%]:before{content:"\ue906";color:#fff}.icon--front-document[_ngcontent-%COMP%]:before{content:"\ue907";color:#fff}.icon--scan-document[_ngcontent-%COMP%]:before{content:"\ue908";color:#fff}.icon--face[_ngcontent-%COMP%]:before{content:"\ue909";color:#fff}.icon--user-form[_ngcontent-%COMP%]:before{content:"\ue90a";color:#fff}.icon--light[_ngcontent-%COMP%]:before{content:"\ue90b";color:#fff}.icon--pirate[_ngcontent-%COMP%]:before{content:"\ue9a4";color:#fff}.icon--questions[_ngcontent-%COMP%]:before{content:"\ue9a5";color:#fff}.icon--user-data[_ngcontent-%COMP%]:before{content:"\ue9a6";color:#fff}.main__camera__wrapper[_ngcontent-%COMP%]{position:relative}.main__camera__wrapper[_ngcontent-%COMP%]   .main__camera__wrapper__overlay[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:center;-ms-justify-content:center;justify-content:center;-ms-flex-pack:center;-moz-align-items:center;-ms-align-items:center;align-items:center;position:absolute;z-index:40;left:0;right:0;top:0;bottom:85%;text-align:center;background-color:rgba(0,0,0,.46);color:#fff;font-size:16px}.main__camera__wrapper[_ngcontent-%COMP%]   .main__camera__wrapper__video[_ngcontent-%COMP%]{background-color:#000;display:block;z-index:20;height:100%;width:100%;box-shadow:0 0 7px -1px #fff}.main__camera__wrapper[_ngcontent-%COMP%]   .main__camera__wrapper__video.active[_ngcontent-%COMP%]{box-shadow:0 0 9px 6px #0dff00}.main__camera__canvas[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;margin:0 auto}']}),Xe),Ze=n("bSwM"),Qe=n("bTqV"),Ke=n("FKr1");function et(e,t){if(1&e&&(f.Vb(0,"mat-option",17),f.Ac(1),f.Ub()),2&e){var n=t.$implicit;f.mc("value",n.value),f.Cb(1),f.Cc(" ",n.viewValue," ")}}function tt(e,t){1&e&&(f.Vb(0,"mat-error"),f.Ac(1," Documento de identificaci\xf3n es "),f.Vb(2,"strong"),f.Ac(3,"requerido"),f.Ub(),f.Ub())}function nt(e,t){1&e&&(f.Vb(0,"mat-error"),f.Ac(1," Nombre completo es "),f.Vb(2,"strong"),f.Ac(3,"requerido"),f.Ub(),f.Ub())}function ot(e,t){if(1&e&&(f.Vb(0,"div",3),f.Vb(1,"mat-form-field",18),f.Vb(2,"mat-label"),f.Ac(3,"Ingrese su nombre completo"),f.Ub(),f.Qb(4,"input",19),f.zc(5,nt,4,0,"mat-error",9),f.Ub(),f.Ub()),2&e){var n=f.hc();f.Cb(4),f.mc("formControl",n.nameFormControl),f.Cb(1),f.mc("ngIf",n.nameFormControl.hasError("required"))}}var it,at,rt=function(e){return{authorization:!0,"check-animation":e}},ct=function(e){return{disabled:e}},st=((it=function(){function e(t,n){_classCallCheck(this,e),this.modalsService=t,this.userFacade=n,this.startFaceLive=!1,this.buttonEnable=!0,this.checkAnimation=!1,this.subscription=[],this.nameFormControl=new d.c("",[d.n.required]),this.documentFormControl=new d.c("",[d.n.required]),this.nationality=new d.c("CO"),this.tipoDocumento=[{value:"CO",viewValue:"CC - Colombia"},{value:"MX",viewValue:"DNI - Mexico"}],this.authChecked=new d.c(!1,[d.n.requiredTrue])}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.forEach((function(e){return e.unsubscribe()}))}},{key:"ngOnInit",value:function(){var e=this;this.subscription.push(this.userFacade.GetCitizenInfoState$().subscribe((function(t){t?(console.log("startFaceLive",e.startFaceLive),e.startFaceLive=!0):(e.ClearControls(),e.EnableControls(!0))})))}},{key:"showModalAuthorization",value:function(){this.modalsService.showContractAuthorizationDialog()}},{key:"sendImageToValidate",value:function(e){this.startFaceLive=!1;var t=this.userFacade.GetCitizenInfoStateValue();this.userFacade.SendImageToEnroll({Imagen:e,GroupName:l,Provider:3,InformacionCiudadanoId:t.Id,Motivo:"",Descripcion:"".concat(t.PrimerNombre," ").concat(t.PrimerApellido),Codigo:"".concat(t.NUIP),Tag:""})}},{key:"Register",value:function(){this.SendUserData()}},{key:"SendUserData",value:function(){var e=this;!this.authChecked.value||!this.documentFormControl.value&&""===this.documentFormControl.value||"CO"!==this.nationality.value&&!this.nameFormControl.value&&""===this.nameFormControl.value?(this.documentFormControl.markAllAsTouched(),this.nameFormControl.markAllAsTouched(),this.checkAnimation||(this.checkAnimation=!this.authChecked.value,setTimeout((function(){return e.checkAnimation=!1}),400))):(this.EnableControls(!1),this.userFacade.SendToDocumentValidate({Data:{CodigoAplicacion:"B09E1729-CDDB-40E7-86BD-F7AF5461B7D8",Documento:this.documentFormControl.value,TipoDocumento:1,Nacionalidad:this.nationality.value,NombreCompleto:this.nameFormControl.value},Provider:3,GroupName:l}))}},{key:"ClearControls",value:function(){this.authChecked.setValue(!1),this.documentFormControl.setValue(""),this.nameFormControl.setValue(""),this.nationality.setValue("CO"),this.authChecked.markAsUntouched(),this.documentFormControl.markAsUntouched(),this.nameFormControl.markAsUntouched(),this.nationality.markAsUntouched()}},{key:"EnableControls",value:function(e){e?this.authChecked.enable():this.authChecked.disable(),e?this.documentFormControl.enable():this.documentFormControl.disable(),e?this.nameFormControl.enable():this.nameFormControl.disable(),e?this.nationality.enable():this.nationality.disable(),this.buttonEnable=e}}]),e}()).\u0275fac=function(e){return new(e||it)(f.Pb(v),f.Pb(I))},it.\u0275cmp=f.Jb({type:it,selectors:[["app-users-register"]],decls:28,vars:14,consts:[[1,"container"],[1,"message"],[1,"control"],[1,"form-row"],[1,"w30"],[3,"formControl"],[3,"value",4,"ngFor","ngForOf"],[1,"w70","pl5"],["matInput","","placeholder","Ingrese su c\xe9dula de ciudadania",3,"formControl"],[4,"ngIf"],["class","form-row",4,"ngIf"],[1,"camera"],[3,"startFaceLive","livefaceImage","startFaceLiveChange"],[3,"ngClass"],[2,"color","rgb(153,217,243)","cursor","pointer",3,"click"],[1,"button"],["mat-raised-button","","color","primary",3,"disabled","ngClass","click"],[3,"value"],[1,"w100"],["matInput","","placeholder","Ingrese su nombre completo",3,"formControl"]],template:function(e,t){1&e&&(f.Vb(0,"section",0),f.Vb(1,"span",1),f.Ac(2,"COMPLETE LA INFORMACION PARA CONTINUAR"),f.Ub(),f.Vb(3,"div",2),f.Vb(4,"div",3),f.Vb(5,"mat-form-field",4),f.Vb(6,"mat-label"),f.Ac(7,"Tipo de documento"),f.Ub(),f.Vb(8,"mat-select",5),f.zc(9,et,2,2,"mat-option",6),f.Ub(),f.Ub(),f.Vb(10,"mat-form-field",7),f.Vb(11,"mat-label"),f.Ac(12,"Ingrese su n\xfamero de identificaci\xf3n"),f.Ub(),f.Qb(13,"input",8),f.zc(14,tt,4,0,"mat-error",9),f.Ub(),f.Ub(),f.zc(15,ot,6,2,"div",10),f.Ub(),f.Vb(16,"div",11),f.Vb(17,"app-liveface-camera",12),f.dc("livefaceImage",(function(e){return t.sendImageToValidate(e)}))("startFaceLiveChange",(function(e){return t.startFaceLive=e})),f.Ub(),f.Ub(),f.Vb(18,"div",13),f.Qb(19,"mat-checkbox",5),f.Vb(20,"span"),f.Ac(21,"Acepto la "),f.Vb(22,"span",14),f.dc("click",(function(){return t.showModalAuthorization()})),f.Ac(23,"autorizaci\xf3n del tratamiento de datos personales"),f.Ub(),f.Ac(24," de ReconoSER ID"),f.Ub(),f.Ub(),f.Vb(25,"div",15),f.Vb(26,"button",16),f.dc("click",(function(){return t.Register()})),f.Ac(27,"Iniciar"),f.Ub(),f.Ub(),f.Ub()),2&e&&(f.Cb(8),f.mc("formControl",t.nationality),f.Cb(1),f.mc("ngForOf",t.tipoDocumento),f.Cb(4),f.mc("formControl",t.documentFormControl),f.Cb(1),f.mc("ngIf",t.documentFormControl.hasError("required")),f.Cb(1),f.mc("ngIf","MX"===t.nationality.value),f.Cb(2),f.mc("startFaceLive",t.startFaceLive),f.Cb(1),f.mc("ngClass",f.oc(10,rt,t.checkAnimation)),f.Cb(1),f.mc("formControl",t.authChecked),f.Cb(7),f.mc("disabled",!t.buttonEnable)("ngClass",f.oc(12,ct,!t.buttonEnable)))},directives:[P.c,P.f,A.a,d.k,d.d,B.j,T.a,d.b,B.k,Je,B.i,Ze.a,Qe.b,Ke.f,P.b],styles:['@charset "UTF-8";@font-face{font-family:OpenSans-Regular;src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot);src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot?#iefix) format("embedded-opentype"),url(OpenSans-Regular.5d5735e57127db2f7a2a.woff2) format("woff2"),url(OpenSans-Regular.6fde2eb6728eb97fd914.woff) format("woff"),url(OpenSans-Regular.8df00d6176ddae387d94.ttf) format("truetype"),url(OpenSans-Regular.bbbd47d2660d3547e98a.svg#OpenSans-Regular) format("svg");font-weight:400;font-style:normal}@font-face{font-family:OpenSans-ExtraBoldItalic;src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot);src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBoldItalic.d69a748730ffaa1494fb.woff2) format("woff2"),url(OpenSans-ExtraBoldItalic.edbbf5335fcb1e037d0e.woff) format("woff"),url(OpenSans-ExtraBoldItalic.f093928db8789603f791.ttf) format("truetype"),url(OpenSans-ExtraBoldItalic.60cbf3ab7cbcb2732e3c.svg#OpenSans-ExtraBoldItalic) format("svg");font-weight:800;font-style:italic}@font-face{font-family:OpenSans-SemiBold;src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot);src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBold.7106bb83a0e767e12659.woff2) format("woff2"),url(OpenSans-SemiBold.fe241c6c4f5a190e821b.woff) format("woff"),url(OpenSans-SemiBold.f28ed2e40f2a6955ddc5.ttf) format("truetype"),url(OpenSans-SemiBold.dd308ca05314118f5410.svg#OpenSans-SemiBold) format("svg");font-weight:600;font-style:normal}@font-face{font-family:OpenSans-Bold;src:url(OpenSans-Bold.5487bea91cef82008fdc.eot);src:url(OpenSans-Bold.5487bea91cef82008fdc.eot?#iefix) format("embedded-opentype"),url(OpenSans-Bold.93fe8f3415688d16bb94.woff2) format("woff2"),url(OpenSans-Bold.759ea19bccf8a5ca50a5.woff) format("woff"),url(OpenSans-Bold.ab38fda09644c992dc09.ttf) format("truetype"),url(OpenSans-Bold.8eb005f737c1e60d2e4d.svg#OpenSans-Bold) format("svg");font-weight:700;font-style:normal}@font-face{font-family:OpenSans-LightItalic;src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot);src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot?#iefix) format("embedded-opentype"),url(OpenSans-LightItalic.d821368c1b1a2f95186f.woff2) format("woff2"),url(OpenSans-LightItalic.f98d42be17e95311f1f8.woff) format("woff"),url(OpenSans-LightItalic.5a3ac4d0297da9f2b75c.ttf) format("truetype"),url(OpenSans-LightItalic.1d7a2f3d597960cd5d37.svg#OpenSans-LightItalic) format("svg");font-weight:300;font-style:italic}@font-face{font-family:OpenSans-BoldItalic;src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot);src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot?#iefix) format("embedded-opentype"),url(OpenSans-BoldItalic.183f1aa2eb319f83e073.woff2) format("woff2"),url(OpenSans-BoldItalic.0a96d2322aa762873140.woff) format("woff"),url(OpenSans-BoldItalic.ad5795be528d8256833a.ttf) format("truetype"),url(OpenSans-BoldItalic.bcbc56117328195e6bd3.svg#OpenSans-BoldItalic) format("svg");font-weight:700;font-style:italic}@font-face{font-family:OpenSans-SemiBoldItalic;src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot);src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBoldItalic.da6f476d3784fdfb4b33.woff2) format("woff2"),url(OpenSans-SemiBoldItalic.02669c88881b1577a54e.woff) format("woff"),url(OpenSans-SemiBoldItalic.3dc654f4cee24692f644.ttf) format("truetype"),url(OpenSans-SemiBoldItalic.045ad4303be6beb367d6.svg#OpenSans-SemiBoldItalic) format("svg");font-weight:600;font-style:italic}@font-face{font-family:OpenSans-Italic;src:url(OpenSans-Italic.1ec1b222862acc96228e.eot);src:url(OpenSans-Italic.1ec1b222862acc96228e.eot?#iefix) format("embedded-opentype"),url(OpenSans-Italic.c27ebc192b3fe6167aa9.woff2) format("woff2"),url(OpenSans-Italic.052b69c9c418c621fbd9.woff) format("woff"),url(OpenSans-Italic.a709ab6006407a103054.ttf) format("truetype"),url(OpenSans-Italic.2d835a9a0d5ab7cc6f62.svg#OpenSans-Italic) format("svg");font-weight:400;font-style:italic}@font-face{font-family:OpenSans-Light;src:url(OpenSans-Light.d8ba00bc265c4a055470.eot);src:url(OpenSans-Light.d8ba00bc265c4a055470.eot?#iefix) format("embedded-opentype"),url(OpenSans-Light.559e978f49dc58dbe421.woff2) format("woff2"),url(OpenSans-Light.c002a58fc48427af4884.woff) format("woff"),url(OpenSans-Light.b270c40ae5ed0192f44d.ttf) format("truetype"),url(OpenSans-Light.f78850b7adbe96ff18c9.svg#OpenSans-Light) format("svg");font-weight:300;font-style:normal}@font-face{font-family:OpenSans-ExtraBold;src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot);src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBold.1b2c3c4788d5f305789b.woff2) format("woff2"),url(OpenSans-ExtraBold.3f760f718edb65cd95c6.woff) format("woff"),url(OpenSans-ExtraBold.c9e437c181cb1c201188.ttf) format("truetype"),url(OpenSans-ExtraBold.a1a888c4158a9167d356.svg#OpenSans-ExtraBold) format("svg");font-weight:800;font-style:normal}@font-face{font-family:icomoon;src:url(icomoon.d25461326f680e27f6b9.eot?a80olx);src:url(icomoon.d25461326f680e27f6b9.eot?a80olx#iefix) format("embedded-opentype"),url(icomoon.5394b2a687c21e82faff.ttf?a80olx) format("truetype"),url(icomoon.ee719c35803c2cdae449.woff?a80olx) format("woff"),url(icomoon.36f8bbc7721d58817f5a.svg?a80olx#icomoon) format("svg");font-weight:400;font-style:normal;font-display:block}[class*=" icon-"][_ngcontent-%COMP%], [class^=icon-][_ngcontent-%COMP%]{font-family:icomoon!important;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon--no-camera[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue90e";color:#ededed}.icon--no-camera[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue90f";margin-left:-1em;color:#dd141d}.icon--hide-pass[_ngcontent-%COMP%]:before{content:"\ue90c"}.icon--show-pass[_ngcontent-%COMP%]:before{content:"\ue90d"}.icon--end-process[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue9a7";color:rgba(255,186,0,.4)}.icon--end-process[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue9a8";margin-left:-1em;color:#ffba00}.icon--rotate-camera[_ngcontent-%COMP%]:before{content:"\ue900";color:#fff}.icon--rotate-document[_ngcontent-%COMP%]:before{content:"\ue901"}.icon--take-photo[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue902";color:hsla(0,0%,100%,.5)}.icon--take-photo[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue903";margin-left:-1em;color:#fff}.icon--check[_ngcontent-%COMP%]:before{content:"\ue904";color:#fff}.icon--close[_ngcontent-%COMP%]:before{content:"\ue905";color:#fff}.icon--back-document[_ngcontent-%COMP%]:before{content:"\ue906";color:#fff}.icon--front-document[_ngcontent-%COMP%]:before{content:"\ue907";color:#fff}.icon--scan-document[_ngcontent-%COMP%]:before{content:"\ue908";color:#fff}.icon--face[_ngcontent-%COMP%]:before{content:"\ue909";color:#fff}.icon--user-form[_ngcontent-%COMP%]:before{content:"\ue90a";color:#fff}.icon--light[_ngcontent-%COMP%]:before{content:"\ue90b";color:#fff}.icon--pirate[_ngcontent-%COMP%]:before{content:"\ue9a4";color:#fff}.icon--questions[_ngcontent-%COMP%]:before{content:"\ue9a5";color:#fff}.icon--user-data[_ngcontent-%COMP%]:before{content:"\ue9a6";color:#fff}@-webkit-keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@-webkit-keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}.mat-dialog-container[_ngcontent-%COMP%]{padding:0!important}.check-animation[_ngcontent-%COMP%]{-webkit-animation-duration:.1s;animation-duration:.1s;-webkit-animation-name:slidein;animation-name:slidein;-webkit-animation-iteration-count:6;animation-iteration-count:6;-webkit-animation-direction:alternate;animation-direction:alternate}@-webkit-keyframes slidein{0%{transform:scale(1)}to{transform:scale(1.05)}}@keyframes slidein{0%{transform:scale(1)}to{transform:scale(1.05)}}.container[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:column;flex-direction:column;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;-moz-align-items:center;-ms-align-items:center;align-items:center;width:700px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:2% 0}.container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{background-color:#f4f4f4;height:1.36rem}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{display:flex;-moz-align-items:center;-ms-align-items:center;align-items:center;width:100%;padding-left:5%;font-size:1rem}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]{-moz-flex-direction:column;flex-direction:column;padding-top:1rem}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;flex-wrap:nowrap;-moz-align-items:center;-ms-align-items:center;align-items:center;-ms-align-content:stretch;align-content:stretch;width:100%;padding-right:5%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .w30[_ngcontent-%COMP%]{width:30%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .w70[_ngcontent-%COMP%]{width:70%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .pl5[_ngcontent-%COMP%]{padding-left:5%}.container[_ngcontent-%COMP%]   .control[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .w100[_ngcontent-%COMP%]{width:100%}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{position:relative;display:block;padding-top:.5rem;margin-top:0;width:680px;min-height:-webkit-fit-content;min-height:-moz-fit-content;min-height:fit-content}.container[_ngcontent-%COMP%]   .authorization[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;width:100%;padding-bottom:2%;padding-top:1.5rem;padding-left:5%;text-align:left;color:#bababa}.container[_ngcontent-%COMP%]   .authorization[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:last-child{padding-left:5px;font-size:.8rem;letter-spacing:1px}.container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{width:100%;display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:flex-end;-ms-justify-content:flex-end;justify-content:flex-end;-ms-flex-pack:flex-end;padding:2%}.container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#00a1e2;width:30%;letter-spacing:1px;bottom:7%;font-weight:100;font-size:16px}.container[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   button.disabled[_ngcontent-%COMP%]{background-color:#d6d6d6;color:#666}@media (max-width:1366px){.container[_ngcontent-%COMP%]{width:480px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:450px}}@media (max-width:1024px){.container[_ngcontent-%COMP%]{width:460px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:440px}}']}),it),dt=n("yuJt"),lt=s.e.forChild([{path:"register",component:st},{path:"validation",component:(at=function(){function e(t,n,o,i,a){_classCallCheck(this,e),this.modalsService=t,this.userFacade=n,this.videoRecorderService=o,this.locationFacade=i,this.router=a,this.startFaceLive=!0,this.subscription=[],this.helper=new dt.a,this.browserName=je().name+" V"+je().version,this.osName=je().os}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.forEach((function(e){return e.unsubscribe()}))}},{key:"ngOnInit",value:function(){this.FaceRecognitionInit()}},{key:"FaceRecognitionInit",value:function(){var e=this,t=this.userFacade.GetfaceRecognitionState$();this.subscription.push(t.subscribe((function(t){if(t)if(t.Reconocido){var n="",o=e.videoRecorderService.GetVideoRecorder();o&&(n=t.Detail.PrimerNombre+"-"+e.helper.convertToDate(new Date),o.name=n,e.userFacade.SendVideoRecorder(o)),e.userFacade.SetToUsersHistoric(e.BuildHistoricoRequest(t,n)),e.userFacade.GetUsersHistoricById(t.IdFeature),e.modalsService.showRecognizedCitizen({info:t,lastUpdate:e.userFacade.GetusersHistoricLast$()}).afterClosed().subscribe((function(t){t&&e.router.navigate(["/home/register"],{fragment:"information"})}))}else e.subscription.push(e.modalsService.showAlertNotificationDialog({info:"No identificado",title:"Error",icon:"bad"}).afterClosed().subscribe((function(t){setTimeout((function(){e.startFaceLive=!0}),2e3)})))})))}},{key:"BuildHistoricoRequest",value:function(e,t){return{VideoUrl:t,Provider:3,GroupName:l,IdFeature:e.IdFeature,Ip:this.locationFacade.deviceIp$.value,Browser:this.browserName,SistemaOperativo:this.osName,Descripcion:e.Descripcion,Fecha:this.helper.convertToDateFormat(new Date)}}},{key:"sendImageToValidate",value:function(e){this.userFacade.SendToIdentificationFace({Imagen:e,GroupName:l,Provider:3})}}]),e}(),at.\u0275fac=function(e){return new(e||at)(f.Pb(v),f.Pb(I),f.Pb(qe),f.Pb(x),f.Pb(s.b))},at.\u0275cmp=f.Jb({type:at,selectors:[["app-users-validation"]],decls:10,vars:1,consts:[[1,"container"],[1,"message"],[1,"camera"],[3,"startFaceLive","livefaceImage","startFaceLiveChange"],[1,"footer"],[1,"material-icons"]],template:function(e,t){1&e&&(f.Vb(0,"section",0),f.Vb(1,"span",1),f.Ac(2,"SIGA LAS INDICACIONES EN PANTALLA"),f.Ub(),f.Vb(3,"div",2),f.Vb(4,"app-liveface-camera",3),f.dc("livefaceImage",(function(e){return t.sendImageToValidate(e)}))("startFaceLiveChange",(function(e){return t.startFaceLive=e})),f.Ub(),f.Ub(),f.Vb(5,"div",4),f.Vb(6,"i",5),f.Ac(7,"error"),f.Ub(),f.Vb(8,"span"),f.Ac(9,"El rostro que se capture se comparar\xe1 frente a todos los rostros registrados en esta plataforma."),f.Ub(),f.Ub(),f.Ub()),2&e&&(f.Cb(4),f.mc("startFaceLive",t.startFaceLive))},directives:[Je],styles:['@charset "UTF-8";@font-face{font-family:OpenSans-Regular;src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot);src:url(OpenSans-Regular.38ca9e2302c8793c93f8.eot?#iefix) format("embedded-opentype"),url(OpenSans-Regular.5d5735e57127db2f7a2a.woff2) format("woff2"),url(OpenSans-Regular.6fde2eb6728eb97fd914.woff) format("woff"),url(OpenSans-Regular.8df00d6176ddae387d94.ttf) format("truetype"),url(OpenSans-Regular.bbbd47d2660d3547e98a.svg#OpenSans-Regular) format("svg");font-weight:400;font-style:normal}@font-face{font-family:OpenSans-ExtraBoldItalic;src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot);src:url(OpenSans-ExtraBoldItalic.3548064077a9426230de.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBoldItalic.d69a748730ffaa1494fb.woff2) format("woff2"),url(OpenSans-ExtraBoldItalic.edbbf5335fcb1e037d0e.woff) format("woff"),url(OpenSans-ExtraBoldItalic.f093928db8789603f791.ttf) format("truetype"),url(OpenSans-ExtraBoldItalic.60cbf3ab7cbcb2732e3c.svg#OpenSans-ExtraBoldItalic) format("svg");font-weight:800;font-style:italic}@font-face{font-family:OpenSans-SemiBold;src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot);src:url(OpenSans-SemiBold.e0d5280b186197bd2a77.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBold.7106bb83a0e767e12659.woff2) format("woff2"),url(OpenSans-SemiBold.fe241c6c4f5a190e821b.woff) format("woff"),url(OpenSans-SemiBold.f28ed2e40f2a6955ddc5.ttf) format("truetype"),url(OpenSans-SemiBold.dd308ca05314118f5410.svg#OpenSans-SemiBold) format("svg");font-weight:600;font-style:normal}@font-face{font-family:OpenSans-Bold;src:url(OpenSans-Bold.5487bea91cef82008fdc.eot);src:url(OpenSans-Bold.5487bea91cef82008fdc.eot?#iefix) format("embedded-opentype"),url(OpenSans-Bold.93fe8f3415688d16bb94.woff2) format("woff2"),url(OpenSans-Bold.759ea19bccf8a5ca50a5.woff) format("woff"),url(OpenSans-Bold.ab38fda09644c992dc09.ttf) format("truetype"),url(OpenSans-Bold.8eb005f737c1e60d2e4d.svg#OpenSans-Bold) format("svg");font-weight:700;font-style:normal}@font-face{font-family:OpenSans-LightItalic;src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot);src:url(OpenSans-LightItalic.c2e4b54642e6a4a47da1.eot?#iefix) format("embedded-opentype"),url(OpenSans-LightItalic.d821368c1b1a2f95186f.woff2) format("woff2"),url(OpenSans-LightItalic.f98d42be17e95311f1f8.woff) format("woff"),url(OpenSans-LightItalic.5a3ac4d0297da9f2b75c.ttf) format("truetype"),url(OpenSans-LightItalic.1d7a2f3d597960cd5d37.svg#OpenSans-LightItalic) format("svg");font-weight:300;font-style:italic}@font-face{font-family:OpenSans-BoldItalic;src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot);src:url(OpenSans-BoldItalic.30dd88ede7a982a2e92f.eot?#iefix) format("embedded-opentype"),url(OpenSans-BoldItalic.183f1aa2eb319f83e073.woff2) format("woff2"),url(OpenSans-BoldItalic.0a96d2322aa762873140.woff) format("woff"),url(OpenSans-BoldItalic.ad5795be528d8256833a.ttf) format("truetype"),url(OpenSans-BoldItalic.bcbc56117328195e6bd3.svg#OpenSans-BoldItalic) format("svg");font-weight:700;font-style:italic}@font-face{font-family:OpenSans-SemiBoldItalic;src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot);src:url(OpenSans-SemiBoldItalic.0d92fc08a8a83e6b2956.eot?#iefix) format("embedded-opentype"),url(OpenSans-SemiBoldItalic.da6f476d3784fdfb4b33.woff2) format("woff2"),url(OpenSans-SemiBoldItalic.02669c88881b1577a54e.woff) format("woff"),url(OpenSans-SemiBoldItalic.3dc654f4cee24692f644.ttf) format("truetype"),url(OpenSans-SemiBoldItalic.045ad4303be6beb367d6.svg#OpenSans-SemiBoldItalic) format("svg");font-weight:600;font-style:italic}@font-face{font-family:OpenSans-Italic;src:url(OpenSans-Italic.1ec1b222862acc96228e.eot);src:url(OpenSans-Italic.1ec1b222862acc96228e.eot?#iefix) format("embedded-opentype"),url(OpenSans-Italic.c27ebc192b3fe6167aa9.woff2) format("woff2"),url(OpenSans-Italic.052b69c9c418c621fbd9.woff) format("woff"),url(OpenSans-Italic.a709ab6006407a103054.ttf) format("truetype"),url(OpenSans-Italic.2d835a9a0d5ab7cc6f62.svg#OpenSans-Italic) format("svg");font-weight:400;font-style:italic}@font-face{font-family:OpenSans-Light;src:url(OpenSans-Light.d8ba00bc265c4a055470.eot);src:url(OpenSans-Light.d8ba00bc265c4a055470.eot?#iefix) format("embedded-opentype"),url(OpenSans-Light.559e978f49dc58dbe421.woff2) format("woff2"),url(OpenSans-Light.c002a58fc48427af4884.woff) format("woff"),url(OpenSans-Light.b270c40ae5ed0192f44d.ttf) format("truetype"),url(OpenSans-Light.f78850b7adbe96ff18c9.svg#OpenSans-Light) format("svg");font-weight:300;font-style:normal}@font-face{font-family:OpenSans-ExtraBold;src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot);src:url(OpenSans-ExtraBold.b279b074e3f149694a81.eot?#iefix) format("embedded-opentype"),url(OpenSans-ExtraBold.1b2c3c4788d5f305789b.woff2) format("woff2"),url(OpenSans-ExtraBold.3f760f718edb65cd95c6.woff) format("woff"),url(OpenSans-ExtraBold.c9e437c181cb1c201188.ttf) format("truetype"),url(OpenSans-ExtraBold.a1a888c4158a9167d356.svg#OpenSans-ExtraBold) format("svg");font-weight:800;font-style:normal}@font-face{font-family:icomoon;src:url(icomoon.d25461326f680e27f6b9.eot?a80olx);src:url(icomoon.d25461326f680e27f6b9.eot?a80olx#iefix) format("embedded-opentype"),url(icomoon.5394b2a687c21e82faff.ttf?a80olx) format("truetype"),url(icomoon.ee719c35803c2cdae449.woff?a80olx) format("woff"),url(icomoon.36f8bbc7721d58817f5a.svg?a80olx#icomoon) format("svg");font-weight:400;font-style:normal;font-display:block}[class*=" icon-"][_ngcontent-%COMP%], [class^=icon-][_ngcontent-%COMP%]{font-family:icomoon!important;speak:none;font-style:normal;font-weight:400;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon--no-camera[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue90e";color:#ededed}.icon--no-camera[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue90f";margin-left:-1em;color:#dd141d}.icon--hide-pass[_ngcontent-%COMP%]:before{content:"\ue90c"}.icon--show-pass[_ngcontent-%COMP%]:before{content:"\ue90d"}.icon--end-process[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue9a7";color:rgba(255,186,0,.4)}.icon--end-process[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue9a8";margin-left:-1em;color:#ffba00}.icon--rotate-camera[_ngcontent-%COMP%]:before{content:"\ue900";color:#fff}.icon--rotate-document[_ngcontent-%COMP%]:before{content:"\ue901"}.icon--take-photo[_ngcontent-%COMP%]   .path1[_ngcontent-%COMP%]:before{content:"\ue902";color:hsla(0,0%,100%,.5)}.icon--take-photo[_ngcontent-%COMP%]   .path2[_ngcontent-%COMP%]:before{content:"\ue903";margin-left:-1em;color:#fff}.icon--check[_ngcontent-%COMP%]:before{content:"\ue904";color:#fff}.icon--close[_ngcontent-%COMP%]:before{content:"\ue905";color:#fff}.icon--back-document[_ngcontent-%COMP%]:before{content:"\ue906";color:#fff}.icon--front-document[_ngcontent-%COMP%]:before{content:"\ue907";color:#fff}.icon--scan-document[_ngcontent-%COMP%]:before{content:"\ue908";color:#fff}.icon--face[_ngcontent-%COMP%]:before{content:"\ue909";color:#fff}.icon--user-form[_ngcontent-%COMP%]:before{content:"\ue90a";color:#fff}.icon--light[_ngcontent-%COMP%]:before{content:"\ue90b";color:#fff}.icon--pirate[_ngcontent-%COMP%]:before{content:"\ue9a4";color:#fff}.icon--questions[_ngcontent-%COMP%]:before{content:"\ue9a5";color:#fff}.icon--user-data[_ngcontent-%COMP%]:before{content:"\ue9a6";color:#fff}@-webkit-keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@keyframes bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-5px)}60%{transform:translateY(-5px)}}@-webkit-keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}@keyframes scale{25%{transform:scale(.95)}75%{transform:scale(1.05)}}.container[_ngcontent-%COMP%]{-moz-flex-direction:column;flex-direction:column;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;width:700px;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:2% 0}.container[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{display:flex;-moz-align-items:center;-ms-align-items:center;align-items:center}.container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{width:100%;padding-left:5%;background-color:#f4f4f4;font-size:1rem;height:1.36rem}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{position:relative;display:block;padding-top:.5rem;margin-top:0;width:680px;min-height:-webkit-fit-content;min-height:-moz-fit-content;min-height:fit-content}.container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;-moz-flex-direction:row;flex-direction:row;-moz-justify-content:flex-start;-ms-justify-content:flex-start;justify-content:flex-start;-ms-flex-pack:flex-start;-moz-align-items:center;-ms-align-items:center;align-items:center;color:#f84751;font-size:1rem;padding-left:5%}.container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:first-child{font-size:1.8rem;padding-right:10px}@media (max-width:1366px){.container[_ngcontent-%COMP%]{width:480px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:450px;background:0}}@media (max-width:1024px){.container[_ngcontent-%COMP%]{width:460px}.container[_ngcontent-%COMP%]   .camera[_ngcontent-%COMP%]{width:440px}}']}),at)}]),ft=n("cnhx"),ut=n("VEcq");n.d(t,"UsersModule",(function(){return ht}));var mt,ht=((mt=function e(){_classCallCheck(this,e)}).\u0275mod=f.Nb({type:mt}),mt.\u0275inj=f.Mb({factory:function(e){return new(e||mt)},imports:[[ft.a,ut.a,lt]]}),mt)},RdDz:function(e,t,n){var o,i;void 0===(i="function"==typeof(o=function(){"use strict";return function(e,t,n){t=t||"",n=n||512;for(var o=atob(e),i=[],a=0;a<o.length;a+=n){for(var r=o.slice(a,a+n),c=new Array(r.length),s=0;s<r.length;s++)c[s]=r.charCodeAt(s);var d=new Uint8Array(c);i.push(d)}return new Blob(i,{type:t})}})?o.apply(t,[]):o)||(e.exports=i)},qe5e:function(e,t,n){"use strict";var o,i;function a(e,t){if(!e)throw"First parameter is required.";t=new r(e,t=t||{type:"video"});var n=this;function o(n){n&&(t.initCallback=function(){n(),n=t.initCallback=null});var o=new c(e,t);(u=new o(e,t)).record(),f("recording"),t.disableLogs||console.log("Initialized recorderType:",u.constructor.name,"for output-type:",t.type)}function i(e){if(e=e||function(){},u){if("paused"===n.state)return n.resumeRecording(),void setTimeout((function(){i(e)}),1);"recording"===n.state||t.disableLogs||console.warn('Recording state should be: "recording", however current state is: ',n.state),t.disableLogs||console.log("Stopped recording "+t.type+" stream."),"gif"!==t.type?u.stop(o):(u.stop(),o()),f("stopped")}else p();function o(o){if(u){Object.keys(u).forEach((function(e){"function"!=typeof u[e]&&(n[e]=u[e])}));var i=u.blob;if(!i){if(!o)throw"Recording failed.";u.blob=i=o}if(i&&!t.disableLogs&&console.log(i.type,"->",y(i.size)),e){var a;try{a=m.createObjectURL(i)}catch(r){}"function"==typeof e.call?e.call(n,a):e(a)}t.autoWriteToDisk&&d((function(e){var n={};n[t.type+"Blob"]=e,T.Store(n)}))}else"function"==typeof e.call?e.call(n,""):e("")}}function s(e){postMessage((new FileReaderSync).readAsDataURL(e))}function d(e,n){if(!e)throw"Pass a callback function over getDataURL.";var o=n?n.blob:(u||{}).blob;if(!o)return t.disableLogs||console.warn("Blob encoder did not finish its job yet."),void setTimeout((function(){d(e,n)}),1e3);if("undefined"==typeof Worker||navigator.mozGetUserMedia){var i=new FileReader;i.readAsDataURL(o),i.onload=function(t){e(t.target.result)}}else{var a=function(e){try{var t=m.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),n=new Worker(t);return m.revokeObjectURL(t),n}catch(o){}}(s);a.onmessage=function(t){e(t.data)},a.postMessage(o)}}function l(e){e=e||0,"paused"!==n.state?"stopped"!==n.state&&(e>=n.recordingDuration?i(n.onRecordingStopped):(e+=1e3,setTimeout((function(){l(e)}),1e3))):setTimeout((function(){l(e)}),1e3)}function f(e){n&&(n.state=e,"function"==typeof n.onStateChanged.call?n.onStateChanged.call(n,e):n.onStateChanged(e))}var u,h='It seems that recorder is destroyed or "startRecording" is not invoked for '+t.type+" recorder.";function p(){!0!==t.disableLogs&&console.warn(h)}var g={startRecording:function(i){return t.disableLogs||console.log("RecordRTC version: ",n.version),i&&(t=new r(e,i)),t.disableLogs||console.log("started recording "+t.type+" stream."),u?(u.clearRecordedData(),u.record(),f("recording"),n.recordingDuration&&l(),n):(o((function(){n.recordingDuration&&l()})),n)},stopRecording:i,pauseRecording:function(){u?"recording"===n.state?(f("paused"),u.pause(),t.disableLogs||console.log("Paused recording.")):t.disableLogs||console.warn("Unable to pause the recording. Recording state: ",n.state):p()},resumeRecording:function(){u?"paused"===n.state?(f("recording"),u.resume(),t.disableLogs||console.log("Resumed recording.")):t.disableLogs||console.warn("Unable to resume the recording. Recording state: ",n.state):p()},initRecorder:o,setRecordingDuration:function(e,t){if(void 0===e)throw"recordingDuration is required.";if("number"!=typeof e)throw"recordingDuration must be a number.";return n.recordingDuration=e,n.onRecordingStopped=t||function(){},{onRecordingStopped:function(e){n.onRecordingStopped=e}}},clearRecordedData:function(){u?(u.clearRecordedData(),t.disableLogs||console.log("Cleared old recorded data.")):p()},getBlob:function(){if(u)return u.blob;p()},getDataURL:d,toURL:function(){if(u)return m.createObjectURL(u.blob);p()},getInternalRecorder:function(){return u},save:function(e){u?S(u.blob,e):p()},getFromDisk:function(e){u?a.getFromDisk(t.type,e):p()},setAdvertisementArray:function(e){t.advertisement=[];for(var n=e.length,o=0;o<n;o++)t.advertisement.push({duration:o,image:e[o]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){"recording"!==n.state||t.disableLogs||console.warn("Stop an active recorder."),u&&"function"==typeof u.clearRecordedData&&u.clearRecordedData(),u=null,f("inactive"),n.blob=null},onStateChanged:function(e){t.disableLogs||console.log("Recorder state changed:",e)},state:"inactive",getState:function(){return n.state},destroy:function(){var e=t.disableLogs;t={disableLogs:!0},n.reset(),f("destroyed"),g=n=null,R.AudioContextConstructor&&(R.AudioContextConstructor.close(),R.AudioContextConstructor=null),t.disableLogs=e,t.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.5.9"};if(!this)return n=g,g;for(var b in g)this[b]=g[b];return n=this,g}function r(e,t){return t.recorderType||t.type||(t.audio&&t.video?t.type="video":t.audio&&!t.video&&(t.type="audio")),t.recorderType&&!t.type&&(t.recorderType===A||t.recorderType===P||t.recorderType===E?t.type="video":t.recorderType===F?t.type="gif":t.recorderType===I?t.type="audio":t.recorderType===M&&(O(e,"audio").length&&O(e,"video").length?t.type="video":!O(e,"audio").length&&O(e,"video").length?t.type="video":O(e,"audio").length&&!O(e,"video").length&&(t.type="audio"))),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(t.mimeType||(t.mimeType="video/webm"),t.type||(t.type=t.mimeType.split("/")[0])),t.type||(t.mimeType&&(t.type=t.mimeType.split("/")[0]),t.type||(t.type="audio")),t}function c(e,t){var n;return(b||h||p)&&(n=I),"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&!b&&(n=M),"video"===t.type&&(b||p)&&(n=A,"undefined"!=typeof ReadableStream&&(n=E)),"gif"===t.type&&(n=F),"canvas"===t.type&&(n=P),x()&&n!==P&&n!==F&&"undefined"!=typeof MediaRecorder&&"requestData"in MediaRecorder.prototype&&(O(e,"video").length||O(e,"audio").length)&&("audio"===t.type?"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("audio/webm")&&(n=M):"function"==typeof MediaRecorder.isTypeSupported&&MediaRecorder.isTypeSupported("video/webm")&&(n=M)),e instanceof Array&&e.length&&(n=L),t.recorderType&&(n=t.recorderType),!t.disableLogs&&n&&n.name&&console.log("Using recorderType:",n.name||n.constructor.name),!n&&v&&(n=M),n}function s(e){this.addStream=function(t){t&&(e=t)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var t,n=this.mediaType,o=this.mimeType||{audio:null,video:null,gif:null};if("function"!=typeof n.audio&&x()&&!O(e,"audio").length&&(n.audio=!1),"function"!=typeof n.video&&x()&&!O(e,"video").length&&(n.video=!1),"function"!=typeof n.gif&&x()&&!O(e,"video").length&&(n.gif=!1),!n.audio&&!n.video&&!n.gif)throw"MediaStream must have either audio or video tracks.";if(n.audio&&(t=null,"function"==typeof n.audio&&(t=n.audio),this.audioRecorder=new a(e,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:t,mimeType:o.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),n.video||this.audioRecorder.startRecording()),n.video){t=null,"function"==typeof n.video&&(t=n.video);var i=e;if(x()&&n.audio&&"function"==typeof n.audio){var r=O(e,"video")[0];g?((i=new w).addTrack(r),t&&t===A&&(t=M)):(i=new w).addTrack(r)}this.videoRecorder=new a(i,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:t,mimeType:o.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),n.audio||this.videoRecorder.startRecording()}if(n.audio&&n.video){var c=this,s=!0===x();n.audio instanceof I&&n.video?s=!1:!0!==n.audio&&!0!==n.video&&n.audio!==n.video&&(s=!1),!0===s?(c.audioRecorder=null,c.videoRecorder.startRecording()):c.videoRecorder.initRecorder((function(){c.audioRecorder.initRecorder((function(){c.videoRecorder.startRecording(),c.audioRecorder.startRecording()}))}))}n.gif&&(t=null,"function"==typeof n.gif&&(t=n.gif),this.gifRecorder=new a(e,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:t,mimeType:o.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording((function(t){e(t,"audio")})),this.videoRecorder&&this.videoRecorder.stopRecording((function(t){e(t,"video")})),this.gifRecorder&&this.gifRecorder.stopRecording((function(t){e(t,"gif")}))},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var t={};return this.audioRecorder&&(t.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(t.video=this.videoRecorder.getBlob()),this.gifRecorder&&(t.gif=this.gifRecorder.getBlob()),e&&e(t),t},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){function t(e,t){if("undefined"!=typeof Worker){var n=function(e){var t,n=m.createObjectURL(new Blob([e.toString(),"this.onmessage =  function (eee) {"+e.name+"(eee.data);}"],{type:"application/javascript"})),o=new Worker(n);if(void 0!==m)t=m;else{if("undefined"==typeof webkitURL)throw"Neither URL nor webkitURL detected.";t=webkitURL}return t.revokeObjectURL(n),o}((function(e){postMessage((new FileReaderSync).readAsDataURL(e))}));n.onmessage=function(e){t(e.data)},n.postMessage(e)}else{var o=new FileReader;o.readAsDataURL(e),o.onload=function(e){t(e.target.result)}}}this.getBlob((function(n){n.audio&&n.video?t(n.audio,(function(o){t(n.video,(function(t){e({audio:o,video:t})}))})):n.audio?t(n.audio,(function(t){e({audio:t})})):n.video&&t(n.video,(function(t){e({video:t})}))}))},this.writeToDisk=function(){a.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){(e=e||{audio:!0,video:!0,gif:!0}).audio&&this.audioRecorder&&this.audioRecorder.save("string"==typeof e.audio?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save("string"==typeof e.video?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save("string"==typeof e.gif?e.gif:"")}}a.version="5.5.9",e.exports=a,void 0===(o=(function(){return a}).apply(t,[]))||(e.exports=o),a.getFromDisk=function(e,t){if(!t)throw"callback is mandatory.";console.log("Getting recorded "+("all"===e?"blobs":e+" blob ")+" from disk!"),T.Fetch((function(n,o){"all"!==e&&o===e+"Blob"&&t&&t(n),"all"===e&&t&&t(n,o.replace("Blob",""))}))},a.writeToDisk=function(e){console.log("Writing recorded blob(s) to disk!"),(e=e||{}).audio&&e.video&&e.gif?e.audio.getDataURL((function(t){e.video.getDataURL((function(n){e.gif.getDataURL((function(e){T.Store({audioBlob:t,videoBlob:n,gifBlob:e})}))}))})):e.audio&&e.video?e.audio.getDataURL((function(t){e.video.getDataURL((function(e){T.Store({audioBlob:t,videoBlob:e})}))})):e.audio&&e.gif?e.audio.getDataURL((function(t){e.gif.getDataURL((function(e){T.Store({audioBlob:t,gifBlob:e})}))})):e.video&&e.gif?e.video.getDataURL((function(t){e.gif.getDataURL((function(e){T.Store({videoBlob:t,gifBlob:e})}))})):e.audio?e.audio.getDataURL((function(e){T.Store({audioBlob:e})})):e.video?e.video.getDataURL((function(e){T.Store({videoBlob:e})})):e.gif&&e.gif.getDataURL((function(e){T.Store({gifBlob:e})}))},s.getFromDisk=a.getFromDisk,s.writeToDisk=a.writeToDisk,a.MRecordRTC=s,(i="undefined"!=typeof global?global:null)&&"undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45",getUserMedia:function(){}},global.console||(global.console={}),void 0!==global.console.log&&void 0!==global.console.error||(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),"undefined"==typeof document&&(i.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},i.HTMLVideoElement=function(){}),"undefined"==typeof location&&(i.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(i.screen={width:0,height:0}),void 0===m&&(i.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),i.window=global);var d=window.requestAnimationFrame;if(void 0===d)if("undefined"!=typeof webkitRequestAnimationFrame)d=webkitRequestAnimationFrame;else if("undefined"!=typeof mozRequestAnimationFrame)d=mozRequestAnimationFrame;else if("undefined"!=typeof msRequestAnimationFrame)d=msRequestAnimationFrame;else if(void 0===d){var l=0;d=function(e,t){var n=(new Date).getTime(),o=Math.max(0,16-(n-l)),i=setTimeout((function(){e(n+o)}),o);return l=n+o,i}}var f=window.cancelAnimationFrame;void 0===f&&("undefined"!=typeof webkitCancelAnimationFrame?f=webkitCancelAnimationFrame:"undefined"!=typeof mozCancelAnimationFrame?f=mozCancelAnimationFrame:"undefined"!=typeof msCancelAnimationFrame?f=msCancelAnimationFrame:void 0===f&&(f=function(e){clearTimeout(e)}));var u=window.AudioContext;void 0===u&&("undefined"!=typeof webkitAudioContext&&(u=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(u=mozAudioContext));var m=window.URL;void 0===m&&"undefined"!=typeof webkitURL&&(m=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var h=!(-1===navigator.userAgent.indexOf("Edge")||!navigator.msSaveBlob&&!navigator.msSaveOrOpenBlob),p=!!window.opera||-1!==navigator.userAgent.indexOf("OPR/"),g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),b=!p&&!h&&!!navigator.webkitGetUserMedia||C()||-1!==navigator.userAgent.toLowerCase().indexOf("chrome/"),v=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);v&&!b&&-1!==navigator.userAgent.indexOf("CriOS")&&(v=!1,b=!0);var w=window.MediaStream;function y(e){if(0===e)return"0 Bytes";var t=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return(e/Math.pow(1e3,t)).toPrecision(3)+" "+["Bytes","KB","MB","GB","TB"][t]}function S(e,t){if(!e)throw"Blob object is required.";if(!e.type)try{e.type="video/webm"}catch(r){}var n=(e.type||"video/webm").split("/")[1];if(t&&-1!==t.indexOf(".")){var o=t.split(".");t=o[0],n=o[1]}var i=(t||Math.round(9999999999*Math.random())+888888888)+"."+n;if(void 0!==navigator.msSaveOrOpenBlob)return navigator.msSaveOrOpenBlob(e,i);if(void 0!==navigator.msSaveBlob)return navigator.msSaveBlob(e,i);var a=document.createElement("a");a.href=m.createObjectURL(e),a.download=i,a.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(a),"function"==typeof a.click?a.click():(a.target="_blank",a.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),m.revokeObjectURL(a.href)}function C(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0}function O(e,t){return e&&e.getTracks?e.getTracks().filter((function(e){return e.kind===(t||"audio")})):[]}function k(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}void 0===w&&"undefined"!=typeof webkitMediaStream&&(w=webkitMediaStream),void 0!==w&&void 0===w.prototype.stop&&(w.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))}),a.invokeSaveAsDialog=S,a.getTracks=O,a.getSeekableBlob=function(e,t){if("undefined"==typeof EBML)throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var n=new EBML.Reader,o=new EBML.Decoder,i=EBML.tools,a=new FileReader;a.onload=function(e){o.decode(this.result).forEach((function(e){n.read(e)})),n.stop();var a=i.makeMetadataSeekable(n.metadatas,n.duration,n.cues),r=this.result.slice(n.metadataSize),c=new Blob([a,r],{type:"video/webm"});t(c)},a.readAsArrayBuffer(e)},a.bytesToSize=y,a.isElectron=C;var R={};function x(){if(g||v||h)return!0;navigator;var e,t,n=navigator.userAgent,o=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10);return(b||p)&&(e=n.indexOf("Chrome"),o=n.substring(e+7)),-1!==(t=o.indexOf(";"))&&(o=o.substring(0,t)),-1!==(t=o.indexOf(" "))&&(o=o.substring(0,t)),i=parseInt(""+o,10),isNaN(i)&&(o=""+parseFloat(navigator.appVersion),i=parseInt(navigator.appVersion,10)),i>=49}function M(e,t){var n,o=this;if(void 0===e)throw'First argument "MediaStream" is required.';if("undefined"==typeof MediaRecorder)throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";"audio"===(t=t||{mimeType:"video/webm"}).type&&(O(e,"video").length&&O(e,"audio").length&&(navigator.mozGetUserMedia?(n=new w).addTrack(O(e,"audio")[0]):n=new w(O(e,"audio")),e=n),t.mimeType&&-1!==t.mimeType.toString().toLowerCase().indexOf("audio")||(t.mimeType=b?"audio/webm":"audio/ogg"),t.mimeType&&"audio/ogg"!==t.mimeType.toString().toLowerCase()&&navigator.mozGetUserMedia&&(t.mimeType="audio/ogg"));var i,a=[];function r(){o.timestamps.push((new Date).getTime()),"function"==typeof t.onTimeStamp&&t.onTimeStamp(o.timestamps[o.timestamps.length-1],o.timestamps)}function c(e){return i&&i.mimeType?i.mimeType:e.mimeType||"video/webm"}function s(){a=[],i=null,o.timestamps=[]}this.getArrayOfBlobs=function(){return a},this.record=function(){o.blob=null,o.clearRecordedData(),o.timestamps=[],d=[],a=[];var n=t;t.disableLogs||console.log("Passing following config over MediaRecorder API.",n),i&&(i=null),b&&!x()&&(n="video/vp8"),"function"==typeof MediaRecorder.isTypeSupported&&n.mimeType&&(MediaRecorder.isTypeSupported(n.mimeType)||(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",n.mimeType),n.mimeType="audio"===t.type?"audio/webm":"video/webm"));try{i=new MediaRecorder(e,n),t.mimeType=n.mimeType}catch(s){i=new MediaRecorder(e)}n.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in i&&!1===i.canRecordMimeType(n.mimeType)&&(t.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",n.mimeType)),i.ondataavailable=function(e){if(e.data&&d.push("ondataavailable: "+y(e.data.size)),"number"!=typeof t.timeSlice)!e.data||!e.data.size||e.data.size<100||o.blob?o.recordingCallback&&(o.recordingCallback(new Blob([],{type:c(n)})),o.recordingCallback=null):(o.blob=t.getNativeBlob?e.data:new Blob([e.data],{type:c(n)}),o.recordingCallback&&(o.recordingCallback(o.blob),o.recordingCallback=null));else if(e.data&&e.data.size&&e.data.size>100&&(a.push(e.data),r(),"function"==typeof t.ondataavailable)){var i=t.getNativeBlob?e.data:new Blob([e.data],{type:c(n)});t.ondataavailable(i)}},i.onstart=function(){d.push("started")},i.onpause=function(){d.push("paused")},i.onresume=function(){d.push("resumed")},i.onstop=function(){d.push("stopped")},i.onerror=function(e){e&&(e.name||(e.name="UnknownError"),d.push("error: "+e),t.disableLogs||(-1!==e.name.toString().toLowerCase().indexOf("invalidstate")?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",e):-1!==e.name.toString().toLowerCase().indexOf("notsupported")?console.error("MIME type (",n.mimeType,") is not supported.",e):-1!==e.name.toString().toLowerCase().indexOf("security")?console.error("MediaRecorder security error",e):"OutOfMemory"===e.name?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"IllegalStreamModification"===e.name?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"OtherRecordingError"===e.name?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",e):"GenericError"===e.name?console.error("The UA cannot provide the codec or recording option that has been requested.",e):console.error("MediaRecorder Error",e)),function(e){if(!o.manuallyStopped&&i&&"inactive"===i.state)return delete t.timeslice,void i.start(6e5);setTimeout(void 0,1e3)}(),"inactive"!==i.state&&"stopped"!==i.state&&i.stop())},"number"==typeof t.timeSlice?(r(),i.start(t.timeSlice)):i.start(36e5),t.initCallback&&t.initCallback()},this.timestamps=[],this.stop=function(e){e=e||function(){},o.manuallyStopped=!0,i&&(this.recordingCallback=e,"recording"===i.state&&i.stop(),"number"==typeof t.timeSlice&&setTimeout((function(){o.blob=new Blob(a,{type:c(t)}),o.recordingCallback(o.blob)}),100))},this.pause=function(){i&&"recording"===i.state&&i.pause()},this.resume=function(){i&&"paused"===i.state&&i.resume()},this.clearRecordedData=function(){i&&"recording"===i.state&&o.stop(s),s()},this.getInternalRecorder=function(){return i},this.blob=null,this.getState=function(){return i&&i.state||"inactive"};var d=[];this.getAllStates=function(){return d},void 0===t.checkForInactiveTracks&&(t.checkForInactiveTracks=!1),o=this,function n(){if(i&&!1!==t.checkForInactiveTracks)return!1===function(){if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}()?(t.disableLogs||console.log("MediaStream seems stopped."),void o.stop()):void setTimeout(n,1e3)}(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}function I(e,t){if(!O(e,"audio").length)throw"Your stream has no audio tracks.";var n,o=this,i=[],r=[],c=!1,s=0,d=2,l=(t=t||{}).desiredSampRate;function f(){if(!1===t.checkForInactiveTracks)return!0;if("active"in e){if(!e.active)return!1}else if("ended"in e&&e.ended)return!1;return!0}function u(e,t){function n(e,t){var n,o=e.numberOfAudioChannels,i=e.leftBuffers.slice(0),a=e.rightBuffers.slice(0),r=e.sampleRate,c=e.internalInterleavedLength,s=e.desiredSampRate;function d(e,t,n){var o=Math.round(e.length*(t/n)),i=[],a=Number((e.length-1)/(o-1));i[0]=e[0];for(var r=1;r<o-1;r++){var c=r*a,s=Number(Math.floor(c)).toFixed(),d=Number(Math.ceil(c)).toFixed();i[r]=l(e[s],e[d],c-s)}return i[o-1]=e[e.length-1],i}function l(e,t,n){return e+(t-e)*n}function f(e,t){for(var n=new Float64Array(t),o=0,i=e.length,a=0;a<i;a++){var r=e[a];n.set(r,o),o+=r.length}return n}function u(e,t,n){for(var o=n.length,i=0;i<o;i++)e.setUint8(t+i,n.charCodeAt(i))}2===o&&(i=f(i,c),a=f(a,c),s&&(i=d(i,s,r),a=d(a,s,r))),1===o&&(i=f(i,c),s&&(i=d(i,s,r))),s&&(r=s),2===o&&(n=function(e,t){for(var n=e.length+t.length,o=new Float64Array(n),i=0,a=0;a<n;)o[a++]=e[i],o[a++]=t[i],i++;return o}(i,a)),1===o&&(n=i);var m=n.length,h=new ArrayBuffer(44+2*m),p=new DataView(h);u(p,0,"RIFF"),p.setUint32(4,36+2*m,!0),u(p,8,"WAVE"),u(p,12,"fmt "),p.setUint32(16,16,!0),p.setUint16(20,1,!0),p.setUint16(22,o,!0),p.setUint32(24,r,!0),p.setUint32(28,2*r,!0),p.setUint16(32,2*o,!0),p.setUint16(34,16,!0),u(p,36,"data"),p.setUint32(40,2*m,!0);for(var g=m,b=44,v=0;v<g;v++)p.setInt16(b,32767*n[v],!0),b+=2;if(t)return t({buffer:h,view:p});postMessage({buffer:h,view:p})}if(e.noWorker)n(e,(function(e){t(e.buffer,e.view)}));else{var o,i,a,r=(o=n,i=m.createObjectURL(new Blob([o.toString(),";this.onmessage =  function (eee) {"+o.name+"(eee.data);}"],{type:"application/javascript"})),(a=new Worker(i)).workerURL=i,a);r.onmessage=function(e){t(e.data.buffer,e.data.view),m.revokeObjectURL(r.workerURL),r.terminate()},r.postMessage(e)}}!0===t.leftChannel&&(d=1),1===t.numberOfAudioChannels&&(d=1),(!d||d<1)&&(d=2),t.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+d),void 0===t.checkForInactiveTracks&&(t.checkForInactiveTracks=!0),this.record=function(){if(!1===f())throw"Please make sure MediaStream is active.";y(),C=w=!1,c=!0,void 0!==t.timeSlice&&R()},this.stop=function(e){e=e||function(){},c=!1,u({desiredSampRate:l,sampleRate:v,numberOfAudioChannels:d,internalInterleavedLength:s,leftBuffers:i,rightBuffers:1===d?[]:r,noWorker:t.noWorker},(function(t,n){o.blob=new Blob([n],{type:"audio/wav"}),o.buffer=new ArrayBuffer(n.buffer.byteLength),o.view=n,o.sampleRate=l||v,o.bufferSize=b,o.length=s,C=!1,e&&e(o.blob)}))},void 0===a.Storage&&(a.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),a.Storage.AudioContextConstructor&&"closed"!==a.Storage.AudioContextConstructor.state||(a.Storage.AudioContextConstructor=new a.Storage.AudioContext);var h=a.Storage.AudioContextConstructor,p=h.createMediaStreamSource(e),g=[0,256,512,1024,2048,4096,8192,16384],b=void 0===t.bufferSize?4096:t.bufferSize;if(-1===g.indexOf(b)&&(t.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(g,null,"\t"))),h.createJavaScriptNode)n=h.createJavaScriptNode(b,d,d);else{if(!h.createScriptProcessor)throw"WebAudio API has no support on this browser.";n=h.createScriptProcessor(b,d,d)}p.connect(n),t.bufferSize||(b=n.bufferSize);var v=void 0!==t.sampleRate?t.sampleRate:h.sampleRate||44100;(v<22050||v>96e3)&&(t.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),t.disableLogs||t.desiredSampRate&&console.log("Desired sample-rate: "+t.desiredSampRate);var w=!1;function y(){r=[],s=0,C=!1,c=!1,w=!1,h=null,o.leftchannel=i=[],o.rightchannel=r,o.numberOfAudioChannels=d,o.desiredSampRate=l,o.sampleRate=v,o.recordingLength=s,k={left:[],right:[],recordingLength:0}}function S(){n&&(n.onaudioprocess=null,n.disconnect(),n=null),p&&(p.disconnect(),p=null),y()}this.pause=function(){w=!0},this.resume=function(){if(!1===f())throw"Please make sure MediaStream is active.";if(!c)return t.disableLogs||console.log("Seems recording has been restarted."),void this.record();w=!1},this.clearRecordedData=function(){t.checkForInactiveTracks=!1,c&&this.stop(S),S()},this.name="StereoAudioRecorder",this.toString=function(){return this.name};var C=!1;n.onaudioprocess=function(e){if(!w)if(!1===f()&&(t.disableLogs||console.log("MediaStream seems stopped."),n.disconnect(),c=!1),c){C||(C=!0,t.onAudioProcessStarted&&t.onAudioProcessStarted(),t.initCallback&&t.initCallback());var a=e.inputBuffer.getChannelData(0),l=new Float32Array(a);if(i.push(l),2===d){var u=e.inputBuffer.getChannelData(1),m=new Float32Array(u);r.push(m)}o.recordingLength=s+=b,void 0!==t.timeSlice&&(k.recordingLength+=b,k.left.push(l),2===d&&k.right.push(m))}else p&&(p.disconnect(),p=null)},n.connect(h.createMediaStreamDestination?h.createMediaStreamDestination():h.destination),this.leftchannel=i,this.rightchannel=r,this.numberOfAudioChannels=d,this.desiredSampRate=l,this.sampleRate=v,o.recordingLength=s;var k={left:[],right:[],recordingLength:0};function R(){c&&"function"==typeof t.ondataavailable&&void 0!==t.timeSlice&&(k.left.length?(u({desiredSampRate:l,sampleRate:v,numberOfAudioChannels:d,internalInterleavedLength:k.recordingLength,leftBuffers:k.left,rightBuffers:1===d?[]:k.right},(function(e,n){var o=new Blob([n],{type:"audio/wav"});t.ondataavailable(o),setTimeout(R,t.timeSlice)})),k={left:[],right:[],recordingLength:0}):setTimeout(R,t.timeSlice))}}function P(e,t){if("undefined"==typeof html2canvas)throw"Please link: https://www.webrtc-experiment.com/screenshot.js";(t=t||{}).frameInterval||(t.frameInterval=10);var n=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach((function(e){e in document.createElement("canvas")&&(n=!0)}));var o,i,a,r=!(!window.webkitRTCPeerConnection&&!window.webkitGetUserMedia||!window.chrome),c=50,s=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(r&&s&&s[2]&&(c=parseInt(s[2],10)),r&&c<52&&(n=!1),t.useWhammyRecorder&&(n=!1),n)if(t.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),e instanceof HTMLCanvasElement)o=e;else{if(!(e instanceof CanvasRenderingContext2D))throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";o=e.canvas}else navigator.mozGetUserMedia&&(t.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));this.record=function(){if(a=!0,n&&!t.useWhammyRecorder){var e;"captureStream"in o?e=o.captureStream(25):"mozCaptureStream"in o?e=o.mozCaptureStream(25):"webkitCaptureStream"in o&&(e=o.webkitCaptureStream(25));try{var r=new w;r.addTrack(O(e,"video")[0]),e=r}catch(c){}if(!e)throw"captureStream API are NOT available.";(i=new M(e,{mimeType:t.mimeType||"video/webm"})).record()}else m.frames=[],u=(new Date).getTime(),f();t.initCallback&&t.initCallback()},this.getWebPImages=function(n){if("canvas"===e.nodeName.toLowerCase()){var o=m.frames.length;m.frames.forEach((function(e,n){var i=o-n;t.disableLogs||console.log(i+"/"+o+" frames remaining"),t.onEncodingCallback&&t.onEncodingCallback(i,o);var a=e.image.toDataURL("image/webp",1);m.frames[n].image=a})),t.disableLogs||console.log("Generating WebM"),n()}else n()},this.stop=function(e){a=!1;var o=this;n&&i?i.stop(e):this.getWebPImages((function(){m.compile((function(n){t.disableLogs||console.log("Recording finished!"),o.blob=n,o.blob.forEach&&(o.blob=new Blob([],{type:"video/webm"})),e&&e(o.blob),m.frames=[]}))}))};var d=!1;function l(){m.frames=[],a=!1,d=!1}function f(){if(d)return u=(new Date).getTime(),setTimeout(f,500);if("canvas"===e.nodeName.toLowerCase()){var n=(new Date).getTime()-u;return u=(new Date).getTime(),m.frames.push({image:(o=document.createElement("canvas"),i=o.getContext("2d"),o.width=e.width,o.height=e.height,i.drawImage(e,0,0),o),duration:n}),void(a&&setTimeout(f,t.frameInterval))}var o,i;html2canvas(e,{grabMouse:void 0===t.showMousePointer||t.showMousePointer,onrendered:function(e){var n=(new Date).getTime()-u;if(!n)return setTimeout(f,t.frameInterval);u=(new Date).getTime(),m.frames.push({image:e.toDataURL("image/webp",1),duration:n}),a&&setTimeout(f,t.frameInterval)}})}this.pause=function(){d=!0,i instanceof M&&i.pause()},this.resume=function(){d=!1,i instanceof M?i.resume():a||this.record()},this.clearRecordedData=function(){a&&this.stop(l),l()},this.name="CanvasRecorder",this.toString=function(){return this.name};var u=(new Date).getTime(),m=new B.Video(100)}function A(e,t){function n(e){e=void 0!==e?e:10;var t=(new Date).getTime()-c;return t?i?(c=(new Date).getTime(),setTimeout(n,100)):(c=(new Date).getTime(),r.paused&&r.play(),l.drawImage(r,0,0,d.width,d.height),s.frames.push({duration:t,image:d.toDataURL("image/webp")}),void(o||setTimeout(n,e,e))):setTimeout(n,e,e)}(t=t||{}).frameInterval||(t.frameInterval=10),t.disableLogs||console.log("Using frames-interval:",t.frameInterval),this.record=function(){t.width||(t.width=320),t.height||(t.height=240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),d.width=t.canvas.width||320,d.height=t.canvas.height||240,l=d.getContext("2d"),t.video&&t.video instanceof HTMLVideoElement?(r=t.video.cloneNode(),t.initCallback&&t.initCallback()):(r=document.createElement("video"),k(e,r),r.onloadedmetadata=function(){t.initCallback&&t.initCallback()},r.width=t.video.width,r.height=t.video.height),r.muted=!0,r.play(),c=(new Date).getTime(),s=new B.Video,t.disableLogs||(console.log("canvas resolutions",d.width,"*",d.height),console.log("video width/height",r.width||d.width,"*",r.height||d.height)),n(t.frameInterval)};var o=!1;this.stop=function(e){e=e||function(){},o=!0;var n=this;setTimeout((function(){!function(e,t,n,o,i){var a=document.createElement("canvas");a.width=d.width,a.height=d.height;var r,c,s,l=a.getContext("2d"),f=[],u=e.length,m=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),h=!1;c=-1,s=(r={length:u,functionToLoop:function(t,n){var o,i,a,r=function(){!h&&a-o<=0*a||(h=!0,f.push(e[n])),t()};if(h)r();else{var c=new Image;c.onload=function(){l.drawImage(c,0,0,d.width,d.height);var e=l.getImageData(0,0,d.width,d.height);o=0,i=e.data.length,a=e.data.length/4;for(var t=0;t<i;t+=4){var n={r:e.data[t],g:e.data[t+1],b:e.data[t+2]};Math.sqrt(Math.pow(n.r-0,2)+Math.pow(n.g-0,2)+Math.pow(n.b-0,2))<=0*m&&o++}r()},c.src=e[n].image}},callback:function(){(f=f.concat(e.slice(u))).length<=0&&f.push(e[e.length-1]),i(f)}}).length,function e(){++c!==s?setTimeout((function(){r.functionToLoop(e,c)}),1):r.callback()}()}(s.frames,0,0,0,(function(o){s.frames=o,t.advertisement&&t.advertisement.length&&(s.frames=t.advertisement.concat(s.frames)),s.compile((function(t){n.blob=t,n.blob.forEach&&(n.blob=new Blob([],{type:"video/webm"})),e&&e(n.blob)}))}))}),10)};var i=!1;function a(){s.frames=[],o=!0,i=!1}this.pause=function(){i=!0},this.resume=function(){i=!1,o&&this.record()},this.clearRecordedData=function(){o||this.stop(a),a()},this.name="WhammyRecorder",this.toString=function(){return this.name};var r,c,s,d=document.createElement("canvas"),l=d.getContext("2d")}void 0!==u?R.AudioContext=u:"undefined"!=typeof webkitAudioContext&&(R.AudioContext=webkitAudioContext),a.Storage=R,a.MediaStreamRecorder=M,a.StereoAudioRecorder=I,a.CanvasRecorder=P,a.WhammyRecorder=A;var B=function(){function e(e){this.frames=[],this.duration=e||1,this.quality=.8}function t(e){function t(e,t,n){return[{data:e,id:231}].concat(n.map((function(e){var n=function(e){var t=0;if(e.keyframe&&(t|=128),e.invisible&&(t|=8),e.lacing&&(t|=e.lacing<<1),e.discardable&&(t|=1),e.trackNum>127)throw"TrackNumber > 127 not supported";return[128|e.trackNum,e.timecode>>8,255&e.timecode,t].map((function(e){return String.fromCharCode(e)})).join("")+e.frame}({discardable:0,frame:e.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(t)});return t+=e.duration,{data:n,id:163}})))}function n(e){for(var t=[];e>0;)t.push(255&e),e>>=8;return new Uint8Array(t.reverse())}function o(e){var t=[];e=(e.length%8?new Array(9-e.length%8).join("0"):"")+e;for(var n=0;n<e.length;n+=8)t.push(parseInt(e.substr(n,8),2));return new Uint8Array(t)}function i(e,t){return parseInt(e.substr(t+4,4).split("").map((function(e){var t=e.charCodeAt(0).toString(2);return new Array(8-t.length+1).join("0")+t})).join(""),2)}var a=new function(e){var i=function(e){if(e[0]){for(var t=e[0].width,n=e[0].height,o=e[0].duration,i=1;i<e.length;i++)o+=e[i].duration;return{duration:o,width:t,height:n}}postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."})}(e);if(!i)return[];for(var a,r=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:(a=i.duration,[].slice.call(new Uint8Array(new Float64Array([a]).buffer),0).map((function(e){return String.fromCharCode(e)})).reverse().join("")),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:i.width,id:176},{data:i.height,id:186}]}]}]}]}],c=0,s=0;c<e.length;){var d=[],l=0;do{d.push(e[c]),l+=e[c].duration,c++}while(c<e.length&&l<3e4);var f={id:524531317,data:t(s,0,d)};r[1].data.push(f),s+=l}return function e(t){for(var i=[],a=0;a<t.length;a++){var r=t[a].data;"object"==typeof r&&(r=e(r)),"number"==typeof r&&(r=o(r.toString(2))),"string"==typeof r&&(r=new Uint8Array(r.split("").map((function(e){return e.charCodeAt(0)}))));var c=r.size||r.byteLength||r.length,s=Math.ceil(Math.ceil(Math.log(c)/Math.log(2))/8),d=c.toString(2),l=new Array(7*s+7+1-d.length).join("0")+d,f=new Array(s).join("0")+"1"+l;i.push(n(t[a].id)),i.push(o(f)),i.push(r)}return new Blob(i,{type:"video/webm"})}(r)}(e.map((function(e){var t=function(e){for(var t=e.RIFF[0].WEBP[0],n=t.indexOf("\x9d\x01*"),o=0,i=[];o<4;o++)i[o]=t.charCodeAt(n+3+o);return{width:16383&(i[1]<<8|i[0]),height:16383&(i[3]<<8|i[2]),data:t,riff:e}}(function e(t){for(var n=0,o={};n<t.length;){var a=t.substr(n,4),r=i(t,n),c=t.substr(n+4+4,r);n+=8+r,o[a]=o[a]||[],o[a].push("RIFF"===a||"LIST"===a?e(c):c)}return o}(atob(e.image.slice(23))));return t.duration=e.duration,t})));postMessage(a)}return e.prototype.add=function(e,t){if("canvas"in e&&(e=e.canvas),"toDataURL"in e&&(e=e.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/gi.test(e))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:e,duration:t||this.duration})},e.prototype.compile=function(e){var n,o,i,a=(n=t,o=m.createObjectURL(new Blob([n.toString(),"this.onmessage =  function (eee) {"+n.name+"(eee.data);}"],{type:"application/javascript"})),i=new Worker(o),m.revokeObjectURL(o),i);a.onmessage=function(t){t.data.error?console.error(t.data.error):e(t.data)},a.postMessage(this.frames)},{Video:e}}();a.Whammy=B;var T={init:function(){var e=this;if("undefined"!=typeof indexedDB&&void 0!==indexedDB.open){var t,n=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),o=indexedDB.open(n,1);o.onerror=e.onError,o.onsuccess=function(){(t=o.result).onerror=e.onError,t.setVersion&&1!==t.version?t.setVersion(1).onsuccess=function(){i(t),a()}:a()},o.onupgradeneeded=function(e){i(e.target.result)}}else console.error("IndexedDB API are not available in this browser.");function i(t){t.createObjectStore(e.dataStoreName)}function a(){var n=t.transaction([e.dataStoreName],"readwrite");function o(t){n.objectStore(e.dataStoreName).get(t).onsuccess=function(n){e.callback&&e.callback(n.target.result,t)}}e.videoBlob&&n.objectStore(e.dataStoreName).put(e.videoBlob,"videoBlob"),e.gifBlob&&n.objectStore(e.dataStoreName).put(e.gifBlob,"gifBlob"),e.audioBlob&&n.objectStore(e.dataStoreName).put(e.audioBlob,"audioBlob"),o("audioBlob"),o("videoBlob"),o("gifBlob")}},Fetch:function(e){return this.callback=e,this.init(),this},Store:function(e){return this.audioBlob=e.audioBlob,this.videoBlob=e.videoBlob,this.gifBlob=e.gifBlob,this.init(),this},onError:function(e){console.error(JSON.stringify(e,null,"\t"))},dataStoreName:"recordRTC",dbName:null};function F(e,t){if("undefined"==typeof GIFEncoder){var n=document.createElement("script");n.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(n)}t=t||{};var o=e instanceof CanvasRenderingContext2D||e instanceof HTMLCanvasElement;this.record=function(){"undefined"!=typeof GIFEncoder&&c?(o||(t.width||(t.width=s.offsetWidth||320),t.height||(t.height=s.offsetHeight||240),t.video||(t.video={width:t.width,height:t.height}),t.canvas||(t.canvas={width:t.width,height:t.height}),a.width=t.canvas.width||320,a.height=t.canvas.height||240,s.width=t.video.width||320,s.height=t.video.height||240),(u=new GIFEncoder).setRepeat(0),u.setDelay(t.frameRate||200),u.setQuality(t.quality||10),u.start(),"function"==typeof t.onGifRecordingStarted&&t.onGifRecordingStarted(),Date.now(),m=d((function e(n){if(!0!==h.clearedRecordedData){if(i)return setTimeout((function(){e(n)}),100);m=d(e),void 0===typeof l&&(l=n),n-l<90||(!o&&s.paused&&s.play(),o||r.drawImage(s,0,0,a.width,a.height),t.onGifPreview&&t.onGifPreview(a.toDataURL("image/png")),u.addFrame(r),l=n)}})),t.initCallback&&t.initCallback()):setTimeout(h.record,1e3)},this.stop=function(e){e=e||function(){},m&&f(m),Date.now(),this.blob=new Blob([new Uint8Array(u.stream().bin)],{type:"image/gif"}),e(this.blob),u.stream().bin=[]};var i=!1;this.pause=function(){i=!0},this.resume=function(){i=!1},this.clearRecordedData=function(){h.clearedRecordedData=!0,u&&(u.stream().bin=[])},this.name="GifRecorder",this.toString=function(){return this.name};var a=document.createElement("canvas"),r=a.getContext("2d");o&&(e instanceof CanvasRenderingContext2D?a=(r=e).canvas:e instanceof HTMLCanvasElement&&(r=e.getContext("2d"),a=e));var c=!0;if(!o){var s=document.createElement("video");s.muted=!0,s.autoplay=!0,s.playsInline=!0,c=!1,s.onloadedmetadata=function(){c=!0},k(e,s),s.play()}var l,u,m=null,h=this}function _(e,t){"undefined"!=typeof global&&global,t=t||"multi-streams-mixer";var n=[],o=!1,i=document.createElement("canvas"),a=i.getContext("2d");i.style.opacity=0,i.style.position="absolute",i.style.zIndex=-1,i.style.top="-1000em",i.style.left="-1000em",i.className=t,(document.body||document.documentElement).appendChild(i),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var r=this,c=window.AudioContext;void 0===c&&("undefined"!=typeof webkitAudioContext&&(c=webkitAudioContext),"undefined"!=typeof mozAudioContext&&(c=mozAudioContext));var s=window.URL;void 0===s&&"undefined"!=typeof webkitURL&&(s=webkitURL),"undefined"!=typeof navigator&&void 0===navigator.getUserMedia&&(void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),void 0!==navigator.mozGetUserMedia&&(navigator.getUserMedia=navigator.mozGetUserMedia));var d=window.MediaStream;void 0===d&&"undefined"!=typeof webkitMediaStream&&(d=webkitMediaStream),void 0!==d&&void 0===d.prototype.stop&&(d.prototype.stop=function(){this.getTracks().forEach((function(e){e.stop()}))});var l={};function f(){if(!o){var e=n.length,t=!1,a=[];if(n.forEach((function(e){e.stream||(e.stream={}),e.stream.fullcanvas?t=e:a.push(e)})),t)i.width=t.stream.width,i.height=t.stream.height;else if(a.length){i.width=e>1?2*a[0].width:a[0].width;var c=1;3!==e&&4!==e||(c=2),5!==e&&6!==e||(c=3),7!==e&&8!==e||(c=4),9!==e&&10!==e||(c=5),i.height=a[0].height*c}else i.width=r.width||360,i.height=r.height||240;t&&t instanceof HTMLVideoElement&&u(t),a.forEach((function(e,t){u(e,t)})),setTimeout(f,r.frameInterval)}}function u(e,t){if(!o){var n=0,i=0,r=e.width,c=e.height;1===t&&(n=e.width),2===t&&(i=e.height),3===t&&(n=e.width,i=e.height),4===t&&(i=2*e.height),5===t&&(n=e.width,i=2*e.height),6===t&&(i=3*e.height),7===t&&(n=e.width,i=3*e.height),void 0!==e.stream.left&&(n=e.stream.left),void 0!==e.stream.top&&(i=e.stream.top),void 0!==e.stream.width&&(r=e.stream.width),void 0!==e.stream.height&&(c=e.stream.height),a.drawImage(e,n,i,r,c),"function"==typeof e.stream.onRender&&e.stream.onRender(a,n,i,r,c,t)}}function m(e){var n=document.createElement("video");return function(e,t){"srcObject"in t?t.srcObject=e:"mozSrcObject"in t?t.mozSrcObject=e:t.srcObject=e}(e,n),n.className=t,n.muted=!0,n.volume=0,n.width=e.width||r.width||360,n.height=e.height||r.height||240,n.play(),n}function h(t){n=[],(t=t||e).forEach((function(e){if(e.getTracks().filter((function(e){return"video"===e.kind})).length){var t=m(e);t.stream=e,n.push(t)}}))}void 0!==c?l.AudioContext=c:"undefined"!=typeof webkitAudioContext&&(l.AudioContext=webkitAudioContext),this.startDrawingFrames=function(){f()},this.appendStreams=function(t){if(!t)throw"First parameter is required.";t instanceof Array||(t=[t]),t.forEach((function(t){var o=new d;if(t.getTracks().filter((function(e){return"video"===e.kind})).length){var i=m(t);i.stream=t,n.push(i),o.addTrack(t.getTracks().filter((function(e){return"video"===e.kind}))[0])}if(t.getTracks().filter((function(e){return"audio"===e.kind})).length){var a=r.audioContext.createMediaStreamSource(t);r.audioDestination=r.audioContext.createMediaStreamDestination(),a.connect(r.audioDestination),o.addTrack(r.audioDestination.stream.getTracks().filter((function(e){return"audio"===e.kind}))[0])}e.push(o)}))},this.releaseStreams=function(){n=[],o=!0,r.gainNode&&(r.gainNode.disconnect(),r.gainNode=null),r.audioSources.length&&(r.audioSources.forEach((function(e){e.disconnect()})),r.audioSources=[]),r.audioDestination&&(r.audioDestination.disconnect(),r.audioDestination=null),r.audioContext&&r.audioContext.close(),r.audioContext=null,a.clearRect(0,0,i.width,i.height),i.stream&&(i.stream.stop(),i.stream=null)},this.resetVideoStreams=function(e){!e||e instanceof Array||(e=[e]),h(e)},this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=function(){o=!1;var t=function(){var e;h(),"captureStream"in i?e=i.captureStream():"mozCaptureStream"in i?e=i.mozCaptureStream():r.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var t=new d;return e.getTracks().filter((function(e){return"video"===e.kind})).forEach((function(e){t.addTrack(e)})),i.stream=t,t}(),n=function(){l.AudioContextConstructor||(l.AudioContextConstructor=new l.AudioContext),r.audioContext=l.AudioContextConstructor,r.audioSources=[],!0===r.useGainNode&&(r.gainNode=r.audioContext.createGain(),r.gainNode.connect(r.audioContext.destination),r.gainNode.gain.value=0);var t=0;if(e.forEach((function(e){if(e.getTracks().filter((function(e){return"audio"===e.kind})).length){t++;var n=r.audioContext.createMediaStreamSource(e);!0===r.useGainNode&&n.connect(r.gainNode),r.audioSources.push(n)}})),t)return r.audioDestination=r.audioContext.createMediaStreamDestination(),r.audioSources.forEach((function(e){e.connect(r.audioDestination)})),r.audioDestination.stream}();return n&&n.getTracks().filter((function(e){return"audio"===e.kind})).forEach((function(e){t.addTrack(e)})),e.forEach((function(e){})),t}}function L(e,t){e=e||[];var n,o,i=this;(t=t||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}}).frameInterval||(t.frameInterval=10),t.video||(t.video={}),t.video.width||(t.video.width=360),t.video.height||(t.video.height=240),this.record=function(){var i;n=new _(e,t.elementClass||"multi-streams-mixer"),(i=[],e.forEach((function(e){O(e,"video").forEach((function(e){i.push(e)}))})),i).length&&(n.frameInterval=t.frameInterval||10,n.width=t.video.width||360,n.height=t.video.height||240,n.startDrawingFrames()),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(n.getMixedStream()),(o=new M(n.getMixedStream(),t)).record()},this.stop=function(e){o&&o.stop((function(t){i.blob=t,e(t),i.clearRecordedData()}))},this.pause=function(){o&&o.pause()},this.resume=function(){o&&o.resume()},this.clearRecordedData=function(){o&&(o.clearRecordedData(),o=null),n&&(n.releaseStreams(),n=null)},this.addStreams=function(i){if(!i)throw"First parameter is required.";i instanceof Array||(i=[i]),e.concat(i),o&&n&&(n.appendStreams(i),t.previewStream&&"function"==typeof t.previewStream&&t.previewStream(n.getMixedStream()))},this.resetVideoStreams=function(e){n&&(!e||e instanceof Array||(e=[e]),n.resetVideoStreams(e))},this.getMixer=function(){return n},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}function E(e,t){function n(){return new ReadableStream({start:function(n){var o=document.createElement("canvas"),i=document.createElement("video");i.srcObject=e,i.onplaying=function(){o.width=t.width,o.height=t.height;var e=o.getContext("2d"),a=1e3/t.frameRate;setTimeout((function o(){e.drawImage(i,0,0),n.enqueue(e.getImageData(0,0,t.width,t.height)),setTimeout(o,a)}),a)},i.play()}})}var o,i;"undefined"!=typeof ReadableStream&&"undefined"!=typeof WritableStream||console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),(t=t||{}).width=t.width||640,t.height=t.height||480,t.frameRate=t.frameRate||30,t.bitrate=t.bitrate||1200,this.record=function(){a=[],i=!1,this.blob=null,function e(r,c){if(t.workerPath||c){if(!t.workerPath&&c instanceof ArrayBuffer){var s=new Blob([c],{type:"text/javascript"});t.workerPath=m.createObjectURL(s)}t.workerPath||console.error("workerPath parameter is missing."),(o=new Worker(t.workerPath)).postMessage(t.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),o.addEventListener("message",(function(e){"READY"===e.data?(o.postMessage({width:t.width,height:t.height,bitrate:t.bitrate||1200,timebaseDen:t.frameRate||30,realtime:!0}),n().pipeTo(new WritableStream({write:function(e){o&&o.postMessage(e.data.buffer,[e.data.buffer])}}))):e.data&&(i||a.push(e.data))}))}else fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then((function(t){t.arrayBuffer().then((function(t){e(r,t)}))}))}(e),"function"==typeof t.initCallback&&t.initCallback()},this.pause=function(){i=!0},this.resume=function(){i=!1};var a=[];this.stop=function(e){o&&(o.postMessage(null),o.terminate(),o=null),this.blob=new Blob(a,{type:"video/webm"}),e(this.blob)},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){a=[],i=!1,this.blob=null},this.blob=null}a.DiskStorage=T,a.GifRecorder=F,a.MultiStreamRecorder=L,a.RecordRTCPromisesHandler=function(e,t){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(void 0===e)throw'First argument "MediaStream" is required.';var n=this;n.recordRTC=new a(e,t),this.startRecording=function(){return new Promise((function(e,t){try{n.recordRTC.startRecording(),e()}catch(o){t(o)}}))},this.stopRecording=function(){return new Promise((function(e,t){try{n.recordRTC.stopRecording((function(o){n.blob=n.recordRTC.getBlob(),n.blob&&n.blob.size?e(o):t("Empty blob.",n.blob)}))}catch(o){t(o)}}))},this.pauseRecording=function(){return new Promise((function(e,t){try{n.recordRTC.pauseRecording(),e()}catch(o){t(o)}}))},this.resumeRecording=function(){return new Promise((function(e,t){try{n.recordRTC.resumeRecording(),e()}catch(o){t(o)}}))},this.getDataURL=function(e){return new Promise((function(e,t){try{n.recordRTC.getDataURL((function(t){e(t)}))}catch(o){t(o)}}))},this.getBlob=function(){return new Promise((function(e,t){try{e(n.recordRTC.getBlob())}catch(o){t(o)}}))},this.getInternalRecorder=function(){return new Promise((function(e,t){try{e(n.recordRTC.getInternalRecorder())}catch(o){t(o)}}))},this.reset=function(){return new Promise((function(e,t){try{e(n.recordRTC.reset())}catch(o){t(o)}}))},this.destroy=function(){return new Promise((function(e,t){try{e(n.recordRTC.destroy())}catch(o){t(o)}}))},this.getState=function(){return new Promise((function(e,t){try{e(n.recordRTC.getState())}catch(o){t(o)}}))},this.blob=null,this.version="5.5.9"},a.WebAssemblyRecorder=E},vS2R:function(e,t,n){var o;!function(n,i,a,r){"use strict";var c,s,d={URL:n.URL||n.webkitURL||n.mozURL||n.msURL,getUserMedia:(s=a.getUserMedia||a.webkitGetUserMedia||a.mozGetUserMedia||a.msGetUserMedia,s?s.bind(a):s),requestAnimFrame:n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame,requestTimeout:function(e,t){if(e=e||d.noop,t=t||0,!d.requestAnimFrame)return setTimeout(e,t);var n=(new Date).getTime(),o=new Object,i=d.requestAnimFrame;return o.value=i((function a(){(new Date).getTime()-n>=t?e.call():o.value=i(a)})),o},Blob:n.Blob||n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,btoa:(c=n.btoa||function(e){for(var t="",n=0,o=e.length,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=void 0,r=void 0,c=void 0,s=void 0,d=void 0,l=void 0,f=void 0;n<o;)s=(a=e.charCodeAt(n++))>>2,d=(3&a)<<4|(r=e.charCodeAt(n++))>>4,l=(15&r)<<2|(c=e.charCodeAt(n++))>>6,f=63&c,isNaN(r)?l=f=64:isNaN(c)&&(f=64),t=t+i.charAt(s)+i.charAt(d)+i.charAt(l)+i.charAt(f);return t},c?c.bind(n):d.noop),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){return d.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=i.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return n.Worker},blob:function(){return d.Blob},Uint8Array:function(){return n.Uint8Array},Uint32Array:function(){return n.Uint32Array},videoCodecs:function(){var e=i.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(n){}return t}()},noop:function(){},each:function(e,t){var n=void 0,o=void 0;if(d.isArray(e))for(n=-1,o=e.length;++n<o&&!1!==t(n,e[n]););else if(d.isObject(e))for(n in e)if(e.hasOwnProperty(n)&&!1===t(n,e[n]))break},mergeOptions:function(e,t){if(d.isObject(e)&&d.isObject(t)&&Object.keys){var n={};return d.each(e,(function(t,o){n[t]=e[t]})),d.each(t,(function(o,i){var a=t[o];n[o]=d.isObject(a)&&e[o]?d.mergeOptions(e[o],a):a})),n}},setCSSAttr:function(e,t,n){d.isElement(e)&&(d.isString(t)&&d.isString(n)?e.style[t]=n:d.isObject(t)&&d.each(t,(function(t,n){e.style[t]=n})))},removeElement:function(e){d.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!d.isString(e))return{};try{var t=new d.Blob([e],{type:"text/javascript"}),n=d.URL.createObjectURL(t);return{objectUrl:n,worker:new Worker(n)}}catch(o){return""+o}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i.body||!1===e.resizeFont)return e.fontSize;var t=e.text,n=e.gifWidth,o=parseInt(e.fontSize,10),a=parseInt(e.minFontSize,10),r=i.createElement("div"),c=i.createElement("span");for(r.setAttribute("width",n),r.appendChild(c),c.innerHTML=t,c.style.fontSize=o+"px",c.style.textIndent="-9999px",c.style.visibility="hidden",i.body.appendChild(c);c.offsetWidth>n&&o>=a;)c.style.fontSize=--o+"px";return i.body.removeChild(c),o+"px"},webWorkerError:!1},l=Object.freeze({default:d}),f={validate:function(e){e=d.isObject(e)?e:{};var t={};return d.each(f.validators,(function(n,o){if(!e[o.errorCode]&&!o.condition)return(t=o).error=!0,!1})),delete t.condition,t},isValid:function(e){return!0!==f.validate(e).error},validators:[{condition:d.isFunction(d.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:d.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:d.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:d.isFunction(d.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:d.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:d.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:d.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},u=Object.freeze({default:f}),m=function(){},h={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:m,completeCallback:m,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},p=Object.freeze({default:h});function g(){return f.isValid()}function b(){var e,t,n,o,i,a=256,r=499,c=491,s=487,d=503,l=3*d,f=a-1,u=4,m=100,h=16,p=1<<h,g=10,b=10,v=p>>b,w=p<<g-b,y=a>>3,S=6,C=1<<S,O=y*C,k=30,R=10,x=1<<R,M=8,I=1<<M,P=R+M,A=1<<P,B=[],T=[],F=[],_=[];function L(e,r,c){var s,d;for(t=e,n=r,o=c,i=new Array(a),s=0;s<a;s++)i[s]=new Array(4),(d=i[s])[0]=d[1]=d[2]=(s<<u+8)/a|0,F[s]=p/a|0,T[s]=0}function E(){for(var e=[],t=new Array(a),n=0;n<a;n++)t[i[n][3]]=n;for(var o=0,r=0;r<a;r++){var c=t[r];e[o++]=i[c][0],e[o++]=i[c][1],e[o++]=i[c][2]}return e}function U(){var e,t,n,o,r,c,s,d;for(s=0,d=0,e=0;e<a;e++){for(n=e,o=(r=i[e])[1],t=e+1;t<a;t++)(c=i[t])[1]<o&&(n=t,o=c[1]);if(c=i[n],e!=n&&(t=c[0],c[0]=r[0],r[0]=t,t=c[1],c[1]=r[1],r[1]=t,t=c[2],c[2]=r[2],r[2]=t,t=c[3],c[3]=r[3],r[3]=t),o!=s){for(B[s]=d+e>>1,t=s+1;t<o;t++)B[t]=e;s=o,d=e}}for(B[s]=d+f>>1,t=s+1;t<256;t++)B[t]=f}function D(){var i,a,f,h,p,g,b,v,w,y,C,R,M,P;for(n<l&&(o=1),e=30+(o-1)/3,R=t,M=0,P=n,y=(C=n/(3*o))/m|0,v=x,(b=(g=O)>>S)<=1&&(b=0),i=0;i<b;i++)_[i]=v*((b*b-i*i)*I/(b*b));for(w=n<l?3:n%r!=0?3*r:n%c!=0?3*c:n%s!=0?3*s:3*d,i=0;i<C;)if(W(v,a=G(f=(255&R[M+0])<<u,h=(255&R[M+1])<<u,p=(255&R[M+2])<<u),f,h,p),0!==b&&N(b,a,f,h,p),(M+=w)>=P&&(M-=n),0===y&&(y=1),++i%y==0)for(v-=v/e,(b=(g-=g/k)>>S)<=1&&(b=0),a=0;a<b;a++)_[a]=v*((b*b-a*a)*I/(b*b))}function z(e,t,n){var o,r,c,s,d,l,f;for(d=1e3,f=-1,r=(o=B[t])-1;o<a||r>=0;)o<a&&((c=(l=i[o])[1]-t)>=d?o=a:(o++,c<0&&(c=-c),(s=l[0]-e)<0&&(s=-s),(c+=s)<d&&((s=l[2]-n)<0&&(s=-s),(c+=s)<d&&(d=c,f=l[3])))),r>=0&&((c=t-(l=i[r])[1])>=d?r=-1:(r--,c<0&&(c=-c),(s=l[0]-e)<0&&(s=-s),(c+=s)<d&&((s=l[2]-n)<0&&(s=-s),(c+=s)<d&&(d=c,f=l[3]))));return f}function j(){return D(),V(),U(),E()}function V(){var e;for(e=0;e<a;e++)i[e][0]>>=u,i[e][1]>>=u,i[e][2]>>=u,i[e][3]=e}function N(e,t,n,o,r){var c,s,d,l,f,u,m;for((d=t-e)<-1&&(d=-1),(l=t+e)>a&&(l=a),c=t+1,s=t-1,u=1;c<l||s>d;){if(f=_[u++],c<l){m=i[c++];try{m[0]-=f*(m[0]-n)/A|0,m[1]-=f*(m[1]-o)/A|0,m[2]-=f*(m[2]-r)/A|0}catch(h){}}if(s>d){m=i[s--];try{m[0]-=f*(m[0]-n)/A|0,m[1]-=f*(m[1]-o)/A|0,m[2]-=f*(m[2]-r)/A|0}catch(h){}}}}function W(e,t,n,o,a){var r=i[t],c=e/x;r[0]-=c*(r[0]-n)|0,r[1]-=c*(r[1]-o)|0,r[2]-=c*(r[2]-a)|0}function G(e,t,n){var o,r,c,s,d,l,f,m,p,y;for(p=m=~(1<<31),f=l=-1,o=0;o<a;o++)(r=(y=i[o])[0]-e)<0&&(r=-r),(c=y[1]-t)<0&&(c=-c),r+=c,(c=y[2]-n)<0&&(c=-c),(r+=c)<m&&(m=r,l=o),(s=r-(T[o]>>h-u))<p&&(p=s,f=o),F[o]-=d=F[o]>>b,T[o]+=d<<g;return F[l]+=v,T[l]-=w,f}L.apply(this,arguments);var q={};return q.map=z,q.process=j,q}function v(){try{this.onmessage=function(t){var n,o=t.data||{};o.gifshot&&(n=e.run(o),postMessage(n))}}catch(t){}var e={dataToRGB:function(e,t,n){for(var o=t*n*4,i=0,a=[];i<o;)a.push(e[i++]),a.push(e[i++]),a.push(e[i++]),i++;return a},componentizedPaletteToArray:function(e){e=e||[];for(var t=[],n=0;n<e.length;n+=3)t.push(e[n]<<16|e[n+1]<<8|e[n+2]);return t},processFrameWithQuantizer:function(e,t,n,o){for(var i=this.dataToRGB(e,t,n),a=new b(i,i.length,o),r=a.process(),c=new Uint32Array(this.componentizedPaletteToArray(r)),s=t*n,d=new Uint8Array(s),l=0,f=0;f<s;f++){var u=i[l++],m=i[l++],h=i[l++];d[f]=a.map(u,m,h)}return{pixels:d,palette:c}},run:function(e){return this.processFrameWithQuantizer((e=e||{}).data,e.width,e.height,e.sampleInterval)}};return e}function w(e,t,n,o){var i=0,a=void 0===(o=void 0===o?{}:o).loop?null:o.loop,r=void 0===o.palette?null:o.palette;if(t<=0||n<=0||t>65535||n>65535)throw"Width/Height invalid.";if(e[i++]=71,e[i++]=73,e[i++]=70,e[i++]=56,e[i++]=57,e[i++]=97,e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&n,e[i++]=n>>8&255,e[i++]=0|(null!==r?128:0),e[i++]=0,e[i++]=0,null!==a){if(a<0||a>65535)throw"Loop count invalid.";e[i++]=33,e[i++]=255,e[i++]=11,e[i++]=78,e[i++]=69,e[i++]=84,e[i++]=83,e[i++]=67,e[i++]=65,e[i++]=80,e[i++]=69,e[i++]=50,e[i++]=46,e[i++]=48,e[i++]=3,e[i++]=1,e[i++]=255&a,e[i++]=a>>8&255,e[i++]=0}var c=!1;this.addFrame=function(t,n,o,a,s,d){if(!0===c&&(--i,c=!1),t<0||n<0||t>65535||n>65535)throw"x/y invalid.";if(o<=0||a<=0||o>65535||a>65535)throw"Width/Height invalid.";if(s.length<o*a)throw"Not enough pixels for the frame size.";var l=!0,f=(d=void 0===d?{}:d).palette;if(null==f&&(l=!1,f=r),null==f)throw"Must supply either a local or global palette.";for(var u=function(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}(f),m=0;u>>=1;)++m;u=1<<m;var h=void 0===d.delay?0:d.delay,p=void 0===d.disposal?0:d.disposal;if(p<0||p>3)throw"Disposal out of range.";var g=!1,b=0;if(null!=d.transparent&&(g=!0,(b=d.transparent)<0||b>=u))throw"Transparent color index.";if((0!==p||g||0!==h)&&(e[i++]=33,e[i++]=249,e[i++]=4,e[i++]=p<<2|(!0===g?1:0),e[i++]=255&h,e[i++]=h>>8&255,e[i++]=b,e[i++]=0),e[i++]=44,e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&n,e[i++]=n>>8&255,e[i++]=255&o,e[i++]=o>>8&255,e[i++]=255&a,e[i++]=a>>8&255,e[i++]=!0===l?128|m-1:0,!0===l)for(var v=0,w=f.length;v<w;++v){var y=f[v];e[i++]=y>>16&255,e[i++]=y>>8&255,e[i++]=255&y}i=function(e,t,n,o){e[t++]=n;var i=t++,a=1<<n,r=a-1,c=a+1,s=c+1,d=n+1,l=0,f=0;function u(n){for(;l>=n;)e[t++]=255&f,f>>=8,l-=8,t===i+256&&(e[i]=255,i=t++)}function m(e){f|=e<<l,l+=d,u(8)}var h=o[0]&r,p={};m(a);for(var g=1,b=o.length;g<b;++g){var v=o[g]&r,w=h<<8|v,y=p[w];if(void 0===y){for(f|=h<<l,l+=d;l>=8;)e[t++]=255&f,f>>=8,l-=8,t===i+256&&(e[i]=255,i=t++);4096===s?(m(a),s=c+1,d=n+1,p={}):(s>=1<<d&&++d,p[w]=s++),h=v}else h=y}return m(h),m(c),u(1),i+1===t?e[i]=0:(e[i]=t-i-1,e[t++]=0),t}(e,i,m<2?2:m,s)},this.end=function(){return!1===c&&(e[i++]=59,c=!0),i}}var y=function(){},S=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=y,this.onRenderProgressCallback=y,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};function C(e,t){e.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})}))}S.prototype={workerMethods:v(),initializeWebWorkers:function(e){var t,n=b.toString()+"("+v.toString()+"());",o=void 0,a=void 0,r=-1,c="";for(t=e.numWorkers;++r<t;)o=d.createWebWorker(n),d.isObject(o)?(this.workers.push({worker:a=o.worker,objectUrl:o.objectUrl}),this.availableWorkers.push(a)):(c=o,d.webWorkerError=!!o);this.workerError=c,this.canvas=i.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,n="",o=-1;++o<t;)n+=this.byteMap[e[o]];return n},onFrameFinished:function(e){var t=this,n=t.frames,o=!!(t.options.images||[]).length,i=n.every((function(e){return!e.beingProcessed&&e.done}));t.numRenderedFrames++,o&&e(t.numRenderedFrames/n.length),t.onRenderProgressCallback(.75*t.numRenderedFrames/n.length),i?t.generatingGIF||t.generateGIF(n,t.onRenderCompleteCallback):d.requestTimeout((function(){t.processNextFrame()}),1)},processFrame:function(e){var t=this,n=this.options,o=n.progressCallback,i=n.sampleInterval,a=void 0,r=void 0,c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.data;delete a.data,a.pixels=Array.prototype.slice.call(n.pixels),a.palette=Array.prototype.slice.call(n.palette),a.done=!0,a.beingProcessed=!1,t.freeWorker(r),t.onFrameFinished(o)};(a=this.frames[e]).beingProcessed||a.done?this.onFrameFinished():(a.sampleInterval=i,a.beingProcessed=!0,a.gifshot=!0,(r=this.getWorker())?(r.onmessage=c,r.postMessage(a)):c({data:t.workerMethods.run(a)}))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var n=this.frames[t];if(!n.done&&!n.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,t){var n=[],o=this.options,i=o.interval,a=o.frameDuration,r=!!o.images.length,c=o.gifHeight,s=o.gifWidth,l=new w(n,s,c,{loop:this.repeat}),f=this.onRenderProgressCallback,u=r?100*i:0,m=void 0;this.generatingGIF=!0,d.each(e,(function(t,n){var o=n.palette;f(.75+.25*n.position*1/e.length);for(var i=0;i<a;i++)l.addFrame(0,0,s,c,n.pixels,{palette:o,delay:u})})),l.end(),f(1),this.frames=[],this.generatingGIF=!1,d.isFunction(t)&&(m=this.bufferToString(n),t("data:image/gif;base64,"+d.btoa(m)))},setRepeat:function(e){this.repeat=e},addFrame:function(e,t){t=d.isObject(t)?t:{};var n=this.ctx,o=this.options,i=o.gifWidth,a=o.gifHeight,r=d.getFontSize(t),c=t.filter,s=t.fontColor,l=t.text,f=t.textAlign,u=t.textBaseline,m=t.textXCoordinate?t.textXCoordinate:"left"===f?1:"right"===f?i:i/2,h=t.textYCoordinate?t.textYCoordinate:"top"===u?1:"center"===u?a/2:a,p=t.fontWeight+" "+r+" "+t.fontFamily,g=void 0;try{n.filter=c,n.drawImage(e,0,0,i,a),l&&(n.font=p,n.fillStyle=s,n.textAlign=f,n.textBaseline=u,n.fillText(l,m,h)),g=n.getImageData(0,0,i,a),this.addFrameImageData(g)}catch(b){return""+b}},addFrameImageData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.frames,n=e.data;this.frames.push({data:n,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var t=this;t.startRendering((function(n){t.destroyWorkers(),d.requestTimeout((function(){e(n)}),0)}))},destroyWorkers:function(){this.workerError||d.each(this.workers,(function(e,t){var n=t.objectUrl;t.worker.terminate(),d.URL.revokeObjectURL(n)}))}};var O=function(){},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];t=d.isFunction(t)?t:O;var n=i.createElement("canvas"),o=void 0,a=e.images,r=!!a.length,c=e.cameraStream,s=e.crop,l=e.filter,f=e.fontColor,u=e.fontFamily,m=e.fontWeight,h=e.keepCameraOn,p=e.progressCallback,g=e.saveRenderingContexts,b=e.savedRenderingContexts,v=e.text,w=e.textAlign,y=e.textBaseline,C=e.videoElement,k=e.videoHeight,R=e.videoWidth,x=e.webcamVideoElement,M=Number(e.gifWidth),I=Number(e.gifHeight),P=Number(e.interval),A=(Number(e.sampleInterval),r?0:1e3*P),B=[],T=b.length?b.length:e.numFrames,F=T,_=new S(e),L=d.getFontSize(e),E=e.textXCoordinate?e.textXCoordinate:"left"===w?1:"right"===w?M:M/2,U=e.textYCoordinate?e.textYCoordinate:"top"===y?1:"center"===y?I/2:I,D=m+" "+L+" "+u,z=s?Math.floor(s.scaledWidth/2):0,j=s?R-s.scaledWidth:0,V=s?Math.floor(s.scaledHeight/2):0,N=s?k-s.scaledHeight:0,W=function e(){var n=F-1;function i(){var i;g&&B.push(o.getImageData(0,0,M,I)),v&&(o.font=D,o.fillStyle=f,o.textAlign=w,o.textBaseline=y,o.fillText(v,E,U)),i=o.getImageData(0,0,M,I),_.addFrameImageData(i),p((T-(F=n))/T),n>0&&d.requestTimeout(e,A),F||_.getBase64GIF((function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:c,videoElement:C,webcamVideoElement:x,savedRenderingContexts:B,keepCameraOn:h})}))}b.length?(o.putImageData(b[T-F],0,0),i()):function e(){try{j>R&&(j=R),N>k&&(N=k),z<0&&(z=0),V<0&&(V=0),o.filter=l,o.drawImage(C,z,V,j,N,0,0,M,I),i()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;d.requestTimeout(e,100)}}()};T=void 0!==T?T:10,P=void 0!==P?P:.1,n.width=M,n.height=I,o=n.getContext("2d"),function e(){b.length||0!==C.currentTime?W():d.requestTimeout(e,100)}()},R={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function e(t){e.attempts=e.attempts||0;var n=t.cameraStream,o=t.completedCallback,i=t.videoElement;i&&(i.videoWidth>0&&i.videoHeight>0?(i.removeEventListener("loadeddata",R.findVideoSize),o({videoElement:i,cameraStream:n,videoWidth:i.videoWidth,videoHeight:i.videoHeight})):e.attempts<10?(e.attempts+=1,d.requestTimeout((function(){R.findVideoSize(t)}),400)):o({videoElement:i,cameraStream:n,videoWidth:R.defaultVideoDimensions.width,videoHeight:R.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){d.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=d.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,n=e.cameraStream,o=e.completedCallback,i=e.streamedCallback,a=e.videoElement;if(d.isFunction(i)&&i(),t){if(d.isString(t))a.src=t,a.innerHTML='<source src="'+t+'" type="video/'+d.getExtension(t)+'" />';else if(t instanceof Blob){try{a.src=d.URL.createObjectURL(t)}catch(r){}a.innerHTML='<source src="'+t+'" type="'+t.type+'" />'}}else if(a.mozSrcObject)a.mozSrcObject=n;else if(d.URL)try{a.srcObject=n,a.src=d.URL.createObjectURL(n)}catch(r){a.srcObject=n}a.play(),d.requestTimeout((function e(){e.count=e.count||0,!0===R.loadedData?(R.findVideoSize({videoElement:a,cameraStream:n,completedCallback:o}),R.loadedData=!1):(e.count+=1)>10?R.findVideoSize({videoElement:a,cameraStream:n,completedCallback:o}):e()}),0)},startStreaming:function(e){var t=d.isFunction(e.error)?e.error:d.noop,n=d.isFunction(e.streamed)?e.streamed:d.noop,o=d.isFunction(e.completed)?e.completed:d.noop,a=e.crossOrigin,r=e.existingVideo,c=e.lastCameraStream,s=e.options,l=e.webcamVideoElement,f=d.isElement(r)?r:l||i.createElement("video");a&&(f.crossOrigin=s.crossOrigin),f.autoplay=!0,f.loop=!0,f.muted=!0,f.addEventListener("loadeddata",(function(e){R.loadedData=!0,s.offset&&(f.currentTime=s.offset)})),r?R.stream({videoElement:f,existingVideo:r,completedCallback:o}):c?R.stream({videoElement:f,cameraStream:c,streamedCallback:n,completedCallback:o}):d.getUserMedia({video:!0},(function(e){R.stream({videoElement:f,cameraStream:e,streamedCallback:n,completedCallback:o})}),t)},startVideoStreaming:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0!==t.timeout?t.timeout:0,o=t.callback,i=t.webcamVideoElement,a=void 0;n>0&&(a=d.requestTimeout((function(){R.onStreamingTimeout(o)}),1e4)),R.startStreaming({error:function(){o({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(a)},completed:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.cameraStream,o=t.videoElement,i=t.videoHeight,a=t.videoWidth;e({cameraStream:n,videoElement:o,videoHeight:i,videoWidth:a})},lastCameraStream:t.lastCameraStream,webcamVideoElement:i,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){var t=(e=d.isObject(e)?e:{}).keepCameraOn,n=e.videoElement,o=e.webcamVideoElement,i=e.cameraStream||{},a=i.getTracks&&i.getTracks()||[],r=a[0];!t&&!!a.length&&d.isFunction(r.stop)&&r.stop(),d.isElement(n)&&!o&&(n.pause(),d.isFunction(d.URL.revokeObjectURL)&&!d.webWorkerError&&n.src&&d.URL.revokeObjectURL(n.src),d.removeElement(n))}};function x(e){e=d.isObject(e)?e:{},R.stopVideoStreaming(e)}function M(e,t){var n=e.options||{},o=n.images,a=n.video,r=Number(n.gifWidth),c=Number(n.gifHeight),s=(Number(n.numFrames),e.cameraStream),l=e.videoElement,f=e.videoWidth,u=e.videoHeight,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.videoWidth,n=e.videoHeight,o=e.gifWidth,i=e.gifHeight,a={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>n?(a.width=Math.round(t*(i/n))-o,a.scaledWidth=Math.round(a.width*(n/i))):(a.height=Math.round(n*(o/t))-i,a.scaledHeight=Math.round(a.height*(t/o))),a}({videoWidth:f,videoHeight:u,gifHeight:c,gifWidth:r}),h=t;n.crop=m,n.videoElement=l,n.videoWidth=f,n.videoHeight=u,n.cameraStream=s,d.isElement(l)&&(l.width=r+m.width,l.height=c+m.height,n.webcamVideoElement||(d.setCSSAttr(l,{position:"fixed",opacity:"0"}),i.body.appendChild(l)),l.play(),k(n,(function(e){o&&o.length||a&&a.length||x(e),h(e)})))}function I(e,t){if(t=d.isFunction(e)?e:t,e=d.isObject(e)?e:{},d.isFunction(t)){var n=d.mergeOptions(h,e)||{},o=e.cameraStream,a=n.images,r=a?a.length:0,c=n.video,s=n.webcamVideoElement;n=d.mergeOptions(n,{gifWidth:Math.floor(n.gifWidth),gifHeight:Math.floor(n.gifHeight)}),r?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,n=e.images,o=e.options,a=e.imagesLength,r={getUserMedia:!0,"window.URL":!0},c=f.validate(r),s=[],l=0,u=void 0,m=void 0;if(c.error)return t(c);function h(){d.each(s,(function(e,t){t&&(t.text?m.addFrame(t.img,o,t.text):m.addFrame(t,o))})),C(m,t)}m=new S(o),d.each(n,(function(e,n){var r=n;n.src&&(r=r.src),d.isElement(r)?(o.crossOrigin&&(r.crossOrigin=o.crossOrigin),s[e]=r,(l+=1)===a&&h()):d.isString(r)&&(u=new Image,o.crossOrigin&&(u.crossOrigin=o.crossOrigin),function(o){n.text&&(o.text=n.text),o.onerror=function(e){var n=void 0;if(0==--a)return(n={}).error="None of the requested images was capable of being retrieved",t(n)},o.onload=function(t){s[e]=n.text?{img:o,text:o.text}:o,(l+=1)===a&&h(),d.removeElement(o)},o.src=r}(u),d.setCSSAttr(u,{position:"fixed",opacity:"0"}),i.body.appendChild(u))}))}({images:a,imagesLength:r,callback:t,options:n}):c?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,n=e.existingVideo,o=e.options,i={getUserMedia:!0,"window.URL":!0},a=f.validate(i),r=void 0;if(a.error)return t(a);if(d.isElement(n)&&n.src){if(r=d.getExtension(n.src),!d.isSupported.videoCodecs[r])return t(f.messages.videoCodecs)}else d.isArray(n)&&d.each(n,(function(e,t){if(r=t instanceof Blob?t.type.substr(t.type.lastIndexOf("/")+1,t.length):t.substr(t.lastIndexOf(".")+1,t.length),d.isSupported.videoCodecs[r])return n=t,!1}));R.startStreaming({completed:function(e){e.options=o||{},M(e,t)},existingVideo:n,crossOrigin:o.crossOrigin,options:o})}({existingVideo:c,callback:t,options:n}):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.callback,n=e.lastCameraStream,o=e.options,i=e.webcamVideoElement;if(!g())return t(f.validate());o.savedRenderingContexts.length?k(o,(function(e){t(e)})):R.startVideoStreaming((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.options=o||{},M(e,t)}),{lastCameraStream:n,callback:t,webcamVideoElement:i,crossOrigin:o.crossOrigin})}({lastCameraStream:o,callback:t,webcamVideoElement:s,options:n})}}var P={utils:l,error:u,defaultOptions:p,createGIF:I,takeSnapShot:function(e,t){if(t=d.isFunction(e)?e:t,e=d.isObject(e)?e:{},d.isFunction(t)){var n=d.mergeOptions(h,e);I(d.mergeOptions(n,{interval:.1,numFrames:1,gifWidth:Math.floor(n.gifWidth),gifHeight:Math.floor(n.gifHeight)}),t)}},stopVideoStreaming:x,isSupported:function(){return f.isValid()},isWebCamGIFSupported:g,isExistingVideoGIFSupported:function(e){var t=!1;if(d.isArray(e)&&e.length){if(d.each(e,(function(e,n){d.isSupported.videoCodecs[n]&&(t=!0)})),!t)return!1}else if(d.isString(e)&&e.length&&!d.isSupported.videoCodecs[e])return!1;return f.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return f.isValid({getUserMedia:!0})},VERSION:"0.4.5"};void 0===(o=(function(){return P}).apply(t,[]))||(e.exports=o)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})}}]);